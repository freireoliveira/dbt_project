

============================== 2023-03-30 00:31:16.890708 | 84a27c61-e1e1-492d-8e88-a757191a4d11 ==============================
[0m00:31:16.890708 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:31:16.892739 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m00:31:16.892739 [debug] [MainThread]: Tracking: tracking
[0m00:31:16.900751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A935D4E890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A935E1D890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A935D44590>]}
[0m00:31:16.901750 [info ] [MainThread]: Setting up your profile.
[0m00:31:25.754352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9365233D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A936523350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A936523890>]}
[0m00:31:25.755358 [debug] [MainThread]: Flushing usage events
[0m00:31:26.507165 [error] [MainThread]: Encountered an error:

[0m00:31:26.511151 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\hiago\anaconda3\envs\dbt-venv\Lib\site-packages\dbt\main.py", line 136, in main
    results, succeeded = handle_and_check(args)
                         ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\hiago\anaconda3\envs\dbt-venv\Lib\site-packages\dbt\main.py", line 206, in handle_and_check
    task, res = run_from_args(parsed)
                ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\hiago\anaconda3\envs\dbt-venv\Lib\site-packages\dbt\main.py", line 253, in run_from_args
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\hiago\anaconda3\envs\dbt-venv\Lib\site-packages\dbt\task\init.py", line 263, in run
    if not self.check_if_can_write_profile(profile_name=profile_name):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\hiago\anaconda3\envs\dbt-venv\Lib\site-packages\dbt\task\init.py", line 203, in check_if_can_write_profile
    response = click.confirm(
               ^^^^^^^^^^^^^^
  File "C:\Users\hiago\anaconda3\envs\dbt-venv\Lib\site-packages\click\termui.py", line 237, in confirm
    raise Abort() from None
click.exceptions.Abort



============================== 2023-03-30 00:40:24.279583 | 810ea81d-8e99-4184-bc88-6f9957684acd ==============================
[0m00:40:24.279583 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:40:24.280583 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m00:40:24.280583 [debug] [MainThread]: Tracking: tracking
[0m00:40:24.290096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD67FECED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD68864950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD6885BBD0>]}
[0m00:40:24.298092 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:40:24.298092 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:40:24.299093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '810ea81d-8e99-4184-bc88-6f9957684acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD68843A90>]}
[0m00:40:24.765263 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m00:40:24.775260 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m00:40:24.778064 [debug] [MainThread]: 1603: static parser failed on staging\stg_walmart.sql
[0m00:40:24.780090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD68AD3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD688B1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD68B24ED0>]}
[0m00:40:24.781088 [debug] [MainThread]: Flushing usage events
[0m00:40:25.505841 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_walmart (models\staging\stg_walmart.sql)
  source() takes exactly two arguments (1 given)


============================== 2023-03-30 00:42:47.468574 | 5cc91afd-541b-4961-b8d5-2ed1e12f3995 ==============================
[0m00:42:47.468574 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:42:47.469574 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m00:42:47.470581 [debug] [MainThread]: Tracking: tracking
[0m00:42:47.478576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC23B9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC1FB2DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC1CDE2D0>]}
[0m00:42:47.486576 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:42:47.486576 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:42:47.487576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5cc91afd-541b-4961-b8d5-2ed1e12f3995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC23A3410>]}
[0m00:42:47.928628 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m00:42:47.938628 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m00:42:47.940628 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m00:42:47.977143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC1E7BC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC26E3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFC275A750>]}
[0m00:42:47.977143 [debug] [MainThread]: Flushing usage events
[0m00:42:48.710318 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.projeto_final.stg_walmart' (models\staging\stg_walmart.sql) depends on a node named 'walmart_source' which was not found


============================== 2023-03-30 00:51:34.629460 | a39cf7c9-3db9-4151-b386-bd8914361897 ==============================
[0m00:51:34.629460 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:51:34.631460 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m00:51:34.631460 [debug] [MainThread]: Tracking: tracking
[0m00:51:34.639460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EBE078850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EBD803F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EBDB3BBD0>]}
[0m00:51:34.647974 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:51:34.647974 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:51:34.648973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a39cf7c9-3db9-4151-b386-bd8914361897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EBE084350>]}
[0m00:51:34.653972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EBE0944D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EBE094550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EBE094590>]}
[0m00:51:34.654972 [debug] [MainThread]: Flushing usage events
[0m00:51:35.381960 [error] [MainThread]: Encountered an error:
Compilation Error
  The yml property file at models\source.yml is invalid because the yml property file models\source.yml is missing a version tag. Please consult the documentation for more information on yml property file syntax:
  
  https://docs.getdbt.com/reference/configs-and-properties


============================== 2023-03-30 00:52:11.477340 | dd89fb4b-efb2-438c-843e-e5c98c4ff610 ==============================
[0m00:52:11.477340 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:52:11.479342 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m00:52:11.479342 [debug] [MainThread]: Tracking: tracking
[0m00:52:11.487341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C067FE850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C067E9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C0630BBD0>]}
[0m00:52:11.495341 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:52:11.496342 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:52:11.496342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd89fb4b-efb2-438c-843e-e5c98c4ff610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C063089D0>]}
[0m00:52:11.943407 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m00:52:11.953408 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m00:52:11.955408 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m00:52:11.982925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C06B6E250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C06B6DF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C06B5F090>]}
[0m00:52:11.982925 [debug] [MainThread]: Flushing usage events
[0m00:52:12.692747 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models\source.yml @ sources: {'name': 'walmart_source', 'database': 'postgres', 'schema*': 'public', 'tables': [{'name': 'walmart'}]} - at path []: Additional properties are not allowed ('schema*' was unexpected)


============================== 2023-03-30 00:52:24.133917 | d80492d3-b4c0-483f-9d7f-52d302080afc ==============================
[0m00:52:24.133917 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:52:24.135917 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m00:52:24.135917 [debug] [MainThread]: Tracking: tracking
[0m00:52:24.143917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2A7C87D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2AD23C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2A9C09D0>]}
[0m00:52:24.152918 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:52:24.152918 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:52:24.153918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd80492d3-b4c0-483f-9d7f-52d302080afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2AAA03D0>]}
[0m00:52:24.609501 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m00:52:24.620502 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m00:52:24.622502 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m00:52:24.669507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2B0963D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2B2A5110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2B385C50>]}
[0m00:52:24.669507 [debug] [MainThread]: Flushing usage events
[0m00:52:25.318926 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.projeto_final.stg_walmart' (models\staging\stg_walmart.sql) depends on a node named 'walmart' in package 'walmart_source' which was not found


============================== 2023-03-30 00:52:43.164900 | 02bf98fb-1596-4cdd-9088-c85cc683ca1d ==============================
[0m00:52:43.164900 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:52:43.166463 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m00:52:43.166463 [debug] [MainThread]: Tracking: tracking
[0m00:52:43.175512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A570B075D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A570B42D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A570D2F4D0>]}
[0m00:52:43.182517 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:52:43.183519 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:52:43.183519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '02bf98fb-1596-4cdd-9088-c85cc683ca1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A570FEE250>]}
[0m00:52:43.621114 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m00:52:43.632106 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m00:52:43.635106 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m00:52:43.681112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5713563D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A571434410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A571434FD0>]}
[0m00:52:43.681112 [debug] [MainThread]: Flushing usage events
[0m00:52:44.366829 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.projeto_final.stg_walmart' (models\staging\stg_walmart.sql) depends on a node named 'walmart' in package 'walmart_source' which was not found


============================== 2023-03-30 00:56:13.191423 | 1384cbc9-c97d-4ad2-967a-4bfaa6685cff ==============================
[0m00:56:13.191423 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:56:13.192424 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m00:56:13.193423 [debug] [MainThread]: Tracking: tracking
[0m00:56:13.201424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E4FD9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E4BB3B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E4B4B850>]}
[0m00:56:13.209423 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:56:13.210424 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:56:13.211423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1384cbc9-c97d-4ad2-967a-4bfaa6685cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E4FA3C50>]}
[0m00:56:13.653490 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m00:56:13.664498 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m00:56:13.667385 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m00:56:13.730619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1384cbc9-c97d-4ad2-967a-4bfaa6685cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E53922D0>]}
[0m00:56:13.736619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1384cbc9-c97d-4ad2-967a-4bfaa6685cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E5374150>]}
[0m00:56:13.736619 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m00:56:13.737619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1384cbc9-c97d-4ad2-967a-4bfaa6685cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1DEA19910>]}
[0m00:56:13.738620 [info ] [MainThread]: 
[0m00:56:13.740619 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:56:13.741929 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:56:13.750944 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:56:13.750944 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:56:13.750944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:13.900678 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m00:56:13.901679 [debug] [ThreadPool]: On list_postgres: Close
[0m00:56:13.903679 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m00:56:13.908677 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:56:13.908677 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:56:13.908677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:13.938274 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m00:56:13.939294 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:56:13.939294 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:56:13.943565 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m00:56:13.945565 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:56:13.945565 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:56:13.950565 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:13.950565 [debug] [MainThread]: On master: BEGIN
[0m00:56:13.950565 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:56:13.980618 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m00:56:13.980618 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:13.980618 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:56:13.986574 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m00:56:13.987576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1384cbc9-c97d-4ad2-967a-4bfaa6685cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E47CF550>]}
[0m00:56:13.987576 [debug] [MainThread]: On master: ROLLBACK
[0m00:56:13.987576 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:13.988575 [debug] [MainThread]: On master: BEGIN
[0m00:56:13.988575 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m00:56:13.988575 [debug] [MainThread]: On master: COMMIT
[0m00:56:13.989576 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:13.989576 [debug] [MainThread]: On master: COMMIT
[0m00:56:13.989576 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m00:56:13.989576 [debug] [MainThread]: On master: Close
[0m00:56:13.990574 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:56:13.990574 [info ] [MainThread]: 
[0m00:56:13.996575 [debug] [Thread-1 (]: Began running node model.projeto_final.my_first_dbt_model
[0m00:56:13.997574 [debug] [Thread-2 (]: Began running node model.projeto_final.stg_walmart
[0m00:56:13.997574 [debug] [Thread-3 (]: Began running node seed.projeto_final.walmart
[0m00:56:13.997574 [info ] [Thread-1 (]: 1 of 8 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m00:56:13.997574 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_walmart ................................. [RUN]
[0m00:56:13.998576 [info ] [Thread-3 (]: 3 of 8 START seed file public.walmart .......................................... [RUN]
[0m00:56:13.999574 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.my_first_dbt_model'
[0m00:56:13.999574 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m00:56:13.999574 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m00:56:14.000575 [debug] [Thread-1 (]: Began compiling node model.projeto_final.my_first_dbt_model
[0m00:56:14.000575 [debug] [Thread-2 (]: Began compiling node model.projeto_final.stg_walmart
[0m00:56:14.000575 [debug] [Thread-3 (]: Began compiling node seed.projeto_final.walmart
[0m00:56:14.002573 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.my_first_dbt_model"
[0m00:56:14.004578 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m00:56:14.004578 [debug] [Thread-3 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 00:56:14.004578 => 2023-03-30 00:56:14.004578
[0m00:56:14.005578 [debug] [Thread-3 (]: Began executing node seed.projeto_final.walmart
[0m00:56:14.025573 [debug] [Thread-1 (]: Timing info for model.projeto_final.my_first_dbt_model (compile): 2023-03-30 00:56:14.000575 => 2023-03-30 00:56:14.025573
[0m00:56:14.026588 [debug] [Thread-1 (]: Began executing node model.projeto_final.my_first_dbt_model
[0m00:56:14.026588 [debug] [Thread-2 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 00:56:14.002573 => 2023-03-30 00:56:14.026588
[0m00:56:14.057573 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.my_first_dbt_model"
[0m00:56:14.105411 [debug] [Thread-2 (]: Began executing node model.projeto_final.stg_walmart
[0m00:56:14.127414 [debug] [Thread-3 (]: Using postgres connection "seed.projeto_final.walmart"
[0m00:56:14.141413 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m00:56:14.141413 [debug] [Thread-3 (]: On seed.projeto_final.walmart: BEGIN
[0m00:56:14.142411 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:56:14.143412 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.my_first_dbt_model"
[0m00:56:14.143412 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m00:56:14.143412 [debug] [Thread-1 (]: On model.projeto_final.my_first_dbt_model: BEGIN
[0m00:56:14.143412 [debug] [Thread-2 (]: On model.projeto_final.stg_walmart: BEGIN
[0m00:56:14.144412 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:56:14.144412 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:56:14.175924 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m00:56:14.175924 [debug] [Thread-3 (]: Using postgres connection "seed.projeto_final.walmart"
[0m00:56:14.175924 [debug] [Thread-3 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "postgres"."public"."walmart"
[0m00:56:14.176932 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m00:56:14.176932 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.my_first_dbt_model"
[0m00:56:14.176932 [debug] [Thread-1 (]: On model.projeto_final.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m00:56:14.177930 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m00:56:14.178932 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m00:56:14.178932 [debug] [Thread-2 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "postgres"."public"."stg_walmart__dbt_tmp" as (
    select
  ...

from "postgres"."public"."walmart"
  );
[0m00:56:14.179938 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m00:56:14.184931 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.my_first_dbt_model"
[0m00:56:14.184931 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m00:56:14.184931 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ".."
LINE 5:   ...
          ^

[0m00:56:14.185608 [debug] [Thread-1 (]: On model.projeto_final.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m00:56:14.311133 [debug] [Thread-2 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m00:56:14.406656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m00:56:14.502169 [debug] [Thread-2 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 00:56:14.127414 => 2023-03-30 00:56:14.502169
[0m00:56:14.613684 [debug] [Thread-1 (]: On model.projeto_final.my_first_dbt_model: COMMIT
[0m00:56:14.645684 [debug] [Thread-2 (]: On model.projeto_final.stg_walmart: Close
[0m00:56:14.709198 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.my_first_dbt_model"
[0m00:56:14.914902 [debug] [Thread-1 (]: On model.projeto_final.my_first_dbt_model: COMMIT
[0m00:56:14.993732 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m00:56:15.077242 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.my_first_dbt_model"
[0m00:56:15.135507 [debug] [Thread-1 (]: On model.projeto_final.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m00:56:15.228034 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m00:56:15.277045 [debug] [Thread-1 (]: Timing info for model.projeto_final.my_first_dbt_model (execute): 2023-03-30 00:56:14.026588 => 2023-03-30 00:56:15.277045
[0m00:56:15.371566 [debug] [Thread-1 (]: On model.projeto_final.my_first_dbt_model: Close
[0m00:56:15.467077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1384cbc9-c97d-4ad2-967a-4bfaa6685cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E5487490>]}
[0m00:56:15.514587 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 1.47s]
[0m00:56:15.611102 [debug] [Thread-1 (]: Finished running node model.projeto_final.my_first_dbt_model
[0m00:56:15.736614 [debug] [Thread-4 (]: Began running node test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:56:15.784127 [debug] [Thread-1 (]: Began running node test.projeto_final.unique_my_first_dbt_model_id.16e066b321
[0m00:56:15.800127 [info ] [Thread-4 (]: 4 of 8 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m00:56:15.895641 [info ] [Thread-1 (]: 5 of 8 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m00:56:15.975645 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710'
[0m00:56:16.055944 [debug] [Thread-2 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  syntax error at or near ".."
  LINE 5:   ...
            ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m00:56:16.056959 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.projeto_final.unique_my_first_dbt_model_id.16e066b321'
[0m00:56:16.134472 [debug] [Thread-4 (]: Began compiling node test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:56:16.229804 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1384cbc9-c97d-4ad2-967a-4bfaa6685cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E5478F10>]}
[0m00:56:16.277065 [debug] [Thread-1 (]: Began compiling node test.projeto_final.unique_my_first_dbt_model_id.16e066b321
[0m00:56:16.365580 [debug] [Thread-4 (]: Writing injected SQL for node "test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710"
[0m00:56:16.467213 [error] [Thread-2 (]: 2 of 8 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 2.23s]
[0m00:56:16.551978 [debug] [Thread-1 (]: Writing injected SQL for node "test.projeto_final.unique_my_first_dbt_model_id.16e066b321"
[0m00:56:16.641520 [debug] [Thread-2 (]: Finished running node model.projeto_final.stg_walmart
[0m00:56:16.688034 [debug] [Thread-4 (]: Timing info for test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-03-30 00:56:16.356577 => 2023-03-30 00:56:16.688034
[0m00:56:16.879552 [debug] [Thread-1 (]: Timing info for test.projeto_final.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-03-30 00:56:16.546949 => 2023-03-30 00:56:16.879552
[0m00:56:16.943067 [debug] [Thread-4 (]: Began executing node test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:56:17.038579 [debug] [Thread-1 (]: Began executing node test.projeto_final.unique_my_first_dbt_model_id.16e066b321
[0m00:56:17.144094 [debug] [Thread-4 (]: Writing runtime sql for node "test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710"
[0m00:56:17.245609 [debug] [Thread-1 (]: Writing runtime sql for node "test.projeto_final.unique_my_first_dbt_model_id.16e066b321"
[0m00:56:17.467638 [debug] [Thread-4 (]: Using postgres connection "test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710"
[0m00:56:17.515148 [debug] [Thread-1 (]: Using postgres connection "test.projeto_final.unique_my_first_dbt_model_id.16e066b321"
[0m00:56:17.546867 [debug] [Thread-4 (]: On test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m00:56:17.641333 [debug] [Thread-1 (]: On test.projeto_final.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m00:56:17.735167 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:56:17.814665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:56:17.974073 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m00:56:18.084096 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m00:56:18.163444 [debug] [Thread-4 (]: Using postgres connection "test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710"
[0m00:56:18.259557 [debug] [Thread-1 (]: Using postgres connection "test.projeto_final.unique_my_first_dbt_model_id.16e066b321"
[0m00:56:18.355071 [debug] [Thread-4 (]: On test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m00:56:18.450588 [debug] [Thread-1 (]: On test.projeto_final.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "test.projeto_final.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:56:18.561705 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0 seconds
[0m00:56:18.641217 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m00:56:18.721379 [debug] [Thread-4 (]: Timing info for test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-03-30 00:56:17.134093 => 2023-03-30 00:56:18.721379
[0m00:56:18.799907 [debug] [Thread-1 (]: Timing info for test.projeto_final.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-03-30 00:56:17.244611 => 2023-03-30 00:56:18.799907
[0m00:56:18.878260 [debug] [Thread-4 (]: On test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m00:56:18.972578 [debug] [Thread-1 (]: On test.projeto_final.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m00:56:19.098586 [debug] [Thread-4 (]: On test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m00:56:19.178592 [debug] [Thread-1 (]: On test.projeto_final.unique_my_first_dbt_model_id.16e066b321: Close
[0m00:56:19.274107 [error] [Thread-4 (]: 4 of 8 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 3.30s]
[0m00:56:19.417130 [debug] [Thread-4 (]: Finished running node test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:56:19.401130 [info ] [Thread-1 (]: 5 of 8 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 3.35s]
[0m00:56:19.527991 [debug] [Thread-1 (]: Finished running node test.projeto_final.unique_my_first_dbt_model_id.16e066b321
[0m00:56:19.702017 [debug] [Thread-2 (]: Began running node model.projeto_final.my_second_dbt_model
[0m00:56:19.750052 [info ] [Thread-2 (]: 6 of 8 SKIP relation public.my_second_dbt_model ................................ [[33mSKIP[0m]
[0m00:56:19.829582 [debug] [Thread-2 (]: Finished running node model.projeto_final.my_second_dbt_model
[0m00:56:19.973100 [debug] [Thread-1 (]: Began running node test.projeto_final.not_null_my_second_dbt_model_id.151b76d778
[0m00:56:19.988609 [debug] [Thread-4 (]: Began running node test.projeto_final.unique_my_second_dbt_model_id.57a0f8c493
[0m00:56:20.052610 [info ] [Thread-1 (]: 7 of 8 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m00:56:20.132123 [info ] [Thread-4 (]: 8 of 8 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m00:56:20.227641 [debug] [Thread-1 (]: Finished running node test.projeto_final.not_null_my_second_dbt_model_id.151b76d778
[0m00:56:20.339158 [debug] [Thread-4 (]: Finished running node test.projeto_final.unique_my_second_dbt_model_id.57a0f8c493
[0m00:56:21.063832 [debug] [Thread-3 (]: Using postgres connection "seed.projeto_final.walmart"
[0m00:56:21.064832 [debug] [Thread-3 (]: On seed.projeto_final.walmart: 
          insert into "postgres"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m00:56:21.130117 [debug] [Thread-3 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m00:56:21.136117 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m00:56:21.138122 [debug] [Thread-3 (]: On seed.projeto_final.walmart: COMMIT
[0m00:56:21.139118 [debug] [Thread-3 (]: Using postgres connection "seed.projeto_final.walmart"
[0m00:56:21.139118 [debug] [Thread-3 (]: On seed.projeto_final.walmart: COMMIT
[0m00:56:21.142550 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m00:56:21.142550 [debug] [Thread-3 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 00:56:14.005578 => 2023-03-30 00:56:21.142550
[0m00:56:21.143550 [debug] [Thread-3 (]: On seed.projeto_final.walmart: Close
[0m00:56:21.143550 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1384cbc9-c97d-4ad2-967a-4bfaa6685cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E54A3ED0>]}
[0m00:56:21.144548 [info ] [Thread-3 (]: 3 of 8 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.14s]
[0m00:56:21.144548 [debug] [Thread-3 (]: Finished running node seed.projeto_final.walmart
[0m00:56:21.146549 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:56:21.146549 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:21.146549 [debug] [MainThread]: On master: BEGIN
[0m00:56:21.146549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:56:21.175560 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m00:56:21.176558 [debug] [MainThread]: On master: COMMIT
[0m00:56:21.176558 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:21.176558 [debug] [MainThread]: On master: COMMIT
[0m00:56:21.177560 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m00:56:21.177560 [debug] [MainThread]: On master: Close
[0m00:56:21.178559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:56:21.178559 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:56:21.178559 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m00:56:21.178559 [debug] [MainThread]: Connection 'test.projeto_final.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m00:56:21.178559 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m00:56:21.178559 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m00:56:21.179563 [debug] [MainThread]: Connection 'test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m00:56:21.179563 [info ] [MainThread]: 
[0m00:56:21.179563 [info ] [MainThread]: Finished running 1 table model, 2 view models, 4 tests, 1 seed in 0 hours 0 minutes and 7.44 seconds (7.44s).
[0m00:56:21.180558 [debug] [MainThread]: Command end result
[0m00:56:21.186068 [info ] [MainThread]: 
[0m00:56:21.186068 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:56:21.187067 [info ] [MainThread]: 
[0m00:56:21.187067 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m00:56:21.187067 [error] [MainThread]:   syntax error at or near ".."
[0m00:56:21.188067 [error] [MainThread]:   LINE 5:   ...
[0m00:56:21.188067 [error] [MainThread]:             ^
[0m00:56:21.188067 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m00:56:21.188067 [info ] [MainThread]: 
[0m00:56:21.189067 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m00:56:21.189067 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m00:56:21.189067 [info ] [MainThread]: 
[0m00:56:21.190067 [info ] [MainThread]:   compiled Code at target\compiled\projeto_final\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m00:56:21.190067 [info ] [MainThread]: 
[0m00:56:21.190067 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=3 TOTAL=8
[0m00:56:21.191068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E482D5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E482F850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1E538D4D0>]}
[0m00:56:21.191068 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 00:56:32.690302 | cef5b190-842d-489e-9c3d-2541c26aa206 ==============================
[0m00:56:32.690302 [info ] [MainThread]: Running with dbt=1.4.5
[0m00:56:32.691766 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m00:56:32.692282 [debug] [MainThread]: Tracking: tracking
[0m00:56:32.700350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEB04EC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEAE3AE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEB328A50>]}
[0m00:56:32.707349 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m00:56:32.745349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:56:32.745349 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\staging\stg_walmart.sql
[0m00:56:32.756349 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m00:56:32.772349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cef5b190-842d-489e-9c3d-2541c26aa206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEAB71290>]}
[0m00:56:32.777349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cef5b190-842d-489e-9c3d-2541c26aa206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEB3EF790>]}
[0m00:56:32.777349 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m00:56:32.778351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cef5b190-842d-489e-9c3d-2541c26aa206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEB3DDD10>]}
[0m00:56:32.779350 [info ] [MainThread]: 
[0m00:56:32.781356 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:56:32.782355 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:56:32.790356 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:56:32.791358 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:56:32.791358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:32.822796 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m00:56:32.823796 [debug] [ThreadPool]: On list_postgres: Close
[0m00:56:32.825796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m00:56:32.829798 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:56:32.830799 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:56:32.830799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:32.969145 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m00:56:32.969145 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:56:32.969145 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m00:56:32.972434 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m00:56:32.973451 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:56:32.973451 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:56:32.978449 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:32.978449 [debug] [MainThread]: On master: BEGIN
[0m00:56:32.979449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:56:33.007976 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m00:56:33.007976 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:33.008973 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:56:33.011975 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m00:56:33.012974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cef5b190-842d-489e-9c3d-2541c26aa206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEB672690>]}
[0m00:56:33.012974 [debug] [MainThread]: On master: ROLLBACK
[0m00:56:33.013972 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:33.013972 [debug] [MainThread]: On master: BEGIN
[0m00:56:33.013972 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m00:56:33.014972 [debug] [MainThread]: On master: COMMIT
[0m00:56:33.014972 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:33.014972 [debug] [MainThread]: On master: COMMIT
[0m00:56:33.015975 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m00:56:33.015975 [debug] [MainThread]: On master: Close
[0m00:56:33.015975 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:56:33.016974 [info ] [MainThread]: 
[0m00:56:33.019975 [debug] [Thread-1 (]: Began running node model.projeto_final.my_first_dbt_model
[0m00:56:33.020973 [debug] [Thread-2 (]: Began running node model.projeto_final.stg_walmart
[0m00:56:33.020973 [debug] [Thread-3 (]: Began running node seed.projeto_final.walmart
[0m00:56:33.020973 [info ] [Thread-1 (]: 1 of 8 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m00:56:33.021972 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_walmart ................................. [RUN]
[0m00:56:33.021972 [info ] [Thread-3 (]: 3 of 8 START seed file public.walmart .......................................... [RUN]
[0m00:56:33.022973 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.my_first_dbt_model'
[0m00:56:33.022973 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m00:56:33.022973 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m00:56:33.023973 [debug] [Thread-1 (]: Began compiling node model.projeto_final.my_first_dbt_model
[0m00:56:33.023973 [debug] [Thread-2 (]: Began compiling node model.projeto_final.stg_walmart
[0m00:56:33.023973 [debug] [Thread-3 (]: Began compiling node seed.projeto_final.walmart
[0m00:56:33.025973 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.my_first_dbt_model"
[0m00:56:33.027972 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m00:56:33.027972 [debug] [Thread-3 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 00:56:33.027972 => 2023-03-30 00:56:33.027972
[0m00:56:33.028974 [debug] [Thread-3 (]: Began executing node seed.projeto_final.walmart
[0m00:56:33.028974 [debug] [Thread-1 (]: Timing info for model.projeto_final.my_first_dbt_model (compile): 2023-03-30 00:56:33.023973 => 2023-03-30 00:56:33.028974
[0m00:56:33.029971 [debug] [Thread-2 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 00:56:33.026975 => 2023-03-30 00:56:33.029971
[0m00:56:33.043973 [debug] [Thread-1 (]: Began executing node model.projeto_final.my_first_dbt_model
[0m00:56:33.043973 [debug] [Thread-2 (]: Began executing node model.projeto_final.stg_walmart
[0m00:56:33.081974 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.my_first_dbt_model"
[0m00:56:33.116487 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m00:56:33.164486 [debug] [Thread-3 (]: Using postgres connection "seed.projeto_final.walmart"
[0m00:56:33.165487 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m00:56:33.165487 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.my_first_dbt_model"
[0m00:56:33.165487 [debug] [Thread-3 (]: On seed.projeto_final.walmart: BEGIN
[0m00:56:33.165487 [debug] [Thread-2 (]: On model.projeto_final.stg_walmart: BEGIN
[0m00:56:33.166488 [debug] [Thread-1 (]: On model.projeto_final.my_first_dbt_model: BEGIN
[0m00:56:33.166488 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:56:33.166488 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:56:33.166488 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:56:33.201008 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m00:56:33.201008 [debug] [Thread-3 (]: Using postgres connection "seed.projeto_final.walmart"
[0m00:56:33.201008 [debug] [Thread-3 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "postgres"."public"."walmart"
[0m00:56:33.202011 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m00:56:33.202011 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m00:56:33.202011 [debug] [Thread-2 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "postgres"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "postgres"."public"."walmart"
  );
[0m00:56:33.203011 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m00:56:33.203011 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.my_first_dbt_model"
[0m00:56:33.203011 [debug] [Thread-1 (]: On model.projeto_final.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m00:56:33.204009 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m00:56:33.205007 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m00:56:33.298521 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.my_first_dbt_model"
[0m00:56:33.357521 [debug] [Thread-1 (]: On model.projeto_final.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m00:56:33.501113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m00:56:33.567117 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.my_first_dbt_model"
[0m00:56:33.612628 [debug] [Thread-1 (]: On model.projeto_final.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m00:56:33.708152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m00:56:33.790155 [debug] [Thread-1 (]: On model.projeto_final.my_first_dbt_model: COMMIT
[0m00:56:33.819664 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.my_first_dbt_model"
[0m00:56:33.835664 [debug] [Thread-1 (]: On model.projeto_final.my_first_dbt_model: COMMIT
[0m00:56:33.930479 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m00:56:34.012993 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.my_first_dbt_model"
[0m00:56:34.056993 [debug] [Thread-1 (]: On model.projeto_final.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m00:56:34.136505 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m00:56:34.201023 [debug] [Thread-1 (]: Timing info for model.projeto_final.my_first_dbt_model (execute): 2023-03-30 00:56:33.050972 => 2023-03-30 00:56:34.201023
[0m00:56:34.264020 [debug] [Thread-1 (]: On model.projeto_final.my_first_dbt_model: Close
[0m00:56:34.359534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cef5b190-842d-489e-9c3d-2541c26aa206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEB7B2290>]}
[0m00:56:34.407047 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 1.34s]
[0m00:56:34.488055 [debug] [Thread-1 (]: Finished running node model.projeto_final.my_first_dbt_model
[0m00:56:34.661114 [debug] [Thread-4 (]: Began running node test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:56:34.693125 [debug] [Thread-1 (]: Began running node test.projeto_final.unique_my_first_dbt_model_id.16e066b321
[0m00:56:34.756884 [info ] [Thread-4 (]: 4 of 8 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m00:56:34.835959 [info ] [Thread-1 (]: 5 of 8 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m00:56:34.883964 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710'
[0m00:56:34.963229 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.projeto_final.unique_my_first_dbt_model_id.16e066b321'
[0m00:56:35.056611 [debug] [Thread-4 (]: Began compiling node test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:56:35.168158 [debug] [Thread-1 (]: Began compiling node test.projeto_final.unique_my_first_dbt_model_id.16e066b321
[0m00:56:35.288676 [debug] [Thread-4 (]: Writing injected SQL for node "test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710"
[0m00:56:35.363186 [debug] [Thread-1 (]: Writing injected SQL for node "test.projeto_final.unique_my_first_dbt_model_id.16e066b321"
[0m00:56:35.532221 [debug] [Thread-4 (]: Timing info for test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-03-30 00:56:35.278670 => 2023-03-30 00:56:35.532221
[0m00:56:35.611737 [debug] [Thread-1 (]: Timing info for test.projeto_final.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-03-30 00:56:35.358186 => 2023-03-30 00:56:35.611737
[0m00:56:35.611737 [debug] [Thread-4 (]: Began executing node test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:56:35.707251 [debug] [Thread-1 (]: Began executing node test.projeto_final.unique_my_first_dbt_model_id.16e066b321
[0m00:56:35.797766 [debug] [Thread-4 (]: Writing runtime sql for node "test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710"
[0m00:56:35.899283 [debug] [Thread-1 (]: Writing runtime sql for node "test.projeto_final.unique_my_first_dbt_model_id.16e066b321"
[0m00:56:36.072798 [debug] [Thread-4 (]: Using postgres connection "test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710"
[0m00:56:36.120311 [debug] [Thread-4 (]: On test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m00:56:36.120311 [debug] [Thread-1 (]: Using postgres connection "test.projeto_final.unique_my_first_dbt_model_id.16e066b321"
[0m00:56:36.199824 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:56:36.279824 [debug] [Thread-1 (]: On test.projeto_final.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m00:56:36.420666 [debug] [Thread-4 (]: SQL status: BEGIN in 0 seconds
[0m00:56:36.467666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:56:36.547178 [debug] [Thread-4 (]: Using postgres connection "test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710"
[0m00:56:36.705895 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m00:56:36.769261 [debug] [Thread-4 (]: On test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "postgres"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m00:56:36.864790 [debug] [Thread-1 (]: Using postgres connection "test.projeto_final.unique_my_first_dbt_model_id.16e066b321"
[0m00:56:36.991430 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0 seconds
[0m00:56:37.038942 [debug] [Thread-1 (]: On test.projeto_final.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "test.projeto_final.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:56:37.151459 [debug] [Thread-4 (]: Timing info for test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-03-30 00:56:35.787260 => 2023-03-30 00:56:37.151459
[0m00:56:37.229734 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m00:56:37.277734 [debug] [Thread-4 (]: On test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m00:56:37.356775 [debug] [Thread-1 (]: Timing info for test.projeto_final.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-03-30 00:56:35.898283 => 2023-03-30 00:56:37.356775
[0m00:56:37.482155 [debug] [Thread-4 (]: On test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m00:56:37.529664 [debug] [Thread-1 (]: On test.projeto_final.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m00:56:37.658704 [error] [Thread-4 (]: 4 of 8 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.77s]
[0m00:56:37.753780 [debug] [Thread-1 (]: On test.projeto_final.unique_my_first_dbt_model_id.16e066b321: Close
[0m00:56:37.815632 [debug] [Thread-4 (]: Finished running node test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:56:37.910787 [info ] [Thread-1 (]: 5 of 8 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 2.95s]
[0m00:56:38.052433 [debug] [Thread-1 (]: Finished running node test.projeto_final.unique_my_first_dbt_model_id.16e066b321
[0m00:56:38.210469 [debug] [Thread-4 (]: Began running node model.projeto_final.my_second_dbt_model
[0m00:56:38.258468 [info ] [Thread-4 (]: 6 of 8 SKIP relation public.my_second_dbt_model ................................ [[33mSKIP[0m]
[0m00:56:38.353984 [debug] [Thread-4 (]: Finished running node model.projeto_final.my_second_dbt_model
[0m00:56:38.449498 [debug] [Thread-1 (]: Began running node test.projeto_final.not_null_my_second_dbt_model_id.151b76d778
[0m00:56:38.449498 [debug] [Thread-4 (]: Began running node test.projeto_final.unique_my_second_dbt_model_id.57a0f8c493
[0m00:56:38.513012 [info ] [Thread-1 (]: 7 of 8 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m00:56:38.593018 [info ] [Thread-4 (]: 8 of 8 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m00:56:38.671526 [debug] [Thread-1 (]: Finished running node test.projeto_final.not_null_my_second_dbt_model_id.151b76d778
[0m00:56:38.751042 [debug] [Thread-4 (]: Finished running node test.projeto_final.unique_my_second_dbt_model_id.57a0f8c493
[0m00:56:40.055187 [debug] [Thread-3 (]: Using postgres connection "seed.projeto_final.walmart"
[0m00:56:40.056188 [debug] [Thread-3 (]: On seed.projeto_final.walmart: 
          insert into "postgres"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m00:56:40.121709 [debug] [Thread-3 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m00:56:40.127707 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m00:56:40.129709 [debug] [Thread-3 (]: On seed.projeto_final.walmart: COMMIT
[0m00:56:40.130707 [debug] [Thread-3 (]: Using postgres connection "seed.projeto_final.walmart"
[0m00:56:40.130707 [debug] [Thread-3 (]: On seed.projeto_final.walmart: COMMIT
[0m00:56:40.134710 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m00:56:40.134710 [debug] [Thread-3 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 00:56:33.029971 => 2023-03-30 00:56:40.134710
[0m00:56:40.135711 [debug] [Thread-3 (]: On seed.projeto_final.walmart: Close
[0m00:56:40.135711 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cef5b190-842d-489e-9c3d-2541c26aa206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEB7B8F50>]}
[0m00:56:40.136710 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 7 seconds
[0m00:56:40.136710 [info ] [Thread-3 (]: 3 of 8 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.11s]
[0m00:56:40.138708 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m00:56:40.139710 [debug] [Thread-3 (]: Finished running node seed.projeto_final.walmart
[0m00:56:40.139710 [debug] [Thread-2 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "postgres"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m00:56:40.141096 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m00:56:40.142113 [debug] [Thread-2 (]: On model.projeto_final.stg_walmart: COMMIT
[0m00:56:40.142113 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m00:56:40.142113 [debug] [Thread-2 (]: On model.projeto_final.stg_walmart: COMMIT
[0m00:56:40.143250 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m00:56:40.144263 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m00:56:40.144263 [debug] [Thread-2 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "postgres"."public"."stg_walmart__dbt_backup" cascade
[0m00:56:40.145260 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m00:56:40.145260 [debug] [Thread-2 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 00:56:33.102485 => 2023-03-30 00:56:40.145260
[0m00:56:40.146262 [debug] [Thread-2 (]: On model.projeto_final.stg_walmart: Close
[0m00:56:40.146262 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cef5b190-842d-489e-9c3d-2541c26aa206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEB3C3B90>]}
[0m00:56:40.147261 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 7.12s]
[0m00:56:40.147261 [debug] [Thread-2 (]: Finished running node model.projeto_final.stg_walmart
[0m00:56:40.148262 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:56:40.149261 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:40.149261 [debug] [MainThread]: On master: BEGIN
[0m00:56:40.149261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:56:40.179261 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m00:56:40.180261 [debug] [MainThread]: On master: COMMIT
[0m00:56:40.180261 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:40.180261 [debug] [MainThread]: On master: COMMIT
[0m00:56:40.180261 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m00:56:40.181262 [debug] [MainThread]: On master: Close
[0m00:56:40.181262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:56:40.182262 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:56:40.182262 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m00:56:40.182262 [debug] [MainThread]: Connection 'test.projeto_final.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m00:56:40.182262 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m00:56:40.182262 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m00:56:40.183261 [debug] [MainThread]: Connection 'test.projeto_final.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m00:56:40.183261 [info ] [MainThread]: 
[0m00:56:40.183261 [info ] [MainThread]: Finished running 1 table model, 4 tests, 2 view models, 1 seed in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m00:56:40.184262 [debug] [MainThread]: Command end result
[0m00:56:40.189266 [info ] [MainThread]: 
[0m00:56:40.190265 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:56:40.190265 [info ] [MainThread]: 
[0m00:56:40.190265 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m00:56:40.191267 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m00:56:40.191267 [info ] [MainThread]: 
[0m00:56:40.191267 [info ] [MainThread]:   compiled Code at target\compiled\projeto_final\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m00:56:40.192267 [info ] [MainThread]: 
[0m00:56:40.192267 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=3 TOTAL=8
[0m00:56:40.192267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEB78B790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAE9F39690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEAE140D0>]}
[0m00:56:40.193267 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 01:03:16.063028 | 80184390-a20d-4616-85b5-0171bb3e685c ==============================
[0m01:03:16.063028 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:03:16.065027 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m01:03:16.065027 [debug] [MainThread]: Tracking: tracking
[0m01:03:16.074028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CFF7C2C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CFEF60050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CFF30D390>]}
[0m01:03:16.082027 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:03:16.119028 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m01:03:16.120029 [debug] [MainThread]: Partial parsing: deleted file: projeto_final://models\example\my_first_dbt_model.sql
[0m01:03:16.120029 [debug] [MainThread]: Partial parsing: deleted file: projeto_final://models\example\my_second_dbt_model.sql
[0m01:03:16.124027 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m01:03:16.129032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80184390-a20d-4616-85b5-0171bb3e685c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CFF30D490>]}
[0m01:03:16.134033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80184390-a20d-4616-85b5-0171bb3e685c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CFFA32E10>]}
[0m01:03:16.134033 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m01:03:16.134033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80184390-a20d-4616-85b5-0171bb3e685c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CFCB33B50>]}
[0m01:03:16.136039 [info ] [MainThread]: 
[0m01:03:16.137034 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:03:16.139034 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:03:16.147544 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:03:16.147544 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:03:16.147544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:16.180092 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:03:16.181101 [debug] [ThreadPool]: On list_postgres: Close
[0m01:03:16.182094 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m01:03:16.187094 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:03:16.187094 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m01:03:16.188095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:16.217090 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:03:16.217090 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m01:03:16.217090 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:03:16.220090 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m01:03:16.221091 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m01:03:16.221091 [debug] [ThreadPool]: On list_postgres_public: Close
[0m01:03:16.226091 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:16.226091 [debug] [MainThread]: On master: BEGIN
[0m01:03:16.226091 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:03:16.255606 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:03:16.255606 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:16.255606 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:03:16.259606 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m01:03:16.260608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80184390-a20d-4616-85b5-0171bb3e685c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CFEF61DD0>]}
[0m01:03:16.261606 [debug] [MainThread]: On master: ROLLBACK
[0m01:03:16.261606 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:16.261606 [debug] [MainThread]: On master: BEGIN
[0m01:03:16.262607 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:03:16.262607 [debug] [MainThread]: On master: COMMIT
[0m01:03:16.262607 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:16.262607 [debug] [MainThread]: On master: COMMIT
[0m01:03:16.263606 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:03:16.263606 [debug] [MainThread]: On master: Close
[0m01:03:16.263606 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:03:16.264606 [info ] [MainThread]: 
[0m01:03:16.267606 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m01:03:16.268610 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m01:03:16.268610 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m01:03:16.268610 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m01:03:16.269607 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m01:03:16.269607 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m01:03:16.270610 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m01:03:16.270610 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m01:03:16.272611 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m01:03:16.272611 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 01:03:16.272611 => 2023-03-30 01:03:16.272611
[0m01:03:16.273610 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m01:03:16.286607 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 01:03:16.270610 => 2023-03-30 01:03:16.286607
[0m01:03:16.286607 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m01:03:16.326611 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m01:03:16.386854 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:03:16.394852 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m01:03:16.394852 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m01:03:16.394852 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m01:03:16.395848 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:03:16.395848 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:03:16.428847 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:03:16.428847 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:03:16.428847 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:03:16.428847 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m01:03:16.429851 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "postgres"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "postgres"."public"."walmart"
  );
[0m01:03:16.429851 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "postgres"."public"."walmart"
[0m01:03:16.431855 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:03:16.436860 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:03:16.436860 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "postgres"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m01:03:16.436860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:03:16.438859 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:03:16.438859 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "postgres"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m01:03:16.439858 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:03:16.453391 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m01:03:16.454379 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:03:16.454379 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m01:03:16.455331 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:03:16.459345 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:03:16.459345 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m01:03:16.459345 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "postgres"."public"."stg_walmart__dbt_backup" cascade
[0m01:03:16.546861 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m01:03:16.611869 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 01:03:16.297606 => 2023-03-30 01:03:16.611869
[0m01:03:16.722386 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m01:03:16.785899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80184390-a20d-4616-85b5-0171bb3e685c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CFFBCF690>]}
[0m01:03:16.833903 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.52s]
[0m01:03:16.897368 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m01:03:23.221451 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m01:03:23.221451 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "postgres"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m01:03:23.289973 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m01:03:23.295975 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m01:03:23.297975 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m01:03:23.298974 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m01:03:23.298974 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m01:03:23.302256 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m01:03:23.303257 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 01:03:16.273610 => 2023-03-30 01:03:23.302256
[0m01:03:23.303257 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m01:03:23.303257 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80184390-a20d-4616-85b5-0171bb3e685c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CFFBFCE10>]}
[0m01:03:23.304256 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.03s]
[0m01:03:23.304256 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m01:03:23.306256 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:03:23.306256 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:23.306256 [debug] [MainThread]: On master: BEGIN
[0m01:03:23.306256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:03:23.336669 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:03:23.336669 [debug] [MainThread]: On master: COMMIT
[0m01:03:23.336669 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:23.337685 [debug] [MainThread]: On master: COMMIT
[0m01:03:23.337685 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:03:23.337685 [debug] [MainThread]: On master: Close
[0m01:03:23.338691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:03:23.338691 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m01:03:23.338691 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m01:03:23.338691 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m01:03:23.339691 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m01:03:23.339691 [info ] [MainThread]: 
[0m01:03:23.339691 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.20 seconds (7.20s).
[0m01:03:23.340691 [debug] [MainThread]: Command end result
[0m01:03:23.344690 [info ] [MainThread]: 
[0m01:03:23.345690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:03:23.345690 [info ] [MainThread]: 
[0m01:03:23.345690 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:03:23.346690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CFFC223D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029CFF731050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C801EB390>]}
[0m01:03:23.346690 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:16:46.945848 | 2c5b84ad-6d47-4674-8a39-44ef63343808 ==============================
[0m22:16:46.945848 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:16:46.947854 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:16:46.947854 [debug] [MainThread]: Tracking: tracking
[0m22:16:46.956877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3A735950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3D283BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3CDA3B50>]}
[0m22:16:46.965456 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:16:47.023187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:16:47.023187 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\source.yml
[0m22:16:47.035448 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m22:16:47.057988 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:16:47.061988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c5b84ad-6d47-4674-8a39-44ef63343808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3CA22250>]}
[0m22:16:47.065497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c5b84ad-6d47-4674-8a39-44ef63343808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3D5CBE10>]}
[0m22:16:47.066497 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:16:47.066497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c5b84ad-6d47-4674-8a39-44ef63343808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3D14F8D0>]}
[0m22:16:47.067997 [info ] [MainThread]: 
[0m22:16:47.069517 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:16:47.070125 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:16:47.078644 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:16:47.078644 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:16:47.078644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:47.145456 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:16:47.146455 [debug] [ThreadPool]: On list_postgres: Close
[0m22:16:47.148455 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m22:16:47.153456 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:16:47.153456 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m22:16:47.154564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:47.184691 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:16:47.184691 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:16:47.184691 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:16:47.194816 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m22:16:47.195825 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m22:16:47.196824 [debug] [ThreadPool]: On list_postgres_public: Close
[0m22:16:47.200821 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:47.201820 [debug] [MainThread]: On master: BEGIN
[0m22:16:47.201820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:16:47.230781 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:16:47.231781 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:47.231781 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:16:47.239403 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m22:16:47.240403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c5b84ad-6d47-4674-8a39-44ef63343808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3D5AE7D0>]}
[0m22:16:47.240403 [debug] [MainThread]: On master: ROLLBACK
[0m22:16:47.241402 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:47.241402 [debug] [MainThread]: On master: BEGIN
[0m22:16:47.241402 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:16:47.242404 [debug] [MainThread]: On master: COMMIT
[0m22:16:47.242404 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:47.242404 [debug] [MainThread]: On master: COMMIT
[0m22:16:47.242404 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:16:47.243403 [debug] [MainThread]: On master: Close
[0m22:16:47.243403 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:16:47.244403 [info ] [MainThread]: 
[0m22:16:47.249613 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:16:47.249613 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_walmart ................................. [RUN]
[0m22:16:47.250618 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:16:47.250618 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:16:47.252617 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:16:47.253619 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:16:47.250618 => 2023-03-30 22:16:47.253619
[0m22:16:47.253619 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:16:47.281792 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:16:47.282792 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:16:47.282792 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:16:47.283793 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:16:47.316347 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:16:47.316347 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:16:47.316347 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "postgres"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "postgres"."walmart_source"."walmart"
  );
[0m22:16:47.322142 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: from "postgres"."walmart_source"."walmart"
             ^

[0m22:16:47.323144 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:16:47.323144 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:16:47.253619 => 2023-03-30 22:16:47.323144
[0m22:16:47.323144 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:16:47.331653 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: from "postgres"."walmart_source"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:16:47.331653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c5b84ad-6d47-4674-8a39-44ef63343808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3D638B90>]}
[0m22:16:47.332653 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 0.08s]
[0m22:16:47.333654 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:16:47.334653 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:16:47.335836 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:47.335836 [debug] [MainThread]: On master: BEGIN
[0m22:16:47.335836 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:16:47.364740 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:16:47.364740 [debug] [MainThread]: On master: COMMIT
[0m22:16:47.364740 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:47.365932 [debug] [MainThread]: On master: COMMIT
[0m22:16:47.365932 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:16:47.365932 [debug] [MainThread]: On master: Close
[0m22:16:47.366939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:47.366939 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m22:16:47.366939 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m22:16:47.366939 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:16:47.366939 [info ] [MainThread]: 
[0m22:16:47.367933 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m22:16:47.367933 [debug] [MainThread]: Command end result
[0m22:16:47.372932 [info ] [MainThread]: 
[0m22:16:47.372932 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:16:47.372932 [info ] [MainThread]: 
[0m22:16:47.372932 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:16:47.374436 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m22:16:47.374436 [error] [MainThread]:   LINE 7: from "postgres"."walmart_source"."walmart"
[0m22:16:47.374436 [error] [MainThread]:                ^
[0m22:16:47.374436 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:16:47.375441 [info ] [MainThread]: 
[0m22:16:47.375441 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:16:47.375441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3D638B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3D638790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3D14F8D0>]}
[0m22:16:47.376442 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:17:02.164794 | 392bbd75-9484-48ab-a13c-64ad0c912c2a ==============================
[0m22:17:02.164794 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:17:02.166461 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:17:02.166461 [debug] [MainThread]: Tracking: tracking
[0m22:17:02.175501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CCAEC5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CCD7BEC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CCDF60E10>]}
[0m22:17:02.182505 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:17:02.217546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:17:02.218546 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:17:02.218546 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:17:02.223551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '392bbd75-9484-48ab-a13c-64ad0c912c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CCDA3CFD0>]}
[0m22:17:02.228072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '392bbd75-9484-48ab-a13c-64ad0c912c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CCE044690>]}
[0m22:17:02.229072 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:17:02.229072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '392bbd75-9484-48ab-a13c-64ad0c912c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CCDF3EF50>]}
[0m22:17:02.230068 [info ] [MainThread]: 
[0m22:17:02.232066 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:17:02.233072 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:17:02.241593 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:17:02.241593 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:17:02.241593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:02.273661 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:17:02.276174 [debug] [ThreadPool]: On list_postgres: Close
[0m22:17:02.277178 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m22:17:02.282173 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:17:02.282173 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m22:17:02.282173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:02.312794 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:17:02.312794 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:17:02.312794 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:17:02.316365 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m22:17:02.317365 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m22:17:02.317365 [debug] [ThreadPool]: On list_postgres_public: Close
[0m22:17:02.322350 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:02.322350 [debug] [MainThread]: On master: BEGIN
[0m22:17:02.323350 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:17:02.351885 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:17:02.351885 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:02.351885 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:17:02.355383 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m22:17:02.357387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '392bbd75-9484-48ab-a13c-64ad0c912c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CCDF31E10>]}
[0m22:17:02.357387 [debug] [MainThread]: On master: ROLLBACK
[0m22:17:02.357387 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:02.358387 [debug] [MainThread]: On master: BEGIN
[0m22:17:02.358387 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:17:02.358387 [debug] [MainThread]: On master: COMMIT
[0m22:17:02.358387 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:02.359387 [debug] [MainThread]: On master: COMMIT
[0m22:17:02.359387 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:17:02.359387 [debug] [MainThread]: On master: Close
[0m22:17:02.360387 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:17:02.360387 [info ] [MainThread]: 
[0m22:17:02.364891 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:17:02.364891 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:17:02.364891 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:17:02.364891 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:17:02.365896 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:17:02.366896 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:17:02.366896 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:17:02.366896 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:17:02.369405 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:17:02.369405 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:17:02.369405 => 2023-03-30 22:17:02.369405
[0m22:17:02.369405 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:17:02.381913 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:17:02.366896 => 2023-03-30 22:17:02.381913
[0m22:17:02.382913 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:17:02.419949 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:17:02.420948 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:17:02.461984 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:17:02.488023 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:17:02.488023 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:17:02.488707 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:17:02.488707 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:17:02.522286 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:17:02.522286 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:17:02.522286 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:17:02.522286 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:17:02.523275 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "postgres"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "postgres"."walmart_source"."walmart"
  );
[0m22:17:02.523275 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "postgres"."public"."walmart"
[0m22:17:02.523275 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: from "postgres"."walmart_source"."walmart"
             ^

[0m22:17:02.524277 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:17:02.524277 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:17:02.390423 => 2023-03-30 22:17:02.524277
[0m22:17:02.524277 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:17:02.527527 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: from "postgres"."walmart_source"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:17:02.528526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392bbd75-9484-48ab-a13c-64ad0c912c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CCE01D110>]}
[0m22:17:02.528526 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 0.16s]
[0m22:17:02.530525 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:17:02.530525 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:17:09.266117 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:17:09.266117 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "postgres"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m22:17:09.333001 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:17:09.339520 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:17:09.353037 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:17:09.353037 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:17:09.354039 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:17:09.357885 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:17:09.358900 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:17:02.370405 => 2023-03-30 22:17:09.358900
[0m22:17:09.358900 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:17:09.359896 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392bbd75-9484-48ab-a13c-64ad0c912c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CCE372C10>]}
[0m22:17:09.359896 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 6.99s]
[0m22:17:09.360897 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:17:09.361896 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:17:09.361896 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:09.362896 [debug] [MainThread]: On master: BEGIN
[0m22:17:09.362896 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:17:09.394440 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:17:09.395440 [debug] [MainThread]: On master: COMMIT
[0m22:17:09.395440 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:09.395946 [debug] [MainThread]: On master: COMMIT
[0m22:17:09.395946 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:17:09.395946 [debug] [MainThread]: On master: Close
[0m22:17:09.396952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:09.396952 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m22:17:09.396952 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m22:17:09.396952 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:17:09.397951 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:17:09.397951 [info ] [MainThread]: 
[0m22:17:09.397951 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.17 seconds (7.17s).
[0m22:17:09.398951 [debug] [MainThread]: Command end result
[0m22:17:09.403950 [info ] [MainThread]: 
[0m22:17:09.403950 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:17:09.403950 [info ] [MainThread]: 
[0m22:17:09.403950 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:17:09.403950 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m22:17:09.405454 [error] [MainThread]:   LINE 7: from "postgres"."walmart_source"."walmart"
[0m22:17:09.405454 [error] [MainThread]:                ^
[0m22:17:09.405454 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:17:09.406461 [info ] [MainThread]: 
[0m22:17:09.406461 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:17:09.406461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CCE3D5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CCE370790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CCE372DD0>]}
[0m22:17:09.407460 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:17:35.778731 | 48bda414-5532-4eb6-a7f6-b19c7483d2c6 ==============================
[0m22:17:35.778731 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:17:35.780738 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:17:35.780738 [debug] [MainThread]: Tracking: tracking
[0m22:17:35.789248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5B7C9B450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5B75BE4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5B7A53BD0>]}
[0m22:17:35.796807 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:17:35.831341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:17:35.831341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:17:35.832359 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:17:35.837845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48bda414-5532-4eb6-a7f6-b19c7483d2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5B4C15250>]}
[0m22:17:35.841844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48bda414-5532-4eb6-a7f6-b19c7483d2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5B7D94150>]}
[0m22:17:35.842845 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:17:35.842845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48bda414-5532-4eb6-a7f6-b19c7483d2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5B5740AD0>]}
[0m22:17:35.843850 [info ] [MainThread]: 
[0m22:17:35.845850 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:17:35.846362 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:17:35.854367 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:17:35.855871 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:17:35.855871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:35.889416 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:17:35.891422 [debug] [ThreadPool]: On list_postgres: Close
[0m22:17:35.892927 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m22:17:35.897443 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:17:35.897443 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m22:17:35.897443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:35.925973 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:17:35.926979 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:17:35.926979 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:17:35.930258 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m22:17:35.930774 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m22:17:35.931781 [debug] [ThreadPool]: On list_postgres_public: Close
[0m22:17:35.936288 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:35.936288 [debug] [MainThread]: On master: BEGIN
[0m22:17:35.937294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:17:35.965989 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:17:35.965989 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:35.965989 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:17:35.970025 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m22:17:35.972025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48bda414-5532-4eb6-a7f6-b19c7483d2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5B77BE510>]}
[0m22:17:35.972025 [debug] [MainThread]: On master: ROLLBACK
[0m22:17:35.972025 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:35.972025 [debug] [MainThread]: On master: BEGIN
[0m22:17:35.973025 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:17:35.973025 [debug] [MainThread]: On master: COMMIT
[0m22:17:35.973025 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:35.974014 [debug] [MainThread]: On master: COMMIT
[0m22:17:35.974014 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:17:35.974014 [debug] [MainThread]: On master: Close
[0m22:17:35.975012 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:17:35.975012 [info ] [MainThread]: 
[0m22:17:35.979269 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:17:35.979269 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_walmart ................................. [RUN]
[0m22:17:35.980275 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:17:35.980275 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:17:35.982274 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:17:35.983274 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:17:35.980275 => 2023-03-30 22:17:35.982274
[0m22:17:35.983274 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:17:36.011358 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:17:36.012355 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:17:36.012355 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:17:36.013353 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:17:36.041838 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:17:36.041838 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:17:36.042840 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "postgres"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "postgres"."walmart_source"."walmart"
  );
[0m22:17:36.042840 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: from "postgres"."walmart_source"."walmart"
             ^

[0m22:17:36.043846 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:17:36.043846 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:17:35.983274 => 2023-03-30 22:17:36.043846
[0m22:17:36.043846 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:17:36.047351 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: from "postgres"."walmart_source"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:17:36.048351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48bda414-5532-4eb6-a7f6-b19c7483d2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5B7DB8510>]}
[0m22:17:36.048351 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 0.07s]
[0m22:17:36.050351 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:17:36.051351 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:17:36.051351 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:36.052351 [debug] [MainThread]: On master: BEGIN
[0m22:17:36.052351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:17:36.085880 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:17:36.085880 [debug] [MainThread]: On master: COMMIT
[0m22:17:36.087335 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:36.087335 [debug] [MainThread]: On master: COMMIT
[0m22:17:36.087335 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:17:36.088334 [debug] [MainThread]: On master: Close
[0m22:17:36.088334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:36.088334 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m22:17:36.089335 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m22:17:36.089335 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:17:36.089335 [info ] [MainThread]: 
[0m22:17:36.089335 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m22:17:36.090334 [debug] [MainThread]: Command end result
[0m22:17:36.094841 [info ] [MainThread]: 
[0m22:17:36.094841 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:17:36.094841 [info ] [MainThread]: 
[0m22:17:36.095842 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:17:36.095842 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m22:17:36.095842 [error] [MainThread]:   LINE 7: from "postgres"."walmart_source"."walmart"
[0m22:17:36.096939 [error] [MainThread]:                ^
[0m22:17:36.096939 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:17:36.096939 [info ] [MainThread]: 
[0m22:17:36.097940 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:17:36.097940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5B7DC2B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5B7DC0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5B7C6B450>]}
[0m22:17:36.097940 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:17:51.782173 | 58498b28-1a5a-4dd0-ad78-2d09c0de8e3e ==============================
[0m22:17:51.782173 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:17:51.783173 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:17:51.784180 [debug] [MainThread]: Tracking: tracking
[0m22:17:51.792179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A354DECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A3559AD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A355A4B10>]}
[0m22:17:51.799177 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:17:51.834691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:17:51.834691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:17:51.835690 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:17:51.840695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58498b28-1a5a-4dd0-ad78-2d09c0de8e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A32A352D0>]}
[0m22:17:51.845694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58498b28-1a5a-4dd0-ad78-2d09c0de8e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A355C4290>]}
[0m22:17:51.845694 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:17:51.845694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58498b28-1a5a-4dd0-ad78-2d09c0de8e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A32F70AD0>]}
[0m22:17:51.846696 [info ] [MainThread]: 
[0m22:17:51.848696 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:17:51.849694 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:17:51.858690 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:17:51.858690 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:17:51.858690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:51.890693 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:17:51.891698 [debug] [ThreadPool]: On list_postgres: Close
[0m22:17:51.892703 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m22:17:51.897698 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:17:51.897698 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m22:17:51.897698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:51.927216 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:17:51.927216 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:17:51.927216 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:17:51.930216 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m22:17:51.931216 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m22:17:51.931216 [debug] [ThreadPool]: On list_postgres_public: Close
[0m22:17:51.937216 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:51.937216 [debug] [MainThread]: On master: BEGIN
[0m22:17:51.937216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:17:51.966219 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:17:51.966219 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:51.967217 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:17:51.970216 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m22:17:51.971216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58498b28-1a5a-4dd0-ad78-2d09c0de8e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A35062B90>]}
[0m22:17:51.971216 [debug] [MainThread]: On master: ROLLBACK
[0m22:17:51.972221 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:51.972221 [debug] [MainThread]: On master: BEGIN
[0m22:17:51.972221 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:17:51.973222 [debug] [MainThread]: On master: COMMIT
[0m22:17:51.973222 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:51.973222 [debug] [MainThread]: On master: COMMIT
[0m22:17:51.973222 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:17:51.974220 [debug] [MainThread]: On master: Close
[0m22:17:51.974220 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:17:51.975216 [info ] [MainThread]: 
[0m22:17:51.978216 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:17:51.978216 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:17:51.979216 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:17:51.979216 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:17:51.980217 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:17:51.980217 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:17:51.980217 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:17:51.981216 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:17:51.983216 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:17:51.983216 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:17:51.983216 => 2023-03-30 22:17:51.983216
[0m22:17:51.983216 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:17:51.984217 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:17:51.981216 => 2023-03-30 22:17:51.983216
[0m22:17:51.997228 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:17:52.034735 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:17:52.100740 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:17:52.101742 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:17:52.102533 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:17:52.102533 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:17:52.102533 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:17:52.103560 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:17:52.135073 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:17:52.135073 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:17:52.135073 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:17:52.136069 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "postgres"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "postgres"."walmart_source"."walmart"
  );
[0m22:17:52.136069 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:17:52.136069 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "postgres"."public"."walmart"
[0m22:17:52.136069 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: from "postgres"."walmart_source"."walmart"
             ^

[0m22:17:52.137068 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:17:52.137068 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:17:51.997228 => 2023-03-30 22:17:52.137068
[0m22:17:52.137068 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:17:52.140070 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:17:52.141070 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: from "postgres"."walmart_source"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:17:52.210585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58498b28-1a5a-4dd0-ad78-2d09c0de8e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A35983810>]}
[0m22:17:52.274586 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 0.23s]
[0m22:17:52.401109 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:17:59.044375 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:17:59.044375 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "postgres"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m22:17:59.110903 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:17:59.116901 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:17:59.130906 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:17:59.130906 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:17:59.131907 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:17:59.134338 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:17:59.135339 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:17:51.984217 => 2023-03-30 22:17:59.135339
[0m22:17:59.135339 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:17:59.136339 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58498b28-1a5a-4dd0-ad78-2d09c0de8e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A35909390>]}
[0m22:17:59.136339 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.16s]
[0m22:17:59.137338 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:17:59.138337 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:17:59.138337 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:59.139337 [debug] [MainThread]: On master: BEGIN
[0m22:17:59.139337 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:17:59.168338 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:17:59.169338 [debug] [MainThread]: On master: COMMIT
[0m22:17:59.169338 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:59.169338 [debug] [MainThread]: On master: COMMIT
[0m22:17:59.169338 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:17:59.170339 [debug] [MainThread]: On master: Close
[0m22:17:59.170339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:59.171339 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m22:17:59.171339 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m22:17:59.171339 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:17:59.171339 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:17:59.171339 [info ] [MainThread]: 
[0m22:17:59.172339 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.32 seconds (7.32s).
[0m22:17:59.172339 [debug] [MainThread]: Command end result
[0m22:17:59.177337 [info ] [MainThread]: 
[0m22:17:59.177337 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:17:59.178339 [info ] [MainThread]: 
[0m22:17:59.178339 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:17:59.179338 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m22:17:59.179338 [error] [MainThread]:   LINE 7: from "postgres"."walmart_source"."walmart"
[0m22:17:59.179338 [error] [MainThread]:                ^
[0m22:17:59.179338 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:17:59.180338 [info ] [MainThread]: 
[0m22:17:59.180338 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:17:59.181337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A354E9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A354EA890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A3596FA50>]}
[0m22:17:59.181337 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:18:24.313446 | f114838d-caea-4498-b472-103bd822a3e1 ==============================
[0m22:18:24.313446 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:18:24.315453 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:18:24.315453 [debug] [MainThread]: Tracking: tracking
[0m22:18:24.323447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FE83FB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FE8E8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FE83E1D0>]}
[0m22:18:24.330954 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:18:24.365955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:18:24.365955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:18:24.366954 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:18:24.371954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f114838d-caea-4498-b472-103bd822a3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FE03FAD0>]}
[0m22:18:24.376956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f114838d-caea-4498-b472-103bd822a3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FE920DD0>]}
[0m22:18:24.376956 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:18:24.377958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f114838d-caea-4498-b472-103bd822a3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FE9200D0>]}
[0m22:18:24.378962 [info ] [MainThread]: 
[0m22:18:24.379960 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:18:24.380960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:18:24.389954 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:18:24.389954 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:18:24.389954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:24.422610 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:18:24.424608 [debug] [ThreadPool]: On list_postgres: Close
[0m22:18:24.425621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m22:18:24.430134 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:18:24.430134 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m22:18:24.430134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:24.459135 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:18:24.459135 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:18:24.459135 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:18:24.462137 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m22:18:24.463136 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m22:18:24.463136 [debug] [ThreadPool]: On list_postgres_public: Close
[0m22:18:24.468134 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:24.468134 [debug] [MainThread]: On master: BEGIN
[0m22:18:24.469135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:24.498682 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:18:24.498682 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:24.498682 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:18:24.502711 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m22:18:24.503711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f114838d-caea-4498-b472-103bd822a3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FD2A0A50>]}
[0m22:18:24.503711 [debug] [MainThread]: On master: ROLLBACK
[0m22:18:24.503711 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:24.504711 [debug] [MainThread]: On master: BEGIN
[0m22:18:24.504711 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:18:24.504711 [debug] [MainThread]: On master: COMMIT
[0m22:18:24.505711 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:24.505711 [debug] [MainThread]: On master: COMMIT
[0m22:18:24.505711 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:18:24.506711 [debug] [MainThread]: On master: Close
[0m22:18:24.506711 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:18:24.507710 [info ] [MainThread]: 
[0m22:18:24.510696 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:18:24.510696 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:18:24.511696 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:18:24.511696 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:18:24.512703 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:18:24.512703 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:18:24.512703 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:18:24.513700 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:18:24.515700 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:18:24.515700 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:18:24.515700 => 2023-03-30 22:18:24.515700
[0m22:18:24.515700 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:18:24.522700 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:18:24.513700 => 2023-03-30 22:18:24.522700
[0m22:18:24.529208 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:18:24.566208 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:18:24.586208 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:18:24.632722 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:18:24.633722 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:18:24.633722 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:18:24.633722 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:18:24.634723 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:18:24.666539 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:18:24.666539 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:18:24.666539 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:18:24.666539 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:18:24.667530 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "postgres"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "postgres"."walmart_source"."walmart"
  );
[0m22:18:24.667530 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "postgres"."public"."walmart"
[0m22:18:24.667530 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: from "postgres"."walmart_source"."walmart"
             ^

[0m22:18:24.667530 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:18:24.668532 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:18:24.536208 => 2023-03-30 22:18:24.668532
[0m22:18:24.668532 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:18:24.672529 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: from "postgres"."walmart_source"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:18:24.672529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f114838d-caea-4498-b472-103bd822a3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FEC67D10>]}
[0m22:18:24.673529 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:18:24.672529 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 0.16s]
[0m22:18:24.744590 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:18:31.512594 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:18:31.513595 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "postgres"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m22:18:31.581110 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:18:31.588109 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:18:31.601107 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:18:31.601107 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:18:31.601107 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:18:31.605553 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:18:31.605553 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:18:24.516700 => 2023-03-30 22:18:31.605553
[0m22:18:31.606553 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:18:31.606553 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f114838d-caea-4498-b472-103bd822a3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FECCEC50>]}
[0m22:18:31.606553 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.09s]
[0m22:18:31.607552 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:18:31.608552 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:18:31.609552 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:31.609552 [debug] [MainThread]: On master: BEGIN
[0m22:18:31.609552 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:18:31.639146 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:18:31.640155 [debug] [MainThread]: On master: COMMIT
[0m22:18:31.640155 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:31.640155 [debug] [MainThread]: On master: COMMIT
[0m22:18:31.640155 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:18:31.641145 [debug] [MainThread]: On master: Close
[0m22:18:31.641145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:31.642144 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m22:18:31.642144 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m22:18:31.642144 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:18:31.642144 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:18:31.642144 [info ] [MainThread]: 
[0m22:18:31.643144 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.26 seconds (7.26s).
[0m22:18:31.643144 [debug] [MainThread]: Command end result
[0m22:18:31.648144 [info ] [MainThread]: 
[0m22:18:31.648144 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:18:31.648144 [info ] [MainThread]: 
[0m22:18:31.649144 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:18:31.649144 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m22:18:31.649144 [error] [MainThread]:   LINE 7: from "postgres"."walmart_source"."walmart"
[0m22:18:31.650144 [error] [MainThread]:                ^
[0m22:18:31.650144 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:18:31.650144 [info ] [MainThread]: 
[0m22:18:31.651144 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:18:31.651144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FE84B250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FE151550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FE03FAD0>]}
[0m22:18:31.651144 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:19:25.790948 | 44298019-c3fd-47c3-bf84-747f91fe09b8 ==============================
[0m22:19:25.790948 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:19:25.791948 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:19:25.792948 [debug] [MainThread]: Tracking: tracking
[0m22:19:25.800947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001878F692990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001878F712490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001878D1A9A50>]}
[0m22:19:25.808945 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:19:25.845946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:19:25.845946 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:19:25.846946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:19:25.851955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44298019-c3fd-47c3-bf84-747f91fe09b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001878F69C950>]}
[0m22:19:25.856955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44298019-c3fd-47c3-bf84-747f91fe09b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001878FF04050>]}
[0m22:19:25.856955 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:19:25.857955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44298019-c3fd-47c3-bf84-747f91fe09b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001878FDD6D90>]}
[0m22:19:25.858954 [info ] [MainThread]: 
[0m22:19:25.860956 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:19:25.861955 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:19:25.870467 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:19:25.871468 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:19:25.871468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:25.905469 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:19:25.906467 [debug] [ThreadPool]: On list_postgres: Close
[0m22:19:25.908466 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m22:19:25.913466 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:19:25.913466 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m22:19:25.913466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:25.944468 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:19:25.944468 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:19:25.944468 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:19:25.947466 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m22:19:25.948466 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m22:19:25.948466 [debug] [ThreadPool]: On list_postgres_public: Close
[0m22:19:25.953472 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:25.953472 [debug] [MainThread]: On master: BEGIN
[0m22:19:25.954471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:19:25.983982 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:19:25.983982 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:25.983982 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:19:25.987982 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m22:19:25.988983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44298019-c3fd-47c3-bf84-747f91fe09b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018790164D50>]}
[0m22:19:25.989983 [debug] [MainThread]: On master: ROLLBACK
[0m22:19:25.989983 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:25.989983 [debug] [MainThread]: On master: BEGIN
[0m22:19:25.990982 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:19:25.990982 [debug] [MainThread]: On master: COMMIT
[0m22:19:25.990982 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:25.990982 [debug] [MainThread]: On master: COMMIT
[0m22:19:25.991982 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:19:25.991982 [debug] [MainThread]: On master: Close
[0m22:19:25.991982 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:19:25.992983 [info ] [MainThread]: 
[0m22:19:25.996985 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:19:25.996985 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:19:25.996985 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:19:25.997983 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:19:25.997983 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:19:25.998983 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:19:25.998983 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:19:25.998983 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:19:26.000983 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:19:26.001982 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:19:26.001982 => 2023-03-30 22:19:26.001982
[0m22:19:26.001982 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:19:26.014981 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:19:25.998983 => 2023-03-30 22:19:26.014981
[0m22:19:26.015982 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:19:26.055987 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:19:26.125090 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:19:26.126090 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:19:26.126090 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:19:26.126090 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:19:26.126090 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:19:26.127089 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:19:26.157096 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:19:26.157096 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:19:26.157096 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "postgres"."public"."walmart"
[0m22:19:26.161519 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:19:26.284564 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:19:26.348564 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:19:26.460082 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "postgres"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "postgres"."walmart_source"."walmart"
  );
[0m22:19:26.522591 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: from "postgres"."walmart_source"."walmart"
             ^

[0m22:19:26.601105 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:19:26.680619 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:19:26.022983 => 2023-03-30 22:19:26.680619
[0m22:19:26.727619 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:19:27.692089 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: from "postgres"."walmart_source"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:19:27.739088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44298019-c3fd-47c3-bf84-747f91fe09b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018790265E10>]}
[0m22:19:27.770601 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 1.74s]
[0m22:19:27.850607 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:19:33.070623 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:19:33.070623 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "postgres"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m22:19:33.136624 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:19:33.142623 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:19:33.155627 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:19:33.155627 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:19:33.155627 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:19:33.158033 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:19:33.158033 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:19:26.001982 => 2023-03-30 22:19:33.158033
[0m22:19:33.159024 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:19:33.160023 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44298019-c3fd-47c3-bf84-747f91fe09b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001879024B990>]}
[0m22:19:33.160023 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.16s]
[0m22:19:33.161021 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:19:33.162022 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:19:33.162022 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:33.163022 [debug] [MainThread]: On master: BEGIN
[0m22:19:33.163022 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:19:33.191554 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:19:33.192535 [debug] [MainThread]: On master: COMMIT
[0m22:19:33.192535 [debug] [MainThread]: Using postgres connection "master"
[0m22:19:33.192535 [debug] [MainThread]: On master: COMMIT
[0m22:19:33.193535 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:19:33.193535 [debug] [MainThread]: On master: Close
[0m22:19:33.194537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:19:33.194537 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m22:19:33.194537 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m22:19:33.194537 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:19:33.194537 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:19:33.195533 [info ] [MainThread]: 
[0m22:19:33.195533 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m22:19:33.195533 [debug] [MainThread]: Command end result
[0m22:19:33.200535 [info ] [MainThread]: 
[0m22:19:33.200535 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:19:33.201535 [info ] [MainThread]: 
[0m22:19:33.201535 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:19:33.201535 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m22:19:33.202536 [error] [MainThread]:   LINE 7: from "postgres"."walmart_source"."walmart"
[0m22:19:33.202536 [error] [MainThread]:                ^
[0m22:19:33.202536 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:19:33.203534 [info ] [MainThread]: 
[0m22:19:33.203534 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:19:33.203534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001878F8F9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001878FEB35D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018790164ED0>]}
[0m22:19:33.204534 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:20:54.188482 | e224123a-d13a-43a0-b283-d462d4f591a2 ==============================
[0m22:20:54.188482 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:20:54.189482 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:20:54.190486 [debug] [MainThread]: Tracking: tracking
[0m22:20:54.198486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B709236B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7094E42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7099DFE10>]}
[0m22:20:54.205801 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:20:54.241801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:20:54.241801 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:20:54.242822 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:20:54.247801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e224123a-d13a-43a0-b283-d462d4f591a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7092349D0>]}
[0m22:20:54.251801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e224123a-d13a-43a0-b283-d462d4f591a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B709AE4250>]}
[0m22:20:54.251801 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:20:54.252802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e224123a-d13a-43a0-b283-d462d4f591a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B707490950>]}
[0m22:20:54.253804 [info ] [MainThread]: 
[0m22:20:54.255801 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:20:54.257146 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:20:54.265150 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:20:54.266151 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:20:54.266151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:54.298675 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:20:54.299683 [debug] [ThreadPool]: On list_postgres: Close
[0m22:20:54.300683 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m22:20:54.305680 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:20:54.305680 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m22:20:54.305680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:54.334684 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:20:54.334684 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:20:54.334684 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:20:54.337686 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m22:20:54.338683 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m22:20:54.339680 [debug] [ThreadPool]: On list_postgres_public: Close
[0m22:20:54.343686 [debug] [MainThread]: Using postgres connection "master"
[0m22:20:54.344687 [debug] [MainThread]: On master: BEGIN
[0m22:20:54.344687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:20:54.373851 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:20:54.373851 [debug] [MainThread]: Using postgres connection "master"
[0m22:20:54.373851 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:20:54.377878 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m22:20:54.378879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e224123a-d13a-43a0-b283-d462d4f591a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B709522410>]}
[0m22:20:54.378879 [debug] [MainThread]: On master: ROLLBACK
[0m22:20:54.379879 [debug] [MainThread]: Using postgres connection "master"
[0m22:20:54.379879 [debug] [MainThread]: On master: BEGIN
[0m22:20:54.380878 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:20:54.380878 [debug] [MainThread]: On master: COMMIT
[0m22:20:54.380878 [debug] [MainThread]: Using postgres connection "master"
[0m22:20:54.380878 [debug] [MainThread]: On master: COMMIT
[0m22:20:54.381876 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:20:54.381876 [debug] [MainThread]: On master: Close
[0m22:20:54.381876 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:20:54.382874 [info ] [MainThread]: 
[0m22:20:54.386361 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:20:54.386361 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:20:54.386361 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:20:54.387380 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:20:54.387380 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:20:54.388375 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:20:54.388375 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:20:54.388375 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:20:54.390373 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:20:54.390373 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:20:54.390373 => 2023-03-30 22:20:54.390373
[0m22:20:54.391373 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:20:54.391373 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:20:54.388375 => 2023-03-30 22:20:54.391373
[0m22:20:54.404888 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:20:54.440888 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:20:54.508404 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:20:54.508404 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:20:54.508404 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:20:54.509410 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:20:54.509410 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:20:54.509410 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:20:54.541404 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:20:54.542403 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:20:54.542403 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:20:54.542403 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:20:54.542403 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "postgres"."public"."walmart"
[0m22:20:54.543406 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "postgres"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "postgres"."walmart_source"."walmart"
  );
[0m22:20:54.543406 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: from "postgres"."walmart_source"."walmart"
             ^

[0m22:20:54.543406 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:20:54.544404 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:20:54.411892 => 2023-03-30 22:20:54.544404
[0m22:20:54.544404 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:20:54.546258 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:20:55.104357 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: from "postgres"."walmart_source"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:20:55.105355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e224123a-d13a-43a0-b283-d462d4f591a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B709E547D0>]}
[0m22:20:55.168354 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 0.72s]
[0m22:20:55.216873 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:21:01.385805 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:21:01.385805 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "postgres"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m22:21:01.451311 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:21:01.457313 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:21:01.470312 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:21:01.470312 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:21:01.471313 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:21:01.474344 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:21:01.475345 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:20:54.391373 => 2023-03-30 22:21:01.474344
[0m22:21:01.475345 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:21:01.476356 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e224123a-d13a-43a0-b283-d462d4f591a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B709ECEC50>]}
[0m22:21:01.476356 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.09s]
[0m22:21:01.476356 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:21:01.478343 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:21:01.478343 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:01.478343 [debug] [MainThread]: On master: BEGIN
[0m22:21:01.478343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:21:01.612604 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:21:01.612604 [debug] [MainThread]: On master: COMMIT
[0m22:21:01.613613 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:01.613613 [debug] [MainThread]: On master: COMMIT
[0m22:21:01.613613 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:21:01.614616 [debug] [MainThread]: On master: Close
[0m22:21:01.614616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:01.614616 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m22:21:01.615606 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m22:21:01.615606 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:21:01.615606 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:21:01.615606 [info ] [MainThread]: 
[0m22:21:01.616602 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.36 seconds (7.36s).
[0m22:21:01.616602 [debug] [MainThread]: Command end result
[0m22:21:01.620601 [info ] [MainThread]: 
[0m22:21:01.621603 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:21:01.621603 [info ] [MainThread]: 
[0m22:21:01.622604 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:21:01.622604 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m22:21:01.622604 [error] [MainThread]:   LINE 7: from "postgres"."walmart_source"."walmart"
[0m22:21:01.622604 [error] [MainThread]:                ^
[0m22:21:01.623604 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:21:01.623604 [info ] [MainThread]: 
[0m22:21:01.623604 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:21:01.624602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7094E7A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B709D583D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B709E81C10>]}
[0m22:21:01.624602 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:21:33.596898 | 69145324-3c49-4ea9-9d08-1e5874669ee2 ==============================
[0m22:21:33.596898 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:21:33.598899 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:21:33.598899 [debug] [MainThread]: Tracking: tracking
[0m22:21:33.607905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015ED11FB510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015ED097B510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015ED097AB10>]}
[0m22:21:33.615903 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:21:33.651435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:21:33.651435 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\staging\stg_walmart.sql
[0m22:21:33.662433 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m22:21:33.671434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015ED113C850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015ED113C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015ED148C950>]}
[0m22:21:33.672434 [debug] [MainThread]: Flushing usage events
[0m22:21:34.307450 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.projeto_final.stg_walmart' (models\staging\stg_walmart.sql) depends on a source named 'walmart_source.postgres' which was not found


============================== 2023-03-30 22:21:46.793970 | 36229851-93cf-4e69-9d8e-c2aeb8557189 ==============================
[0m22:21:46.793970 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:21:46.795218 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:21:46.796233 [debug] [MainThread]: Tracking: tracking
[0m22:21:46.804401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D7F7B2DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D7FCDD550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D7F4A0510>]}
[0m22:21:46.811402 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:21:46.847914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:21:46.848918 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\staging\stg_walmart.sql
[0m22:21:46.858915 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m22:21:46.868915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D00005910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D00005A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D00005090>]}
[0m22:21:46.868915 [debug] [MainThread]: Flushing usage events
[0m22:21:47.500968 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.projeto_final.stg_walmart' (models\staging\stg_walmart.sql) depends on a source named 'walmart_source.postgres' which was not found


============================== 2023-03-30 22:21:52.896941 | 71f93042-c544-496e-8d31-808c38678bde ==============================
[0m22:21:52.896941 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:21:52.898941 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:21:52.898941 [debug] [MainThread]: Tracking: tracking
[0m22:21:52.907941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AFE169D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AFDBBB850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AFDBBACD0>]}
[0m22:21:52.914942 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:21:52.950453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:21:52.950453 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\staging\stg_walmart.sql
[0m22:21:52.961452 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m22:21:52.971452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AFE0B4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AFE187810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AFE1681D0>]}
[0m22:21:52.971452 [debug] [MainThread]: Flushing usage events
[0m22:21:53.641956 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.projeto_final.stg_walmart' (models\staging\stg_walmart.sql) depends on a source named 'postgres.walmart' which was not found


============================== 2023-03-30 22:22:00.277385 | 8cae58f1-f88b-4670-9667-ace1561b5f12 ==============================
[0m22:22:00.277385 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:22:00.278385 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:22:00.279385 [debug] [MainThread]: Tracking: tracking
[0m22:22:00.287385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E576F92F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E576CDE990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E576D12010>]}
[0m22:22:00.295385 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:22:00.330391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:22:00.331391 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:22:00.331391 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:22:00.336392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cae58f1-f88b-4670-9667-ace1561b5f12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5777C5850>]}
[0m22:22:00.341896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cae58f1-f88b-4670-9667-ace1561b5f12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E577584350>]}
[0m22:22:00.341896 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:22:00.341896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cae58f1-f88b-4670-9667-ace1561b5f12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E574F30910>]}
[0m22:22:00.343901 [info ] [MainThread]: 
[0m22:22:00.344902 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:22:00.345901 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:22:00.354903 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:22:00.354903 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:22:00.355913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:00.387902 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:22:00.388903 [debug] [ThreadPool]: On list_postgres: Close
[0m22:22:00.390903 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m22:22:00.394902 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:22:00.395902 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m22:22:00.395902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:00.424904 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:22:00.424904 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:22:00.425906 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:22:00.427909 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m22:22:00.428916 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m22:22:00.428916 [debug] [ThreadPool]: On list_postgres_public: Close
[0m22:22:00.433910 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:00.433910 [debug] [MainThread]: On master: BEGIN
[0m22:22:00.433910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:22:00.466423 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:22:00.466423 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:00.467422 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:22:00.470423 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m22:22:00.471424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cae58f1-f88b-4670-9667-ace1561b5f12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E576CA3110>]}
[0m22:22:00.472424 [debug] [MainThread]: On master: ROLLBACK
[0m22:22:00.472424 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:00.472424 [debug] [MainThread]: On master: BEGIN
[0m22:22:00.473424 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:22:00.473424 [debug] [MainThread]: On master: COMMIT
[0m22:22:00.473424 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:00.473424 [debug] [MainThread]: On master: COMMIT
[0m22:22:00.474422 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:22:00.474422 [debug] [MainThread]: On master: Close
[0m22:22:00.474422 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:22:00.475433 [info ] [MainThread]: 
[0m22:22:00.479424 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:22:00.479424 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:22:00.479424 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:22:00.480425 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:22:00.480425 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:22:00.481425 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:22:00.481425 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:22:00.481425 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:22:00.483426 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:22:00.483426 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:22:00.483426 => 2023-03-30 22:22:00.483426
[0m22:22:00.484423 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:22:00.484423 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:22:00.481425 => 2023-03-30 22:22:00.484423
[0m22:22:00.497424 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:22:00.535426 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:22:00.602940 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:22:00.603940 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:22:00.603940 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:22:00.603940 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:22:00.603940 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:22:00.604938 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:22:00.636944 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:22:00.636944 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:22:00.636944 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:22:00.636944 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:22:00.637946 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "postgres"."public"."walmart"
[0m22:22:00.637946 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "postgres"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "postgres"."walmart_source"."walmart"
  );
[0m22:22:00.638945 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: from "postgres"."walmart_source"."walmart"
             ^

[0m22:22:00.638945 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:22:00.638945 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:22:00.504423 => 2023-03-30 22:22:00.638945
[0m22:22:00.638945 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:22:00.641941 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:22:00.956838 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: from "postgres"."walmart_source"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:22:01.019837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cae58f1-f88b-4670-9667-ace1561b5f12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E577369190>]}
[0m22:22:01.067362 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 0.54s]
[0m22:22:01.163886 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:22:07.732897 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:22:07.733896 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "postgres"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m22:22:07.798408 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:22:07.804407 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:22:07.817407 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:22:07.817407 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:22:07.817407 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:22:07.821413 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:22:07.822410 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:22:00.484423 => 2023-03-30 22:22:07.822410
[0m22:22:07.822410 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:22:07.823407 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cae58f1-f88b-4670-9667-ace1561b5f12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E576CFCD90>]}
[0m22:22:07.823407 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.34s]
[0m22:22:07.824409 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:22:07.825407 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:22:07.825407 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:07.825407 [debug] [MainThread]: On master: BEGIN
[0m22:22:07.826409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:22:07.857425 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:22:07.858427 [debug] [MainThread]: On master: COMMIT
[0m22:22:07.858427 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:07.858427 [debug] [MainThread]: On master: COMMIT
[0m22:22:07.858427 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:22:07.859427 [debug] [MainThread]: On master: Close
[0m22:22:07.859427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:22:07.859427 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m22:22:07.860431 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m22:22:07.860431 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:22:07.860431 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:22:07.860431 [info ] [MainThread]: 
[0m22:22:07.861424 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.52 seconds (7.52s).
[0m22:22:07.861424 [debug] [MainThread]: Command end result
[0m22:22:07.866760 [info ] [MainThread]: 
[0m22:22:07.866760 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:22:07.866760 [info ] [MainThread]: 
[0m22:22:07.867761 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:22:07.867761 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m22:22:07.867761 [error] [MainThread]:   LINE 7: from "postgres"."walmart_source"."walmart"
[0m22:22:07.868760 [error] [MainThread]:                ^
[0m22:22:07.868760 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:22:07.868760 [info ] [MainThread]: 
[0m22:22:07.868760 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:22:07.869761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E576D7B050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5778B52D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E577F7D950>]}
[0m22:22:07.869761 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:23:31.606781 | cf10e9f2-6877-4c3c-bb80-d3b3120bebc7 ==============================
[0m22:23:31.606781 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:23:31.607781 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:23:31.608780 [debug] [MainThread]: Tracking: tracking
[0m22:23:31.616777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023299B13AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023299A6BD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023299554990>]}
[0m22:23:31.624782 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:23:31.659781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:23:31.659781 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:23:31.660781 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:23:31.665781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf10e9f2-6877-4c3c-bb80-d3b3120bebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023299D85D90>]}
[0m22:23:31.670779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf10e9f2-6877-4c3c-bb80-d3b3120bebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023299A6C990>]}
[0m22:23:31.670779 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:23:31.671344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf10e9f2-6877-4c3c-bb80-d3b3120bebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023299554990>]}
[0m22:23:31.672371 [info ] [MainThread]: 
[0m22:23:31.673361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:23:31.675360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:23:31.683363 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:23:31.683363 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:23:31.684365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:31.722878 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:23:31.723881 [debug] [ThreadPool]: On list_postgres: Close
[0m22:23:31.724879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m22:23:31.729878 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:23:31.729878 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m22:23:31.729878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:31.759098 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:23:31.759098 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:23:31.759098 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:23:31.763117 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m22:23:31.764112 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m22:23:31.764112 [debug] [ThreadPool]: On list_postgres_public: Close
[0m22:23:31.769114 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:31.769114 [debug] [MainThread]: On master: BEGIN
[0m22:23:31.769114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:23:31.797632 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:23:31.798632 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:31.798632 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:23:31.802636 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m22:23:31.803633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf10e9f2-6877-4c3c-bb80-d3b3120bebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232976C6FD0>]}
[0m22:23:31.804632 [debug] [MainThread]: On master: ROLLBACK
[0m22:23:31.804632 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:31.804632 [debug] [MainThread]: On master: BEGIN
[0m22:23:31.804632 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:23:31.805638 [debug] [MainThread]: On master: COMMIT
[0m22:23:31.805638 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:31.805638 [debug] [MainThread]: On master: COMMIT
[0m22:23:31.806637 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:23:31.806637 [debug] [MainThread]: On master: Close
[0m22:23:31.806637 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:23:31.807633 [info ] [MainThread]: 
[0m22:23:31.810632 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:23:31.810632 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:23:31.811632 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:23:31.811632 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:23:31.812634 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:23:31.812634 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:23:31.812634 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:23:31.813631 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:23:31.815633 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:23:31.815633 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:23:31.815633 => 2023-03-30 22:23:31.815633
[0m22:23:31.815633 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:23:31.828632 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:23:31.813631 => 2023-03-30 22:23:31.828632
[0m22:23:31.828632 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:23:31.867664 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:23:31.938430 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:23:31.938430 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:23:31.938430 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:23:31.938430 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:23:31.938430 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:23:31.939430 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:23:31.977434 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:23:31.977434 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:23:31.977434 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:23:31.978435 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "postgres"."public"."walmart"
[0m22:23:31.978435 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:23:31.978435 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "postgres"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "postgres"."walmart_source"."walmart"
  );
[0m22:23:31.979435 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: from "postgres"."walmart_source"."walmart"
             ^

[0m22:23:31.979435 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:23:31.980435 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:23:31.836637 => 2023-03-30 22:23:31.979435
[0m22:23:31.980435 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:23:31.982440 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:23:32.416634 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: from "postgres"."walmart_source"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:23:32.462978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf10e9f2-6877-4c3c-bb80-d3b3120bebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023299B34790>]}
[0m22:23:32.510482 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 0.65s]
[0m22:23:32.606999 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:23:38.710977 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:23:38.711978 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "postgres"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m22:23:38.777979 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:23:38.783992 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:23:38.796512 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:23:38.797514 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:23:38.797514 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:23:38.801510 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:23:38.801510 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:23:31.815633 => 2023-03-30 22:23:38.801510
[0m22:23:38.802514 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:23:38.802514 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf10e9f2-6877-4c3c-bb80-d3b3120bebc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023299A4C610>]}
[0m22:23:38.803513 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 6.99s]
[0m22:23:38.803513 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:23:38.804510 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:23:38.805510 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:38.805510 [debug] [MainThread]: On master: BEGIN
[0m22:23:38.805510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:23:38.836355 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:23:38.836355 [debug] [MainThread]: On master: COMMIT
[0m22:23:38.836355 [debug] [MainThread]: Using postgres connection "master"
[0m22:23:38.837372 [debug] [MainThread]: On master: COMMIT
[0m22:23:38.837372 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:23:38.837372 [debug] [MainThread]: On master: Close
[0m22:23:38.838382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:38.838382 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m22:23:38.838382 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m22:23:38.839382 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:23:38.839382 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:23:38.839382 [info ] [MainThread]: 
[0m22:23:38.840373 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.17 seconds (7.17s).
[0m22:23:38.840373 [debug] [MainThread]: Command end result
[0m22:23:38.844369 [info ] [MainThread]: 
[0m22:23:38.845374 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:23:38.845374 [info ] [MainThread]: 
[0m22:23:38.846371 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:23:38.846371 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m22:23:38.846371 [error] [MainThread]:   LINE 7: from "postgres"."walmart_source"."walmart"
[0m22:23:38.847369 [error] [MainThread]:                ^
[0m22:23:38.847369 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:23:38.847369 [info ] [MainThread]: 
[0m22:23:38.847369 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:23:38.848370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232992A40D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002329A6FA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023299A4CC10>]}
[0m22:23:38.848370 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:24:08.456890 | 97332c43-bbf0-45cd-b662-75cc5ffcdd65 ==============================
[0m22:24:08.456890 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:24:08.458890 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m22:24:08.458890 [debug] [MainThread]: Tracking: tracking
[0m22:24:08.469890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F1AFB110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F1B02550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F1FCAED0>]}
[0m22:24:08.474451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F22B83D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F22B9F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F1DE4C90>]}
[0m22:24:08.475452 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:24:13.522195 | 4d4dd52c-1e15-4098-a209-741133b3aa55 ==============================
[0m22:24:13.522195 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:24:13.523825 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:24:13.524365 [debug] [MainThread]: Tracking: tracking
[0m22:24:13.532382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC8B82D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC8AE2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC8601AD0>]}
[0m22:24:13.540383 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:24:13.540383 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:24:13.541381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4d4dd52c-1e15-4098-a209-741133b3aa55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC8B9DCD0>]}
[0m22:24:13.979448 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m22:24:14.029964 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:24:14.033964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d4dd52c-1e15-4098-a209-741133b3aa55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC89F4E90>]}
[0m22:24:14.041964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d4dd52c-1e15-4098-a209-741133b3aa55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC8BFE5D0>]}
[0m22:24:14.041964 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:24:14.041964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d4dd52c-1e15-4098-a209-741133b3aa55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC83C9250>]}
[0m22:24:14.042965 [info ] [MainThread]: 
[0m22:24:14.044963 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:24:14.045963 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m22:24:14.054964 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:24:14.054964 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:24:14.054964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:14.093964 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:24:14.095962 [debug] [ThreadPool]: On list_postgres: Close
[0m22:24:14.096964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m22:24:14.100963 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:24:14.101963 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m22:24:14.101963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:14.130855 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:24:14.131383 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:24:14.131383 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:24:14.134391 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m22:24:14.136389 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m22:24:14.136389 [debug] [ThreadPool]: On list_postgres_public: Close
[0m22:24:14.141389 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:14.141389 [debug] [MainThread]: On master: BEGIN
[0m22:24:14.141389 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:24:14.170389 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:24:14.171389 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:14.171389 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:24:14.175389 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m22:24:14.176389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d4dd52c-1e15-4098-a209-741133b3aa55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC8E5D050>]}
[0m22:24:14.176389 [debug] [MainThread]: On master: ROLLBACK
[0m22:24:14.176389 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:14.177389 [debug] [MainThread]: On master: BEGIN
[0m22:24:14.177389 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:24:14.177389 [debug] [MainThread]: On master: COMMIT
[0m22:24:14.177389 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:14.178389 [debug] [MainThread]: On master: COMMIT
[0m22:24:14.178389 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:24:14.178389 [debug] [MainThread]: On master: Close
[0m22:24:14.179389 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:24:14.179389 [info ] [MainThread]: 
[0m22:24:14.182389 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:24:14.183389 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:24:14.183389 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:24:14.183389 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:24:14.184392 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:24:14.184392 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:24:14.185391 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:24:14.185391 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:24:14.187390 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:24:14.188389 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:24:14.188389 => 2023-03-30 22:24:14.188389
[0m22:24:14.188389 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:24:14.208393 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:24:14.185391 => 2023-03-30 22:24:14.208393
[0m22:24:14.209393 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:24:14.285903 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:24:14.285903 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:24:14.307907 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:24:14.307907 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:24:14.309907 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:24:14.309907 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:24:14.309907 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:24:14.347916 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:24:14.347916 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:24:14.347916 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "postgres"."public"."walmart"
[0m22:24:14.347916 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:24:14.348920 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:24:14.348920 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "postgres"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "postgres"."walmart_source"."walmart"
  );
[0m22:24:14.348920 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: from "postgres"."walmart_source"."walmart"
             ^

[0m22:24:14.349919 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:24:14.349919 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:24:14.270902 => 2023-03-30 22:24:14.349919
[0m22:24:14.349919 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:24:14.351917 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:24:14.770926 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: from "postgres"."walmart_source"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:24:14.849442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4dd52c-1e15-4098-a209-741133b3aa55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC8F78F90>]}
[0m22:24:14.912446 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 0.67s]
[0m22:24:14.960806 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:24:21.199526 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:24:21.199526 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "postgres"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%...
[0m22:24:21.263353 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:24:21.269218 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:24:21.283217 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:24:21.283217 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:24:21.283217 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:24:21.287217 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:24:21.288218 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:24:14.188389 => 2023-03-30 22:24:21.288218
[0m22:24:21.288218 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:24:21.289219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d4dd52c-1e15-4098-a209-741133b3aa55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC8F7EC10>]}
[0m22:24:21.289219 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.10s]
[0m22:24:21.289219 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:24:21.291217 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:24:21.291217 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:21.291217 [debug] [MainThread]: On master: BEGIN
[0m22:24:21.291217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:24:21.325316 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:24:21.325316 [debug] [MainThread]: On master: COMMIT
[0m22:24:21.325316 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:21.326344 [debug] [MainThread]: On master: COMMIT
[0m22:24:21.326344 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:24:21.326344 [debug] [MainThread]: On master: Close
[0m22:24:21.327334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:21.327334 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m22:24:21.327334 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m22:24:21.327334 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:24:21.327334 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:24:21.328329 [info ] [MainThread]: 
[0m22:24:21.328329 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.28 seconds (7.28s).
[0m22:24:21.328329 [debug] [MainThread]: Command end result
[0m22:24:21.333329 [info ] [MainThread]: 
[0m22:24:21.333329 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:24:21.334336 [info ] [MainThread]: 
[0m22:24:21.334336 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:24:21.334336 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m22:24:21.335335 [error] [MainThread]:   LINE 7: from "postgres"."walmart_source"."walmart"
[0m22:24:21.335335 [error] [MainThread]:                ^
[0m22:24:21.335335 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:24:21.336330 [info ] [MainThread]: 
[0m22:24:21.336330 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:24:21.336330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC8AB26D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC7EC5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FC86C3D10>]}
[0m22:24:21.337335 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:27:00.102003 | e6d23a05-873c-45f8-9dfe-05cb09ee6ee7 ==============================
[0m22:27:00.102003 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:27:00.104009 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m22:27:00.104009 [debug] [MainThread]: Tracking: tracking
[0m22:27:00.113003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021571E7BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021571A5DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021571E68410>]}
[0m22:27:00.117008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215716D10D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021571E6A310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002157196AA10>]}
[0m22:27:00.117008 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:27:05.083660 | c21014ea-4e1e-408c-9bd9-315688122d45 ==============================
[0m22:27:05.083660 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:27:05.085651 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:27:05.085651 [debug] [MainThread]: Tracking: tracking
[0m22:27:05.093651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186ED69B410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186ED193E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186ED1DAC50>]}
[0m22:27:05.101652 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:27:05.102653 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:27:05.102653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c21014ea-4e1e-408c-9bd9-315688122d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186ED6DFE90>]}
[0m22:27:05.550757 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m22:27:05.601757 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:27:05.605754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c21014ea-4e1e-408c-9bd9-315688122d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186ED7E3350>]}
[0m22:27:05.610755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c21014ea-4e1e-408c-9bd9-315688122d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186ED9FAD50>]}
[0m22:27:05.610755 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:27:05.611755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c21014ea-4e1e-408c-9bd9-315688122d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186ED7E31D0>]}
[0m22:27:05.612755 [info ] [MainThread]: 
[0m22:27:05.613755 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:27:05.615757 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m22:27:05.623763 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m22:27:05.623763 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m22:27:05.623763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:05.656274 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:27:05.657276 [debug] [ThreadPool]: On list_projeto: Close
[0m22:27:05.659275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m22:27:05.663273 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:27:05.664273 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m22:27:05.664273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:05.692274 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:27:05.693274 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:27:05.693274 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:27:05.695273 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m22:27:05.697278 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m22:27:05.697732 [debug] [ThreadPool]: On list_projeto_public: Close
[0m22:27:05.701750 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:05.702751 [debug] [MainThread]: On master: BEGIN
[0m22:27:05.702751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:27:05.730750 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:27:05.732254 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:05.732254 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:27:05.735259 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:27:05.736260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c21014ea-4e1e-408c-9bd9-315688122d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186EDA32F50>]}
[0m22:27:05.737261 [debug] [MainThread]: On master: ROLLBACK
[0m22:27:05.737261 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:05.737261 [debug] [MainThread]: On master: BEGIN
[0m22:27:05.738265 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:27:05.738265 [debug] [MainThread]: On master: COMMIT
[0m22:27:05.738265 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:05.738265 [debug] [MainThread]: On master: COMMIT
[0m22:27:05.739260 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:27:05.739260 [debug] [MainThread]: On master: Close
[0m22:27:05.739260 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:27:05.740263 [info ] [MainThread]: 
[0m22:27:05.744259 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:27:05.744259 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:27:05.744259 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:27:05.745261 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:27:05.745261 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:27:05.746260 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:27:05.746260 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:27:05.746260 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:27:05.749259 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:27:05.749259 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:27:05.749259 => 2023-03-30 22:27:05.749259
[0m22:27:05.750260 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:27:05.783264 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:27:05.746260 => 2023-03-30 22:27:05.783264
[0m22:27:05.836774 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:27:05.847774 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:27:05.877697 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:27:05.877697 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:27:05.878698 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:27:05.880699 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:27:05.880699 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:27:05.880699 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:27:05.911694 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:27:05.911694 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:27:05.912694 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "projeto"."public"."walmart"
[0m22:27:05.914700 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:27:05.914700 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:27:05.914700 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "postgres"."walmart_source"."walmart"
  );
[0m22:27:05.916700 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:27:05.939218 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "postgres.walmart_source.walmart"
LINE 7: from "postgres"."walmart_source"."walmart"
             ^

[0m22:27:06.049734 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:27:06.145254 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:27:05.848681 => 2023-03-30 22:27:06.145254
[0m22:27:06.225257 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:27:07.320323 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  cross-database references are not implemented: "postgres.walmart_source.walmart"
  LINE 7: from "postgres"."walmart_source"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:27:07.383834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21014ea-4e1e-408c-9bd9-315688122d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186EDBA7E10>]}
[0m22:27:07.464346 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 1.64s]
[0m22:27:07.513353 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:27:12.781467 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:27:12.781467 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "projeto"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m22:27:12.848981 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:27:12.854982 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:27:12.868982 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:27:12.868982 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:27:12.868982 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:27:12.873215 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:27:12.873215 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:27:05.750260 => 2023-03-30 22:27:12.873215
[0m22:27:12.874214 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:27:12.874214 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21014ea-4e1e-408c-9bd9-315688122d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186ED200610>]}
[0m22:27:12.875214 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.13s]
[0m22:27:12.875214 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:27:12.877213 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:27:12.877213 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:12.877213 [debug] [MainThread]: On master: BEGIN
[0m22:27:12.877213 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:27:12.907213 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:27:12.907213 [debug] [MainThread]: On master: COMMIT
[0m22:27:12.908215 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:12.908215 [debug] [MainThread]: On master: COMMIT
[0m22:27:12.908215 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:27:12.908215 [debug] [MainThread]: On master: Close
[0m22:27:12.909214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:27:12.909214 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m22:27:12.909214 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m22:27:12.909214 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:27:12.910214 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:27:12.910214 [info ] [MainThread]: 
[0m22:27:12.910214 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.30 seconds (7.30s).
[0m22:27:12.911215 [debug] [MainThread]: Command end result
[0m22:27:12.915212 [info ] [MainThread]: 
[0m22:27:12.916217 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:27:12.916217 [info ] [MainThread]: 
[0m22:27:12.916217 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:27:12.917215 [error] [MainThread]:   cross-database references are not implemented: "postgres.walmart_source.walmart"
[0m22:27:12.917215 [error] [MainThread]:   LINE 7: from "postgres"."walmart_source"."walmart"
[0m22:27:12.917215 [error] [MainThread]:                ^
[0m22:27:12.918213 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:27:12.918213 [info ] [MainThread]: 
[0m22:27:12.918213 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:27:12.919213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186EDB4F190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186ECFF0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186EDBB5A90>]}
[0m22:27:12.919213 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:27:54.590326 | 3eba2d9d-c3f9-4d70-a3b8-f427ca8a1018 ==============================
[0m22:27:54.590326 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:27:54.592269 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m22:27:54.592269 [debug] [MainThread]: Tracking: tracking
[0m22:27:54.600286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A0F8B0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A0F8E0BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A1008C610>]}
[0m22:27:54.604284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A1008C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A0F8B0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A1004ED10>]}
[0m22:27:54.605288 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:27:58.634202 | 1e8b2a87-92a5-466e-a68a-e7e4c7892bd0 ==============================
[0m22:27:58.634202 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:27:58.635956 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:27:58.635956 [debug] [MainThread]: Tracking: tracking
[0m22:27:58.752875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45FF51010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E460002F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45F78A550>]}
[0m22:27:58.760882 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:27:58.760882 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:27:58.761883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1e8b2a87-92a5-466e-a68a-e7e4c7892bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45FA58990>]}
[0m22:27:59.227449 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m22:27:59.273972 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:27:59.278959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e8b2a87-92a5-466e-a68a-e7e4c7892bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45FF49AD0>]}
[0m22:27:59.282964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e8b2a87-92a5-466e-a68a-e7e4c7892bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E460261E90>]}
[0m22:27:59.283961 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:27:59.283961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e8b2a87-92a5-466e-a68a-e7e4c7892bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E46003D710>]}
[0m22:27:59.284959 [info ] [MainThread]: 
[0m22:27:59.286961 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:27:59.287960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m22:27:59.296959 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m22:27:59.296959 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m22:27:59.296959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:59.328959 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:27:59.330961 [debug] [ThreadPool]: On list_projeto: Close
[0m22:27:59.331962 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m22:27:59.336964 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:27:59.336964 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m22:27:59.336964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:59.467151 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:27:59.467151 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:27:59.467151 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:27:59.470666 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m22:27:59.471662 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m22:27:59.471662 [debug] [ThreadPool]: On list_projeto_public: Close
[0m22:27:59.476665 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:59.476665 [debug] [MainThread]: On master: BEGIN
[0m22:27:59.476665 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:27:59.505666 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:27:59.505666 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:59.506661 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:27:59.509665 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:27:59.510662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e8b2a87-92a5-466e-a68a-e7e4c7892bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4600141D0>]}
[0m22:27:59.510662 [debug] [MainThread]: On master: ROLLBACK
[0m22:27:59.511661 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:59.511661 [debug] [MainThread]: On master: BEGIN
[0m22:27:59.511661 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:27:59.511661 [debug] [MainThread]: On master: COMMIT
[0m22:27:59.512662 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:59.512662 [debug] [MainThread]: On master: COMMIT
[0m22:27:59.512662 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:27:59.513661 [debug] [MainThread]: On master: Close
[0m22:27:59.513661 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:27:59.513661 [info ] [MainThread]: 
[0m22:27:59.517661 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:27:59.517661 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:27:59.518624 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:27:59.518624 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:27:59.519636 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:27:59.519636 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:27:59.519636 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:27:59.520635 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:27:59.522636 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:27:59.522636 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:27:59.522636 => 2023-03-30 22:27:59.522636
[0m22:27:59.523637 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:27:59.617152 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:27:59.617152 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:27:59.520635 => 2023-03-30 22:27:59.617152
[0m22:27:59.618151 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:27:59.618151 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:27:59.618151 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:27:59.644149 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:27:59.646150 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:27:59.646150 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:27:59.646150 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:27:59.676673 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:27:59.677672 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:27:59.677672 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:27:59.677672 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "projeto"."public"."walmart"
[0m22:27:59.677672 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:27:59.678672 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."walmart_source"."walmart"
  );
[0m22:27:59.678672 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: from "projeto"."walmart_source"."walmart"
             ^

[0m22:27:59.678672 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:27:59.679671 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:27:59.618151 => 2023-03-30 22:27:59.679671
[0m22:27:59.679671 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:27:59.681675 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:28:00.366328 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: from "projeto"."walmart_source"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:28:00.428836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8b2a87-92a5-466e-a68a-e7e4c7892bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4603FF090>]}
[0m22:28:00.492352 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 0.91s]
[0m22:28:00.557357 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:28:06.560306 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:28:06.560306 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "projeto"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m22:28:06.624825 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:28:06.631830 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:28:06.644825 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:28:06.645825 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:28:06.645825 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:28:06.649339 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:28:06.650340 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:27:59.523637 => 2023-03-30 22:28:06.649339
[0m22:28:06.650340 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:28:06.650340 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8b2a87-92a5-466e-a68a-e7e4c7892bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E460417C50>]}
[0m22:28:06.651337 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.13s]
[0m22:28:06.651337 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:28:06.653339 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:28:06.653339 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:06.653339 [debug] [MainThread]: On master: BEGIN
[0m22:28:06.653339 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:28:06.682860 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:28:06.683860 [debug] [MainThread]: On master: COMMIT
[0m22:28:06.683860 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:06.683860 [debug] [MainThread]: On master: COMMIT
[0m22:28:06.683860 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:28:06.684859 [debug] [MainThread]: On master: Close
[0m22:28:06.684859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:28:06.684859 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m22:28:06.685859 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m22:28:06.685859 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:28:06.685859 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:28:06.685859 [info ] [MainThread]: 
[0m22:28:06.686858 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m22:28:06.686858 [debug] [MainThread]: Command end result
[0m22:28:06.691860 [info ] [MainThread]: 
[0m22:28:06.691860 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:28:06.692859 [info ] [MainThread]: 
[0m22:28:06.692859 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:28:06.692859 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m22:28:06.693858 [error] [MainThread]:   LINE 7: from "projeto"."walmart_source"."walmart"
[0m22:28:06.693858 [error] [MainThread]:                ^
[0m22:28:06.693858 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:28:06.694858 [info ] [MainThread]: 
[0m22:28:06.694858 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:28:06.694858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E46043B750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45F335790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E45FF22010>]}
[0m22:28:06.694858 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:29:23.201584 | 911a4d51-cd27-405d-a4ae-875cf7b71165 ==============================
[0m22:29:23.201584 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:29:23.203584 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:29:23.203584 [debug] [MainThread]: Tracking: tracking
[0m22:29:23.212584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C1BC3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C20EFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C20F8C90>]}
[0m22:29:23.220593 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:29:23.256100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:29:23.256100 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\staging\stg_walmart.sql
[0m22:29:23.267102 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m22:29:23.277101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C1B62390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C18A3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C21220D0>]}
[0m22:29:23.277101 [debug] [MainThread]: Flushing usage events
[0m22:29:23.959881 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.projeto_final.stg_walmart' (models\staging\stg_walmart.sql) depends on a source named 'pulbic.walmart_source.walmart' which was not found


============================== 2023-03-30 22:31:49.681211 | 51f579f8-f75c-4b7c-a114-a9699864f767 ==============================
[0m22:31:49.681211 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:31:49.682211 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:31:49.683210 [debug] [MainThread]: Tracking: tracking
[0m22:31:49.692210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D229A7C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D22A46D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D2264C4D0>]}
[0m22:31:49.700215 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:31:49.737241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:31:49.738240 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\staging\stg_walmart.sql
[0m22:31:49.749241 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m22:31:49.759240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D22900450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D22726E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D2270B650>]}
[0m22:31:49.759240 [debug] [MainThread]: Flushing usage events
[0m22:31:50.433775 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.projeto_final.stg_walmart' (models\staging\stg_walmart.sql) depends on a source named 'pulbic.walmart_source.walmart' which was not found


============================== 2023-03-30 22:32:16.621636 | 5883db66-fe21-4c7f-b15a-a8751c7e607a ==============================
[0m22:32:16.621636 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:32:16.622637 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:32:16.623633 [debug] [MainThread]: Tracking: tracking
[0m22:32:16.632151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C5A12E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C6264450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C5D5C5D0>]}
[0m22:32:16.639149 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:32:16.677150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:32:16.677150 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:32:16.678153 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:32:16.683153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5883db66-fe21-4c7f-b15a-a8751c7e607a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C5AC1F90>]}
[0m22:32:16.688154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5883db66-fe21-4c7f-b15a-a8751c7e607a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C62B4450>]}
[0m22:32:16.689153 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:32:16.689153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5883db66-fe21-4c7f-b15a-a8751c7e607a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C3C60DD0>]}
[0m22:32:16.691152 [info ] [MainThread]: 
[0m22:32:16.692155 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:32:16.694154 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m22:32:16.702149 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m22:32:16.703150 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m22:32:16.703150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:16.735684 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:32:16.736680 [debug] [ThreadPool]: On list_projeto: Close
[0m22:32:16.737682 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m22:32:16.742680 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:32:16.742680 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m22:32:16.742680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:16.774036 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:32:16.774036 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:32:16.774036 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:32:16.777038 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m22:32:16.778035 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m22:32:16.778035 [debug] [ThreadPool]: On list_projeto_public: Close
[0m22:32:16.783033 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:16.784034 [debug] [MainThread]: On master: BEGIN
[0m22:32:16.784034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:32:16.813048 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:32:16.813048 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:16.813048 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:32:16.817049 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:32:16.818046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5883db66-fe21-4c7f-b15a-a8751c7e607a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C6518710>]}
[0m22:32:16.818046 [debug] [MainThread]: On master: ROLLBACK
[0m22:32:16.818046 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:16.819045 [debug] [MainThread]: On master: BEGIN
[0m22:32:16.819045 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:32:16.819045 [debug] [MainThread]: On master: COMMIT
[0m22:32:16.820049 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:16.820049 [debug] [MainThread]: On master: COMMIT
[0m22:32:16.820049 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:32:16.820049 [debug] [MainThread]: On master: Close
[0m22:32:16.821050 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:32:16.821050 [info ] [MainThread]: 
[0m22:32:16.825047 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:32:16.825047 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:32:16.825515 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:32:16.825515 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:32:16.826527 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:32:16.827033 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:32:16.827033 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:32:16.827033 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:32:16.829039 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:32:16.830040 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:32:16.830040 => 2023-03-30 22:32:16.830040
[0m22:32:16.830040 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:32:16.843039 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:32:16.827033 => 2023-03-30 22:32:16.843039
[0m22:32:16.844056 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:32:16.882039 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:32:16.942386 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:32:16.951388 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:32:16.951388 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:32:16.951814 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:32:16.951814 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:32:16.951814 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:32:16.982088 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:32:16.982088 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:32:16.982088 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "projeto"."public"."walmart"
[0m22:32:16.986911 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:32:17.117440 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:32:17.196957 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:32:17.260473 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."walmart_source"."walmart"
  );
[0m22:32:17.292474 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: from "projeto"."walmart_source"."walmart"
             ^

[0m22:32:17.371994 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:32:17.435522 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:32:16.851038 => 2023-03-30 22:32:17.435522
[0m22:32:17.499519 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:32:18.467960 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: from "projeto"."walmart_source"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:32:18.546474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5883db66-fe21-4c7f-b15a-a8751c7e607a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C65E8F50>]}
[0m22:32:18.610477 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 1.72s]
[0m22:32:18.674990 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:32:23.809767 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:32:23.810769 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "projeto"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m22:32:23.875283 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:32:23.881283 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:32:23.894285 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:32:23.894285 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:32:23.895283 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:32:23.898638 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:32:23.898638 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:32:16.830040 => 2023-03-30 22:32:23.898638
[0m22:32:23.899636 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:32:23.899636 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5883db66-fe21-4c7f-b15a-a8751c7e607a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C6648210>]}
[0m22:32:23.900636 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.07s]
[0m22:32:23.900636 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:32:23.901624 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:32:23.902623 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:23.902623 [debug] [MainThread]: On master: BEGIN
[0m22:32:23.902623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:32:23.932626 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:32:23.932626 [debug] [MainThread]: On master: COMMIT
[0m22:32:23.933629 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:23.933629 [debug] [MainThread]: On master: COMMIT
[0m22:32:23.933629 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:32:23.933629 [debug] [MainThread]: On master: Close
[0m22:32:23.934629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:32:23.934629 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m22:32:23.934629 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m22:32:23.935627 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:32:23.935627 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:32:23.935627 [info ] [MainThread]: 
[0m22:32:23.936634 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.24 seconds (7.24s).
[0m22:32:23.936634 [debug] [MainThread]: Command end result
[0m22:32:23.941137 [info ] [MainThread]: 
[0m22:32:23.942137 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:32:23.942137 [info ] [MainThread]: 
[0m22:32:23.942137 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:32:23.943137 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m22:32:23.943137 [error] [MainThread]:   LINE 7: from "projeto"."walmart_source"."walmart"
[0m22:32:23.943137 [error] [MainThread]:                ^
[0m22:32:23.944141 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:32:23.944141 [info ] [MainThread]: 
[0m22:32:23.944141 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:32:23.945137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C3617E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C5AB2E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C5AB2350>]}
[0m22:32:23.945137 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:36:14.914298 | 09cc2ae6-cc50-4986-b7e8-c3490470cb49 ==============================
[0m22:36:14.914298 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:36:14.916300 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:36:14.916300 [debug] [MainThread]: Tracking: tracking
[0m22:36:14.925299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB9D12F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB9F94B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EBA574610>]}
[0m22:36:14.933296 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:36:14.969294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:36:14.969294 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:36:14.970312 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:36:14.975294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09cc2ae6-cc50-4986-b7e8-c3490470cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EBA7D5F50>]}
[0m22:36:14.980296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09cc2ae6-cc50-4986-b7e8-c3490470cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EBA594590>]}
[0m22:36:14.980296 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:36:14.981295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09cc2ae6-cc50-4986-b7e8-c3490470cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EBA46AA90>]}
[0m22:36:14.982294 [info ] [MainThread]: 
[0m22:36:14.983295 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:36:14.984295 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m22:36:14.993298 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m22:36:14.993298 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m22:36:14.993298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:15.134040 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:36:15.135039 [debug] [ThreadPool]: On list_projeto: Close
[0m22:36:15.137040 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m22:36:15.141039 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:36:15.142039 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m22:36:15.142039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:15.171039 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:36:15.171039 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:36:15.171039 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:36:15.174038 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m22:36:15.175039 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m22:36:15.176038 [debug] [ThreadPool]: On list_projeto_public: Close
[0m22:36:15.180039 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:15.181039 [debug] [MainThread]: On master: BEGIN
[0m22:36:15.181039 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:36:15.209495 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:36:15.209495 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:15.209495 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:36:15.214009 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:36:15.215009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09cc2ae6-cc50-4986-b7e8-c3490470cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB9F94B90>]}
[0m22:36:15.215009 [debug] [MainThread]: On master: ROLLBACK
[0m22:36:15.215009 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:15.215009 [debug] [MainThread]: On master: BEGIN
[0m22:36:15.216011 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:36:15.216011 [debug] [MainThread]: On master: COMMIT
[0m22:36:15.216011 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:15.217008 [debug] [MainThread]: On master: COMMIT
[0m22:36:15.217008 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:36:15.217008 [debug] [MainThread]: On master: Close
[0m22:36:15.218008 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:36:15.218008 [info ] [MainThread]: 
[0m22:36:15.222008 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:36:15.222008 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:36:15.222008 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:36:15.223012 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:36:15.223012 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:36:15.224011 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:36:15.224011 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:36:15.224011 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:36:15.226012 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:36:15.227012 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:36:15.227012 => 2023-03-30 22:36:15.227012
[0m22:36:15.227012 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:36:15.233007 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:36:15.224011 => 2023-03-30 22:36:15.233007
[0m22:36:15.240012 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:36:15.280010 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:36:15.345443 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:36:15.353450 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:36:15.354445 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:36:15.354445 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:36:15.354445 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:36:15.354445 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:36:15.391443 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:36:15.391443 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:36:15.392444 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "projeto"."public"."walmart"
[0m22:36:15.396507 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:36:15.536312 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:36:15.584315 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:36:15.695834 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."walmart_source"."walmart"
  );
[0m22:36:15.760044 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: from "projeto"."walmart_source"."walmart"
             ^

[0m22:36:15.806054 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:36:15.883569 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:36:15.241010 => 2023-03-30 22:36:15.883569
[0m22:36:15.947080 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:36:16.865025 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: from "projeto"."walmart_source"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:36:16.927557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09cc2ae6-cc50-4986-b7e8-c3490470cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EBA8FD110>]}
[0m22:36:16.991557 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 1.70s]
[0m22:36:17.072172 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:36:22.287320 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:36:22.287320 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "projeto"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m22:36:22.356840 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:36:22.362839 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:36:22.376839 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:36:22.376839 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:36:22.376839 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:36:22.380383 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:36:22.381384 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:36:15.227012 => 2023-03-30 22:36:22.381384
[0m22:36:22.381384 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:36:22.382381 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09cc2ae6-cc50-4986-b7e8-c3490470cb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EBA927A50>]}
[0m22:36:22.382381 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.16s]
[0m22:36:22.383382 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:36:22.384382 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:36:22.384382 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:22.385383 [debug] [MainThread]: On master: BEGIN
[0m22:36:22.385383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:36:22.413387 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:36:22.414385 [debug] [MainThread]: On master: COMMIT
[0m22:36:22.414385 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:22.414385 [debug] [MainThread]: On master: COMMIT
[0m22:36:22.415385 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:36:22.415385 [debug] [MainThread]: On master: Close
[0m22:36:22.416385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:36:22.416385 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m22:36:22.416385 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m22:36:22.416385 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:36:22.416385 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:36:22.417386 [info ] [MainThread]: 
[0m22:36:22.417386 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.43 seconds (7.43s).
[0m22:36:22.417386 [debug] [MainThread]: Command end result
[0m22:36:22.422896 [info ] [MainThread]: 
[0m22:36:22.422896 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:36:22.422896 [info ] [MainThread]: 
[0m22:36:22.423897 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:36:22.423897 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m22:36:22.423897 [error] [MainThread]:   LINE 7: from "projeto"."walmart_source"."walmart"
[0m22:36:22.424897 [error] [MainThread]:                ^
[0m22:36:22.424897 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:36:22.424897 [info ] [MainThread]: 
[0m22:36:22.425901 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:36:22.425901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB9DBD610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB7960F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EBA09D010>]}
[0m22:36:22.425901 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:36:46.023927 | a5e3a32b-4325-497f-b167-323ae8f8cbe9 ==============================
[0m22:36:46.023927 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:36:46.025928 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:36:46.025928 [debug] [MainThread]: Tracking: tracking
[0m22:36:46.035927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4D8A682D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4D81F0090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4D89B15D0>]}
[0m22:36:46.043436 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:36:46.079438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:36:46.080438 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\source.yml
[0m22:36:46.091436 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m22:36:46.110436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4D8D5DC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4D8D5C190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4D8D5EC90>]}
[0m22:36:46.111436 [debug] [MainThread]: Flushing usage events
[0m22:36:46.793214 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.projeto_final.stg_walmart' (models\staging\stg_walmart.sql) depends on a source named 'walmart_source.walmart' which was not found


============================== 2023-03-30 22:36:56.461039 | a81e227b-893e-4ad3-aded-cb0c9202ed97 ==============================
[0m22:36:56.461039 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:36:56.462910 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:36:56.462910 [debug] [MainThread]: Tracking: tracking
[0m22:36:56.472925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A935FED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A93DBFD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A938E3210>]}
[0m22:36:56.479924 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:36:56.516925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:36:56.517924 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\source.yml
[0m22:36:56.517924 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\staging\stg_walmart.sql
[0m22:36:56.528928 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m22:36:56.552441 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:36:56.556441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a81e227b-893e-4ad3-aded-cb0c9202ed97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A93E85210>]}
[0m22:36:56.562441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a81e227b-893e-4ad3-aded-cb0c9202ed97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9418F410>]}
[0m22:36:56.562441 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:36:56.562441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a81e227b-893e-4ad3-aded-cb0c9202ed97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A93D4D6D0>]}
[0m22:36:56.563443 [info ] [MainThread]: 
[0m22:36:56.565444 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:36:56.566443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m22:36:56.575441 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m22:36:56.575441 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m22:36:56.575441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:56.614444 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:36:56.615441 [debug] [ThreadPool]: On list_projeto: Close
[0m22:36:56.617444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m22:36:56.622441 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:36:56.622441 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m22:36:56.623442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:36:56.651955 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:36:56.652956 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:36:56.652956 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:36:56.654955 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m22:36:56.655956 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m22:36:56.656955 [debug] [ThreadPool]: On list_projeto_public: Close
[0m22:36:56.660956 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:56.661956 [debug] [MainThread]: On master: BEGIN
[0m22:36:56.661956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:36:56.689956 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:36:56.690956 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:56.690956 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:36:56.693956 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:36:56.695956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a81e227b-893e-4ad3-aded-cb0c9202ed97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9369B2D0>]}
[0m22:36:56.695956 [debug] [MainThread]: On master: ROLLBACK
[0m22:36:56.695956 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:56.695956 [debug] [MainThread]: On master: BEGIN
[0m22:36:56.696956 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:36:56.696956 [debug] [MainThread]: On master: COMMIT
[0m22:36:56.696956 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:56.697957 [debug] [MainThread]: On master: COMMIT
[0m22:36:56.697957 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:36:56.697957 [debug] [MainThread]: On master: Close
[0m22:36:56.698956 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:36:56.698956 [info ] [MainThread]: 
[0m22:36:56.702956 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:36:56.702956 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:36:56.702956 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:36:56.702956 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:36:56.703957 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:36:56.703957 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:36:56.704956 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:36:56.704956 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:36:56.706955 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:36:56.706955 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:36:56.706955 => 2023-03-30 22:36:56.706955
[0m22:36:56.707956 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:36:56.720956 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:36:56.704956 => 2023-03-30 22:36:56.720956
[0m22:36:56.721958 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:36:56.757473 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:36:56.826477 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:36:56.827477 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:36:56.827477 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:36:56.827477 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:36:56.827477 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:36:56.828478 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:36:56.870989 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:36:56.870989 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:36:56.870989 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:36:56.871993 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."projeto"."walmart"
  );
[0m22:36:56.871993 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:36:56.871993 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "projeto"."public"."walmart"
[0m22:36:56.871993 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "projeto.walmart" does not exist
LINE 7: from "projeto"."projeto"."walmart"
             ^

[0m22:36:56.872991 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:36:56.872991 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:36:56.728965 => 2023-03-30 22:36:56.872991
[0m22:36:56.873990 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:36:56.877988 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  relation "projeto.walmart" does not exist
  LINE 7: from "projeto"."projeto"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:36:56.877988 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:36:56.877988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a81e227b-893e-4ad3-aded-cb0c9202ed97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A94A9BAD0>]}
[0m22:36:56.978506 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 0.17s]
[0m22:36:57.101020 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:37:03.700321 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:37:03.701322 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "projeto"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m22:37:03.777350 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:37:03.783349 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:37:03.796349 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:37:03.796349 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:37:03.796349 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:37:03.800355 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:37:03.800355 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:36:56.707956 => 2023-03-30 22:37:03.800355
[0m22:37:03.801351 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:37:03.801351 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a81e227b-893e-4ad3-aded-cb0c9202ed97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A948A3D10>]}
[0m22:37:03.802361 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.10s]
[0m22:37:03.802361 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:37:03.804353 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:37:03.804353 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:03.804353 [debug] [MainThread]: On master: BEGIN
[0m22:37:03.804353 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:37:03.834352 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:37:03.834352 [debug] [MainThread]: On master: COMMIT
[0m22:37:03.835358 [debug] [MainThread]: Using postgres connection "master"
[0m22:37:03.835358 [debug] [MainThread]: On master: COMMIT
[0m22:37:03.835358 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:37:03.835358 [debug] [MainThread]: On master: Close
[0m22:37:03.836362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:03.836362 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m22:37:03.836362 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m22:37:03.837362 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:37:03.837362 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:37:03.837362 [info ] [MainThread]: 
[0m22:37:03.837362 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.27 seconds (7.27s).
[0m22:37:03.838358 [debug] [MainThread]: Command end result
[0m22:37:03.843356 [info ] [MainThread]: 
[0m22:37:03.843356 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:37:03.843356 [info ] [MainThread]: 
[0m22:37:03.844357 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:37:03.844357 [error] [MainThread]:   relation "projeto.walmart" does not exist
[0m22:37:03.844357 [error] [MainThread]:   LINE 7: from "projeto"."projeto"."walmart"
[0m22:37:03.845357 [error] [MainThread]:                ^
[0m22:37:03.845357 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:37:03.845357 [info ] [MainThread]: 
[0m22:37:03.846358 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:37:03.846358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A93CD5CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A929DC110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A939917D0>]}
[0m22:37:03.846358 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:38:51.844549 | 1f99fb1a-552a-4cca-a85a-c8f15ee64767 ==============================
[0m22:38:51.844549 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:38:51.846555 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:38:51.846555 [debug] [MainThread]: Tracking: tracking
[0m22:38:51.856080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001251A45D4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012519F60710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001251A51F610>]}
[0m22:38:51.864577 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:38:51.901119 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m22:38:51.901119 [debug] [MainThread]: Partial parsing: added file: projeto_final://models\stg_walmart.sql
[0m22:38:51.902121 [debug] [MainThread]: Partial parsing: deleted file: projeto_final://models\staging\stg_walmart.sql
[0m22:38:51.912630 [debug] [MainThread]: 1699: static parser successfully parsed stg_walmart.sql
[0m22:38:51.925648 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:38:51.929648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f99fb1a-552a-4cca-a85a-c8f15ee64767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012519FF6C50>]}
[0m22:38:51.933648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f99fb1a-552a-4cca-a85a-c8f15ee64767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001251A591B50>]}
[0m22:38:51.933648 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:38:51.934654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f99fb1a-552a-4cca-a85a-c8f15ee64767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001251A42B710>]}
[0m22:38:51.935162 [info ] [MainThread]: 
[0m22:38:51.937174 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:38:51.938174 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m22:38:51.947681 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m22:38:51.947681 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m22:38:51.948680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:51.981916 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:38:51.982916 [debug] [ThreadPool]: On list_projeto: Close
[0m22:38:51.984425 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m22:38:51.988431 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:38:51.989431 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m22:38:51.989431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:52.020712 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:38:52.020712 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:38:52.020712 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:38:52.023710 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m22:38:52.024716 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m22:38:52.024716 [debug] [ThreadPool]: On list_projeto_public: Close
[0m22:38:52.029759 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:52.030760 [debug] [MainThread]: On master: BEGIN
[0m22:38:52.030760 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:38:52.059585 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:38:52.060583 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:52.060583 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:38:52.063583 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:38:52.065092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f99fb1a-552a-4cca-a85a-c8f15ee64767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001251A793C90>]}
[0m22:38:52.065092 [debug] [MainThread]: On master: ROLLBACK
[0m22:38:52.066098 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:52.066098 [debug] [MainThread]: On master: BEGIN
[0m22:38:52.066098 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:38:52.067099 [debug] [MainThread]: On master: COMMIT
[0m22:38:52.067099 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:52.067099 [debug] [MainThread]: On master: COMMIT
[0m22:38:52.067099 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:38:52.068101 [debug] [MainThread]: On master: Close
[0m22:38:52.068101 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:38:52.069099 [info ] [MainThread]: 
[0m22:38:52.072098 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:38:52.072098 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:38:52.073099 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:38:52.073099 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:38:52.073099 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:38:52.074607 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:38:52.074607 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:38:52.074607 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:38:52.076618 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:38:52.077616 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:38:52.077616 => 2023-03-30 22:38:52.077616
[0m22:38:52.077616 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:38:52.091133 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:38:52.074607 => 2023-03-30 22:38:52.091133
[0m22:38:52.092131 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:38:52.129187 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:38:52.197234 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:38:52.198234 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:38:52.198234 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:38:52.198234 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:38:52.199237 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:38:52.199237 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:38:52.231783 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:38:52.231783 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:38:52.231783 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:38:52.231783 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:38:52.232788 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."projeto"."walmart"
  );
[0m22:38:52.232788 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "projeto"."public"."walmart"
[0m22:38:52.232788 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "projeto.walmart" does not exist
LINE 7: from "projeto"."projeto"."walmart"
             ^

[0m22:38:52.233788 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:38:52.233788 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:38:52.098640 => 2023-03-30 22:38:52.233788
[0m22:38:52.233788 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:38:52.236308 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:38:52.485757 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\stg_walmart.sql)
  relation "projeto.walmart" does not exist
  LINE 7: from "projeto"."projeto"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\stg_walmart.sql
[0m22:38:52.547353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f99fb1a-552a-4cca-a85a-c8f15ee64767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001251A535F50>]}
[0m22:38:52.593387 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 0.47s]
[0m22:38:52.659001 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:38:59.307420 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:38:59.307420 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "projeto"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m22:38:59.370996 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:38:59.377507 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:38:59.391015 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:38:59.392015 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:38:59.392015 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:38:59.393866 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:38:59.393866 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:38:52.077616 => 2023-03-30 22:38:59.393866
[0m22:38:59.394867 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:38:59.394867 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f99fb1a-552a-4cca-a85a-c8f15ee64767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001251A91AE10>]}
[0m22:38:59.394867 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.32s]
[0m22:38:59.396304 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:38:59.397310 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:38:59.398310 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:59.398310 [debug] [MainThread]: On master: BEGIN
[0m22:38:59.398310 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:38:59.426852 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:38:59.427850 [debug] [MainThread]: On master: COMMIT
[0m22:38:59.427850 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:59.427850 [debug] [MainThread]: On master: COMMIT
[0m22:38:59.427850 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:38:59.428849 [debug] [MainThread]: On master: Close
[0m22:38:59.428849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:38:59.428849 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m22:38:59.429851 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m22:38:59.429851 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:38:59.429851 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:38:59.429851 [info ] [MainThread]: 
[0m22:38:59.430849 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.49 seconds (7.49s).
[0m22:38:59.430849 [debug] [MainThread]: Command end result
[0m22:38:59.435356 [info ] [MainThread]: 
[0m22:38:59.436363 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:38:59.436363 [info ] [MainThread]: 
[0m22:38:59.437363 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\stg_walmart.sql)[0m
[0m22:38:59.437363 [error] [MainThread]:   relation "projeto.walmart" does not exist
[0m22:38:59.437363 [error] [MainThread]:   LINE 7: from "projeto"."projeto"."walmart"
[0m22:38:59.438361 [error] [MainThread]:                ^
[0m22:38:59.438361 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\stg_walmart.sql
[0m22:38:59.438361 [info ] [MainThread]: 
[0m22:38:59.439362 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:38:59.439362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001251A8B7ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012519F4C9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012519F4C6D0>]}
[0m22:38:59.439362 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:39:58.459702 | 880dbe03-c8ca-4a67-a900-291877d37aa1 ==============================
[0m22:39:58.459702 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:39:58.462005 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:39:58.462521 [debug] [MainThread]: Tracking: tracking
[0m22:39:58.471032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026A039E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020269B49F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026A0EBDD0>]}
[0m22:39:58.479031 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:39:58.514553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:39:58.514553 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\source.yml
[0m22:39:58.514553 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\stg_walmart.sql
[0m22:39:58.525553 [debug] [MainThread]: 1699: static parser successfully parsed stg_walmart.sql
[0m22:39:58.545553 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:39:58.550722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '880dbe03-c8ca-4a67-a900-291877d37aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026A0FE550>]}
[0m22:39:58.554711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '880dbe03-c8ca-4a67-a900-291877d37aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026A428D10>]}
[0m22:39:58.554711 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:39:58.554711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '880dbe03-c8ca-4a67-a900-291877d37aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020269BC65D0>]}
[0m22:39:58.555711 [info ] [MainThread]: 
[0m22:39:58.557711 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:39:58.558715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m22:39:58.566714 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m22:39:58.567717 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m22:39:58.567717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:58.599722 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:39:58.600719 [debug] [ThreadPool]: On list_projeto: Close
[0m22:39:58.601721 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m22:39:58.607230 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:39:58.607230 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m22:39:58.607230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:58.637232 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:39:58.637232 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:39:58.637232 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:39:58.640232 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m22:39:58.641230 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m22:39:58.641230 [debug] [ThreadPool]: On list_projeto_public: Close
[0m22:39:58.646232 [debug] [MainThread]: Using postgres connection "master"
[0m22:39:58.646232 [debug] [MainThread]: On master: BEGIN
[0m22:39:58.647228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:39:58.676230 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:39:58.677232 [debug] [MainThread]: Using postgres connection "master"
[0m22:39:58.677232 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:39:58.680229 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:39:58.681229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '880dbe03-c8ca-4a67-a900-291877d37aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026A426AD0>]}
[0m22:39:58.682229 [debug] [MainThread]: On master: ROLLBACK
[0m22:39:58.682229 [debug] [MainThread]: Using postgres connection "master"
[0m22:39:58.682229 [debug] [MainThread]: On master: BEGIN
[0m22:39:58.683230 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:39:58.683230 [debug] [MainThread]: On master: COMMIT
[0m22:39:58.683230 [debug] [MainThread]: Using postgres connection "master"
[0m22:39:58.684229 [debug] [MainThread]: On master: COMMIT
[0m22:39:58.684229 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:39:58.684229 [debug] [MainThread]: On master: Close
[0m22:39:58.685230 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:39:58.685230 [info ] [MainThread]: 
[0m22:39:58.689236 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:39:58.689236 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:39:58.690236 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:39:58.690236 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:39:58.691237 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:39:58.691237 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:39:58.691237 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:39:58.692236 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:39:58.694235 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:39:58.694235 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:39:58.694235 => 2023-03-30 22:39:58.694235
[0m22:39:58.694235 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:39:58.706747 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:39:58.692236 => 2023-03-30 22:39:58.706747
[0m22:39:58.708746 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:39:58.736747 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:39:58.804252 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:39:58.812259 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:39:58.812259 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:39:58.812259 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:39:58.813259 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:39:58.813259 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:39:58.844255 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:39:58.845257 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:39:58.845257 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:39:58.845257 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."walmart_source"."raw"
  );
[0m22:39:58.846257 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:39:58.846257 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "projeto"."public"."walmart"
[0m22:39:58.846257 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.raw" does not exist
LINE 7: from "projeto"."walmart_source"."raw"
             ^

[0m22:39:58.846257 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:39:58.847259 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:39:58.708746 => 2023-03-30 22:39:58.847259
[0m22:39:58.847259 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:39:58.850258 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:39:58.880258 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\stg_walmart.sql)
  relation "walmart_source.raw" does not exist
  LINE 7: from "projeto"."walmart_source"."raw"
               ^
  compiled Code at target\run\projeto_final\models\stg_walmart.sql
[0m22:39:58.926772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '880dbe03-c8ca-4a67-a900-291877d37aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020269BC6510>]}
[0m22:39:58.990777 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 0.24s]
[0m22:39:59.103828 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:40:05.872609 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:40:05.872609 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "projeto"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m22:40:05.939126 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:40:05.945127 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:40:05.959126 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:40:05.959126 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:40:05.959126 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:40:05.963134 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:40:05.964130 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:39:58.695237 => 2023-03-30 22:40:05.964130
[0m22:40:05.964130 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:40:05.965126 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '880dbe03-c8ca-4a67-a900-291877d37aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026A4EA290>]}
[0m22:40:05.965126 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.27s]
[0m22:40:05.966125 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:40:05.967128 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:40:05.967128 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:05.967128 [debug] [MainThread]: On master: BEGIN
[0m22:40:05.968127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:40:05.999131 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:40:05.999131 [debug] [MainThread]: On master: COMMIT
[0m22:40:06.000132 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:06.000132 [debug] [MainThread]: On master: COMMIT
[0m22:40:06.000132 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:40:06.000132 [debug] [MainThread]: On master: Close
[0m22:40:06.001131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:06.001131 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m22:40:06.001131 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m22:40:06.002131 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:40:06.002131 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:40:06.002131 [info ] [MainThread]: 
[0m22:40:06.002131 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m22:40:06.003133 [debug] [MainThread]: Command end result
[0m22:40:06.007642 [info ] [MainThread]: 
[0m22:40:06.008641 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:40:06.008641 [info ] [MainThread]: 
[0m22:40:06.009642 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\stg_walmart.sql)[0m
[0m22:40:06.009642 [error] [MainThread]:   relation "walmart_source.raw" does not exist
[0m22:40:06.009642 [error] [MainThread]:   LINE 7: from "projeto"."walmart_source"."raw"
[0m22:40:06.010642 [error] [MainThread]:                ^
[0m22:40:06.010642 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\stg_walmart.sql
[0m22:40:06.010642 [info ] [MainThread]: 
[0m22:40:06.010642 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:40:06.011643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020269843050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020269D5E050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020268C6E3D0>]}
[0m22:40:06.011643 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:40:43.872066 | 7cbfbe45-6c27-49df-b319-fbf4a3f17902 ==============================
[0m22:40:43.872066 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:40:43.874420 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:40:43.874420 [debug] [MainThread]: Tracking: tracking
[0m22:40:43.884038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF13764610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF13B12250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF13F19810>]}
[0m22:40:43.892040 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:40:43.897045 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:40:43.898725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7cbfbe45-6c27-49df-b319-fbf4a3f17902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF14289290>]}
[0m22:40:44.338307 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m22:40:44.385306 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.example
[0m22:40:44.389306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cbfbe45-6c27-49df-b319-fbf4a3f17902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF142C5450>]}
[0m22:40:44.394309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cbfbe45-6c27-49df-b319-fbf4a3f17902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF142D93D0>]}
[0m22:40:44.394309 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:40:44.395315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cbfbe45-6c27-49df-b319-fbf4a3f17902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF13EC0A90>]}
[0m22:40:44.396314 [info ] [MainThread]: 
[0m22:40:44.397317 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:40:44.398315 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m22:40:44.407314 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m22:40:44.407314 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m22:40:44.407314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:44.440734 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:40:44.441731 [debug] [ThreadPool]: On list_projeto: Close
[0m22:40:44.443733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m22:40:44.447730 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:40:44.448730 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m22:40:44.448730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:44.588096 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:40:44.588096 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:40:44.589099 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:40:44.591095 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m22:40:44.592103 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m22:40:44.592103 [debug] [ThreadPool]: On list_projeto_public: Close
[0m22:40:44.597099 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:44.597099 [debug] [MainThread]: On master: BEGIN
[0m22:40:44.598104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:40:44.628132 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:40:44.628132 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:44.628132 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:40:44.632133 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:40:44.633138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cbfbe45-6c27-49df-b319-fbf4a3f17902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF1429DCD0>]}
[0m22:40:44.633138 [debug] [MainThread]: On master: ROLLBACK
[0m22:40:44.634135 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:44.634135 [debug] [MainThread]: On master: BEGIN
[0m22:40:44.634135 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:40:44.635133 [debug] [MainThread]: On master: COMMIT
[0m22:40:44.635133 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:44.635133 [debug] [MainThread]: On master: COMMIT
[0m22:40:44.635133 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:40:44.635133 [debug] [MainThread]: On master: Close
[0m22:40:44.636133 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:40:44.636133 [info ] [MainThread]: 
[0m22:40:44.640133 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:40:44.640133 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:40:44.641134 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:40:44.641134 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:40:44.642134 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:40:44.642134 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:40:44.642134 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:40:44.643133 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:40:44.645133 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:40:44.645133 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:40:44.645133 => 2023-03-30 22:40:44.645133
[0m22:40:44.645133 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:40:44.646134 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:40:44.643133 => 2023-03-30 22:40:44.646134
[0m22:40:44.659133 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:40:44.697137 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:40:44.766677 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:40:44.766677 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:40:44.766677 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:40:44.767677 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:40:44.767677 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:40:44.767677 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:40:44.800679 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:40:44.800679 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:40:44.800679 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."walmart_source"."raw"
  );
[0m22:40:44.801683 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.raw" does not exist
LINE 7: from "projeto"."walmart_source"."raw"
             ^

[0m22:40:44.801683 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:40:44.801683 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:40:44.802684 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:40:44.666133 => 2023-03-30 22:40:44.802684
[0m22:40:44.802684 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:40:44.802684 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:40:44.802684 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "projeto"."public"."walmart"
[0m22:40:44.806683 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  relation "walmart_source.raw" does not exist
  LINE 7: from "projeto"."walmart_source"."raw"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:40:44.806683 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:40:44.807682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cbfbe45-6c27-49df-b319-fbf4a3f17902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF143C0B90>]}
[0m22:40:44.927708 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 0.17s]
[0m22:40:45.023224 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:40:51.691067 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:40:51.691067 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "projeto"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m22:40:51.759580 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:40:51.765584 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:40:51.778581 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:40:51.778581 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:40:51.779581 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:40:51.782581 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:40:51.783580 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:40:44.646134 => 2023-03-30 22:40:51.783580
[0m22:40:51.784584 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:40:51.784584 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cbfbe45-6c27-49df-b319-fbf4a3f17902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF1402CF10>]}
[0m22:40:51.785581 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.14s]
[0m22:40:51.785581 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:40:51.786580 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:40:51.787581 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:51.787581 [debug] [MainThread]: On master: BEGIN
[0m22:40:51.787581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:40:51.819105 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:40:51.819105 [debug] [MainThread]: On master: COMMIT
[0m22:40:51.819105 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:51.819105 [debug] [MainThread]: On master: COMMIT
[0m22:40:51.820105 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:40:51.820105 [debug] [MainThread]: On master: Close
[0m22:40:51.821105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:51.821105 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m22:40:51.821105 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m22:40:51.821105 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:40:51.821105 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:40:51.822106 [info ] [MainThread]: 
[0m22:40:51.822106 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.43 seconds (7.43s).
[0m22:40:51.823106 [debug] [MainThread]: Command end result
[0m22:40:51.827105 [info ] [MainThread]: 
[0m22:40:51.828106 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:40:51.828106 [info ] [MainThread]: 
[0m22:40:51.828106 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:40:51.829105 [error] [MainThread]:   relation "walmart_source.raw" does not exist
[0m22:40:51.829105 [error] [MainThread]:   LINE 7: from "projeto"."walmart_source"."raw"
[0m22:40:51.829105 [error] [MainThread]:                ^
[0m22:40:51.830105 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:40:51.830105 [info ] [MainThread]: 
[0m22:40:51.830105 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:40:51.831106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF13F2B210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF13AAB550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF13A0C990>]}
[0m22:40:51.831106 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:41:44.850873 | 58b38bfc-4dcc-4404-b7b0-e92e7ed2e473 ==============================
[0m22:41:44.850873 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:41:44.851870 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m22:41:44.851870 [debug] [MainThread]: Tracking: tracking
[0m22:41:44.861380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7C062250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7C024690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7C061590>]}
[0m22:41:44.913381 [debug] [MainThread]: Executing "git --help"
[0m22:41:44.918379 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:41:44.919379 [debug] [MainThread]: Using postgres connection "debug"
[0m22:41:44.919379 [debug] [MainThread]: On debug: select 1 as id
[0m22:41:44.919379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:41:44.952383 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m22:41:44.953383 [debug] [MainThread]: On debug: Close
[0m22:41:44.954384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7C706410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7C897E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7C2CFD10>]}
[0m22:41:44.954384 [debug] [MainThread]: Flushing usage events
[0m22:41:45.611405 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-03-30 22:42:43.557288 | ec86b001-98cf-4da6-91e6-1ebe32ec3404 ==============================
[0m22:42:43.557288 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:42:43.559799 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m22:42:43.560097 [debug] [MainThread]: Tracking: tracking
[0m22:42:43.568623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A059B74610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A059B761D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A059C03D10>]}
[0m22:42:43.572019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A059B2F810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A05A094B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A05A05FC10>]}
[0m22:42:43.573019 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:42:49.011214 | 06a43038-f677-4c9a-b3b2-5bc36369d9ca ==============================
[0m22:42:49.011214 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:42:49.013218 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:42:49.013218 [debug] [MainThread]: Tracking: tracking
[0m22:42:49.021729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0C602AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0ECC1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0C6F5950>]}
[0m22:42:49.029232 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:42:49.030238 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:42:49.030238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '06a43038-f677-4c9a-b3b2-5bc36369d9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0F172990>]}
[0m22:42:49.467681 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_walmart.sql
[0m22:42:49.520760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06a43038-f677-4c9a-b3b2-5bc36369d9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0ED26710>]}
[0m22:42:49.525772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06a43038-f677-4c9a-b3b2-5bc36369d9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0F57A890>]}
[0m22:42:49.525772 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:42:49.526764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06a43038-f677-4c9a-b3b2-5bc36369d9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0EC9AB50>]}
[0m22:42:49.527766 [info ] [MainThread]: 
[0m22:42:49.529277 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:42:49.530283 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m22:42:49.538788 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m22:42:49.538788 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m22:42:49.538788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:49.572620 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:42:49.573620 [debug] [ThreadPool]: On list_projeto: Close
[0m22:42:49.574621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m22:42:49.579125 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:42:49.580130 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m22:42:49.580130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:49.608656 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:42:49.609661 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:42:49.609661 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:42:49.611661 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m22:42:49.613661 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m22:42:49.613661 [debug] [ThreadPool]: On list_projeto_public: Close
[0m22:42:49.617661 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:49.618660 [debug] [MainThread]: On master: BEGIN
[0m22:42:49.618660 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:42:49.647562 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:42:49.647562 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:49.647562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:42:49.651775 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:42:49.652775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06a43038-f677-4c9a-b3b2-5bc36369d9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0F259C90>]}
[0m22:42:49.652775 [debug] [MainThread]: On master: ROLLBACK
[0m22:42:49.653776 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:49.653776 [debug] [MainThread]: On master: BEGIN
[0m22:42:49.653776 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:42:49.654782 [debug] [MainThread]: On master: COMMIT
[0m22:42:49.654782 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:49.654782 [debug] [MainThread]: On master: COMMIT
[0m22:42:49.654782 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:42:49.655779 [debug] [MainThread]: On master: Close
[0m22:42:49.655779 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:42:49.656779 [info ] [MainThread]: 
[0m22:42:49.660252 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:42:49.660252 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:42:49.660252 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:42:49.661252 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:42:49.661252 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:42:49.662252 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:42:49.662252 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:42:49.662252 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:42:49.665251 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:42:49.665251 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:42:49.665251 => 2023-03-30 22:42:49.665251
[0m22:42:49.666252 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:42:49.687278 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:42:49.662252 => 2023-03-30 22:42:49.687278
[0m22:42:49.739344 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:42:49.759874 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:42:49.784891 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:42:49.785891 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:42:49.785891 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:42:49.786892 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:42:49.786892 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:42:49.786892 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:42:49.819616 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:42:49.819616 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:42:49.819616 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:42:49.820607 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:42:49.820607 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "projeto"."public"."walmart"
[0m22:42:49.820607 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."walmart_source"."raw"
  );
[0m22:42:49.821607 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.raw" does not exist
LINE 7: from "projeto"."walmart_source"."raw"
             ^

[0m22:42:49.821607 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:42:49.822608 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:42:49.760873 => 2023-03-30 22:42:49.821607
[0m22:42:49.822608 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:42:49.823608 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:42:50.747279 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\staging\stg_walmart.sql)
  relation "walmart_source.raw" does not exist
  LINE 7: from "projeto"."walmart_source"."raw"
               ^
  compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:42:50.808337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06a43038-f677-4c9a-b3b2-5bc36369d9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0F65D510>]}
[0m22:42:50.885314 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 1.15s]
[0m22:42:50.964877 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:42:56.765219 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:42:56.765219 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "projeto"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m22:42:56.836219 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:42:56.843226 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:42:56.858735 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:42:56.858735 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:42:56.859734 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:42:56.860734 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:42:56.861733 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:42:49.666252 => 2023-03-30 22:42:56.861733
[0m22:42:56.861733 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:42:56.862734 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06a43038-f677-4c9a-b3b2-5bc36369d9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0E9E3550>]}
[0m22:42:56.862734 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.20s]
[0m22:42:56.863734 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:42:56.864735 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:42:56.864735 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:56.864735 [debug] [MainThread]: On master: BEGIN
[0m22:42:56.865733 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:42:56.896736 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:42:56.896736 [debug] [MainThread]: On master: COMMIT
[0m22:42:56.896736 [debug] [MainThread]: Using postgres connection "master"
[0m22:42:56.897733 [debug] [MainThread]: On master: COMMIT
[0m22:42:56.897733 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:42:56.897733 [debug] [MainThread]: On master: Close
[0m22:42:56.898733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:42:56.898733 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m22:42:56.898733 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m22:42:56.898733 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:42:56.898733 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:42:56.899734 [info ] [MainThread]: 
[0m22:42:56.899734 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.37 seconds (7.37s).
[0m22:42:56.900735 [debug] [MainThread]: Command end result
[0m22:42:56.905738 [info ] [MainThread]: 
[0m22:42:56.905738 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:42:56.906749 [info ] [MainThread]: 
[0m22:42:56.906749 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\staging\stg_walmart.sql)[0m
[0m22:42:56.906749 [error] [MainThread]:   relation "walmart_source.raw" does not exist
[0m22:42:56.907734 [error] [MainThread]:   LINE 7: from "projeto"."walmart_source"."raw"
[0m22:42:56.907734 [error] [MainThread]:                ^
[0m22:42:56.907734 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\staging\stg_walmart.sql
[0m22:42:56.908735 [info ] [MainThread]: 
[0m22:42:56.908735 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:42:56.908735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0E9D9CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0F2B37D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0FC75C10>]}
[0m22:42:56.909734 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:44:35.478444 | d69a3840-4db2-4783-a499-25e0c9fcea69 ==============================
[0m22:44:35.478444 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:44:35.480444 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:44:35.480668 [debug] [MainThread]: Tracking: tracking
[0m22:44:35.488683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D6D42DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D700BA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D70868D0>]}
[0m22:44:35.496681 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:44:35.531201 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m22:44:35.532203 [debug] [MainThread]: Partial parsing: added file: projeto_final://models\stg_walmart.sql
[0m22:44:35.532203 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\source.yml
[0m22:44:35.532203 [debug] [MainThread]: Partial parsing: deleted file: projeto_final://models\staging\stg_walmart.sql
[0m22:44:35.543201 [debug] [MainThread]: 1699: static parser successfully parsed stg_walmart.sql
[0m22:44:35.564202 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m22:44:35.568204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd69a3840-4db2-4783-a499-25e0c9fcea69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D6C8C210>]}
[0m22:44:35.573202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd69a3840-4db2-4783-a499-25e0c9fcea69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D78E8290>]}
[0m22:44:35.573202 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:44:35.573202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd69a3840-4db2-4783-a499-25e0c9fcea69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D7086C10>]}
[0m22:44:35.574201 [info ] [MainThread]: 
[0m22:44:35.576201 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:44:35.577202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m22:44:35.586202 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m22:44:35.586202 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m22:44:35.586202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:44:35.618717 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:44:35.619719 [debug] [ThreadPool]: On list_projeto: Close
[0m22:44:35.620718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m22:44:35.625717 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:44:35.626716 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m22:44:35.626716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:44:35.655168 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:44:35.655168 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:44:35.656185 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:44:35.658197 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m22:44:35.659197 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m22:44:35.660197 [debug] [ThreadPool]: On list_projeto_public: Close
[0m22:44:35.664183 [debug] [MainThread]: Using postgres connection "master"
[0m22:44:35.665183 [debug] [MainThread]: On master: BEGIN
[0m22:44:35.665183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:44:35.694185 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:44:35.695184 [debug] [MainThread]: Using postgres connection "master"
[0m22:44:35.695184 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:44:35.698183 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:44:35.699186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd69a3840-4db2-4783-a499-25e0c9fcea69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D7416310>]}
[0m22:44:35.700190 [debug] [MainThread]: On master: ROLLBACK
[0m22:44:35.700190 [debug] [MainThread]: Using postgres connection "master"
[0m22:44:35.700190 [debug] [MainThread]: On master: BEGIN
[0m22:44:35.701193 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:44:35.701193 [debug] [MainThread]: On master: COMMIT
[0m22:44:35.701193 [debug] [MainThread]: Using postgres connection "master"
[0m22:44:35.701193 [debug] [MainThread]: On master: COMMIT
[0m22:44:35.702191 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:44:35.702191 [debug] [MainThread]: On master: Close
[0m22:44:35.702191 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:44:35.703194 [info ] [MainThread]: 
[0m22:44:35.706190 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:44:35.707190 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:44:35.707190 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:44:35.707190 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:44:35.708191 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:44:35.708191 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:44:35.709190 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:44:35.709190 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:44:35.711190 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:44:35.712191 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:44:35.712191 => 2023-03-30 22:44:35.712191
[0m22:44:35.712191 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:44:35.724699 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:44:35.709190 => 2023-03-30 22:44:35.724699
[0m22:44:35.725699 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:44:35.761699 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:44:35.831217 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:44:35.832216 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:44:35.832216 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:44:35.832216 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:44:35.833218 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:44:35.833218 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:44:35.865217 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:44:35.866217 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:44:35.866217 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "projeto"."public"."walmart"
[0m22:44:35.866217 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:44:35.866217 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:44:35.867217 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."walmart_source"."walmart"
  );
[0m22:44:35.867217 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: from "projeto"."walmart_source"."walmart"
             ^

[0m22:44:35.867217 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: ROLLBACK
[0m22:44:35.868217 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:44:35.732699 => 2023-03-30 22:44:35.868217
[0m22:44:35.868217 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:44:35.870220 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:44:36.787424 [debug] [Thread-1 (]: Database Error in model stg_walmart (models\stg_walmart.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: from "projeto"."walmart_source"."walmart"
               ^
  compiled Code at target\run\projeto_final\models\stg_walmart.sql
[0m22:44:36.866941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd69a3840-4db2-4783-a499-25e0c9fcea69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D7947210>]}
[0m22:44:36.947004 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.stg_walmart ........................ [[31mERROR[0m in 1.16s]
[0m22:44:37.041521 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:44:42.736666 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:44:42.737666 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "projeto"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m22:44:42.801666 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:44:42.807671 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:44:42.821181 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:44:42.821181 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:44:42.821181 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:44:42.824183 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:44:42.824183 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:44:35.712191 => 2023-03-30 22:44:42.824183
[0m22:44:42.825184 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:44:42.825184 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd69a3840-4db2-4783-a499-25e0c9fcea69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D7086D10>]}
[0m22:44:42.826185 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.12s]
[0m22:44:42.826185 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:44:42.827201 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:44:42.828184 [debug] [MainThread]: Using postgres connection "master"
[0m22:44:42.828184 [debug] [MainThread]: On master: BEGIN
[0m22:44:42.828184 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:44:42.861181 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:44:42.862182 [debug] [MainThread]: On master: COMMIT
[0m22:44:42.862182 [debug] [MainThread]: Using postgres connection "master"
[0m22:44:42.862182 [debug] [MainThread]: On master: COMMIT
[0m22:44:42.863181 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:44:42.863181 [debug] [MainThread]: On master: Close
[0m22:44:42.864182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:44:42.864182 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m22:44:42.864182 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m22:44:42.864182 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:44:42.864182 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:44:42.865182 [info ] [MainThread]: 
[0m22:44:42.865182 [info ] [MainThread]: Finished running 1 view model, 1 seed in 0 hours 0 minutes and 7.29 seconds (7.29s).
[0m22:44:42.866181 [debug] [MainThread]: Command end result
[0m22:44:42.870181 [info ] [MainThread]: 
[0m22:44:42.870181 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:44:42.871184 [info ] [MainThread]: 
[0m22:44:42.871184 [error] [MainThread]: [33mDatabase Error in model stg_walmart (models\stg_walmart.sql)[0m
[0m22:44:42.871184 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m22:44:42.872185 [error] [MainThread]:   LINE 7: from "projeto"."walmart_source"."walmart"
[0m22:44:42.872185 [error] [MainThread]:                ^
[0m22:44:42.872185 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\stg_walmart.sql
[0m22:44:42.873187 [info ] [MainThread]: 
[0m22:44:42.873187 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:44:42.873187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D73CD510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D78DA850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205D75A2D90>]}
[0m22:44:42.874187 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:45:21.681322 | 5a4d7fb7-012d-4508-8f3e-310ad08f9a8c ==============================
[0m22:45:21.681322 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:45:21.683323 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:45:21.683323 [debug] [MainThread]: Tracking: tracking
[0m22:45:21.692421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D27F79F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D277B4AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D28033A50>]}
[0m22:45:21.701944 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:45:21.738515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:45:21.739521 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\source.yml
[0m22:45:21.750038 [debug] [MainThread]: 1699: static parser successfully parsed stg_walmart.sql
[0m22:45:21.774078 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m22:45:21.778078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a4d7fb7-012d-4508-8f3e-310ad08f9a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D27F8A190>]}
[0m22:45:21.783599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a4d7fb7-012d-4508-8f3e-310ad08f9a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D2803E890>]}
[0m22:45:21.783599 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:45:21.783599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a4d7fb7-012d-4508-8f3e-310ad08f9a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D27F3BC10>]}
[0m22:45:21.785599 [info ] [MainThread]: 
[0m22:45:21.786601 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:45:21.788106 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m22:45:21.797118 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m22:45:21.798117 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m22:45:21.798117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:45:21.832579 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:45:21.833581 [debug] [ThreadPool]: On list_projeto: Close
[0m22:45:21.834579 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m22:45:21.840091 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:45:21.840091 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m22:45:21.840091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:45:21.871352 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:45:21.871352 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:45:21.871352 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:45:21.874352 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m22:45:21.875352 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m22:45:21.875352 [debug] [ThreadPool]: On list_projeto_public: Close
[0m22:45:21.880865 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:21.880865 [debug] [MainThread]: On master: BEGIN
[0m22:45:21.880865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:45:21.911202 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:45:21.911202 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:21.912201 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:45:21.915201 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:45:21.916202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a4d7fb7-012d-4508-8f3e-310ad08f9a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D27AFBC50>]}
[0m22:45:21.917202 [debug] [MainThread]: On master: ROLLBACK
[0m22:45:21.917202 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:21.917202 [debug] [MainThread]: On master: BEGIN
[0m22:45:21.918202 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:45:21.918202 [debug] [MainThread]: On master: COMMIT
[0m22:45:21.918202 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:21.918202 [debug] [MainThread]: On master: COMMIT
[0m22:45:21.919366 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:45:21.919366 [debug] [MainThread]: On master: Close
[0m22:45:21.920366 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:45:21.920366 [info ] [MainThread]: 
[0m22:45:21.923879 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:45:21.923879 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:45:21.924882 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:45:21.924882 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:45:21.925880 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:45:21.925880 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:45:21.926883 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:45:21.926883 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:45:21.929400 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:45:21.929400 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:45:21.929400 => 2023-03-30 22:45:21.929400
[0m22:45:21.930411 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:45:21.943921 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:45:21.926883 => 2023-03-30 22:45:21.942920
[0m22:45:21.951103 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:45:21.983657 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:45:22.060951 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:45:22.060951 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:45:22.061949 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:45:22.061949 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:45:22.061949 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:45:22.061949 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:45:22.096720 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:45:22.096720 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:45:22.096720 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:45:22.096720 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:45:22.098225 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "projeto"."public"."walmart"
[0m22:45:22.098225 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m22:45:22.102230 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:45:29.095512 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:45:29.095512 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "projeto"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m22:45:29.162526 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:45:29.168524 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:45:29.181563 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:45:29.182549 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:45:29.182549 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:45:29.185882 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:45:29.186882 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:45:21.930411 => 2023-03-30 22:45:29.186882
[0m22:45:29.186882 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:45:29.186882 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a4d7fb7-012d-4508-8f3e-310ad08f9a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D27A78A50>]}
[0m22:45:29.188388 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.26s]
[0m22:45:29.188388 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 7 seconds
[0m22:45:29.189395 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:45:29.194402 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:45:29.195403 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m22:45:29.197402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:45:29.198907 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m22:45:29.198907 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:45:29.199912 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m22:45:29.199912 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:45:29.203912 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:45:29.203912 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m22:45:29.205397 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m22:45:29.206413 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:45:21.951103 => 2023-03-30 22:45:29.206413
[0m22:45:29.206413 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:45:29.206413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a4d7fb7-012d-4508-8f3e-310ad08f9a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D28A5A110>]}
[0m22:45:29.207421 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 7.28s]
[0m22:45:29.207421 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:45:29.208414 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:45:29.209513 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:29.209513 [debug] [MainThread]: On master: BEGIN
[0m22:45:29.209513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:45:29.240550 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:45:29.240550 [debug] [MainThread]: On master: COMMIT
[0m22:45:29.240550 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:29.240550 [debug] [MainThread]: On master: COMMIT
[0m22:45:29.241553 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:45:29.241553 [debug] [MainThread]: On master: Close
[0m22:45:29.242551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:45:29.242551 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m22:45:29.242551 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m22:45:29.242551 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:45:29.242551 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:45:29.243553 [info ] [MainThread]: 
[0m22:45:29.243553 [info ] [MainThread]: Finished running 1 seed, 1 view model in 0 hours 0 minutes and 7.46 seconds (7.46s).
[0m22:45:29.244551 [debug] [MainThread]: Command end result
[0m22:45:29.248553 [info ] [MainThread]: 
[0m22:45:29.248553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:45:29.249868 [info ] [MainThread]: 
[0m22:45:29.249868 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:45:29.249868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D28092710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D279A74D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012D28475010>]}
[0m22:45:29.249868 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:46:00.964976 | 69fb0eaf-f51f-42e2-87b7-f88c2e299770 ==============================
[0m22:46:00.964976 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:46:00.966769 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m22:46:00.966769 [debug] [MainThread]: Tracking: tracking
[0m22:46:00.975786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4951F1F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4951AF250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4954A2BD0>]}
[0m22:46:00.978783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4959A85D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4951F1F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4951F25D0>]}
[0m22:46:00.979784 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:46:04.775183 | c324d979-4fb6-4713-aa1e-1c2cf5b7212f ==============================
[0m22:46:04.775183 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:46:04.777195 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:46:04.777195 [debug] [MainThread]: Tracking: tracking
[0m22:46:04.785182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93389A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9338B2D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93405AFD0>]}
[0m22:46:04.793182 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:46:04.794184 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:46:04.794184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c324d979-4fb6-4713-aa1e-1c2cf5b7212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9337DC0D0>]}
[0m22:46:05.233253 [debug] [MainThread]: 1699: static parser successfully parsed stg_walmart.sql
[0m22:46:05.280771 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m22:46:05.284770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c324d979-4fb6-4713-aa1e-1c2cf5b7212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E934109750>]}
[0m22:46:05.289773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c324d979-4fb6-4713-aa1e-1c2cf5b7212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93417F850>]}
[0m22:46:05.289773 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:46:05.290773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c324d979-4fb6-4713-aa1e-1c2cf5b7212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93388E810>]}
[0m22:46:05.291773 [info ] [MainThread]: 
[0m22:46:05.292773 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:46:05.294771 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m22:46:05.303772 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m22:46:05.303772 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m22:46:05.303772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:05.335506 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:46:05.336516 [debug] [ThreadPool]: On list_projeto: Close
[0m22:46:05.338507 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m22:46:05.342504 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:46:05.343504 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m22:46:05.343504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:05.372438 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:46:05.372438 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:46:05.372438 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:46:05.375466 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m22:46:05.376455 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m22:46:05.376455 [debug] [ThreadPool]: On list_projeto_public: Close
[0m22:46:05.381452 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:05.381452 [debug] [MainThread]: On master: BEGIN
[0m22:46:05.382452 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:46:05.413938 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:46:05.414938 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:05.414938 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:46:05.417938 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m22:46:05.419938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c324d979-4fb6-4713-aa1e-1c2cf5b7212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E934440790>]}
[0m22:46:05.419938 [debug] [MainThread]: On master: ROLLBACK
[0m22:46:05.419938 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:05.420938 [debug] [MainThread]: On master: BEGIN
[0m22:46:05.420938 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:46:05.420938 [debug] [MainThread]: On master: COMMIT
[0m22:46:05.421938 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:05.421938 [debug] [MainThread]: On master: COMMIT
[0m22:46:05.421938 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:46:05.421938 [debug] [MainThread]: On master: Close
[0m22:46:05.422925 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:46:05.422925 [info ] [MainThread]: 
[0m22:46:05.426923 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:46:05.426923 [debug] [Thread-2 (]: Began running node seed.projeto_final.walmart
[0m22:46:05.426923 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m22:46:05.427926 [info ] [Thread-2 (]: 2 of 2 START seed file public.walmart .......................................... [RUN]
[0m22:46:05.427926 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:46:05.428926 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m22:46:05.428926 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:46:05.428926 [debug] [Thread-2 (]: Began compiling node seed.projeto_final.walmart
[0m22:46:05.431923 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:46:05.431923 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 22:46:05.431923 => 2023-03-30 22:46:05.431923
[0m22:46:05.432923 [debug] [Thread-2 (]: Began executing node seed.projeto_final.walmart
[0m22:46:05.452929 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:46:05.428926 => 2023-03-30 22:46:05.451929
[0m22:46:05.501437 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:46:05.523436 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:46:05.547767 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:46:05.549013 [debug] [Thread-2 (]: On seed.projeto_final.walmart: BEGIN
[0m22:46:05.549013 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:46:05.550033 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:46:05.551027 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:46:05.551027 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:46:05.580546 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m22:46:05.581553 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:46:05.581553 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:46:05.581553 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:46:05.581553 [debug] [Thread-2 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "projeto"."public"."walmart"
[0m22:46:05.582545 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m22:46:05.585563 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m22:46:12.430661 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:46:12.431672 [debug] [Thread-2 (]: On seed.projeto_final.walmart: 
          insert into "projeto"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m22:46:12.496179 [debug] [Thread-2 (]: SQL status: INSERT 0 3203 in 0 seconds
[0m22:46:12.502170 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.projeto_final.walmart"
[0m22:46:12.516170 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:46:12.516170 [debug] [Thread-2 (]: Using postgres connection "seed.projeto_final.walmart"
[0m22:46:12.517170 [debug] [Thread-2 (]: On seed.projeto_final.walmart: COMMIT
[0m22:46:12.520168 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m22:46:12.520168 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 7 seconds
[0m22:46:12.521171 [debug] [Thread-2 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 22:46:05.432923 => 2023-03-30 22:46:12.521171
[0m22:46:12.526168 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:46:12.526168 [debug] [Thread-2 (]: On seed.projeto_final.walmart: Close
[0m22:46:12.526168 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m22:46:12.527168 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c324d979-4fb6-4713-aa1e-1c2cf5b7212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9343CEC10>]}
[0m22:46:12.528168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:46:12.528168 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.walmart ...................................... [[32mINSERT 3203[0m in 7.10s]
[0m22:46:12.530168 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:46:12.532170 [debug] [Thread-2 (]: Finished running node seed.projeto_final.walmart
[0m22:46:12.532170 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m22:46:12.533172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:46:12.536172 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m22:46:12.536172 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:46:12.536172 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m22:46:12.537171 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:46:12.540167 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:46:12.541167 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m22:46:12.542168 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m22:46:12.543167 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:46:05.523746 => 2023-03-30 22:46:12.543167
[0m22:46:12.543167 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:46:12.544167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c324d979-4fb6-4713-aa1e-1c2cf5b7212f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93449D0D0>]}
[0m22:46:12.544167 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 7.12s]
[0m22:46:12.545170 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:46:12.546169 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:46:12.547169 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:12.547169 [debug] [MainThread]: On master: BEGIN
[0m22:46:12.547169 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:46:12.577682 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:46:12.577682 [debug] [MainThread]: On master: COMMIT
[0m22:46:12.577682 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:12.578683 [debug] [MainThread]: On master: COMMIT
[0m22:46:12.578683 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:46:12.578683 [debug] [MainThread]: On master: Close
[0m22:46:12.579682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:12.579682 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m22:46:12.579682 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m22:46:12.579682 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:46:12.580682 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m22:46:12.580682 [info ] [MainThread]: 
[0m22:46:12.580682 [info ] [MainThread]: Finished running 1 seed, 1 view model in 0 hours 0 minutes and 7.29 seconds (7.29s).
[0m22:46:12.581685 [debug] [MainThread]: Command end result
[0m22:46:12.585681 [info ] [MainThread]: 
[0m22:46:12.586685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:46:12.586685 [info ] [MainThread]: 
[0m22:46:12.587681 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:46:12.587681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9344E5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93410DFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9343A6DD0>]}
[0m22:46:12.588680 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 22:47:15.347504 | 62cac00e-9ef6-4fd8-a800-b0587009e45c ==============================
[0m22:47:15.347504 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:47:15.350695 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m22:47:15.350695 [debug] [MainThread]: Tracking: tracking
[0m22:47:15.361706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA36A90E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA36B33150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA362DBC50>]}
[0m22:47:15.371464 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:47:15.466909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:47:15.466909 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:47:15.467910 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m22:47:15.474909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62cac00e-9ef6-4fd8-a800-b0587009e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA36DA65D0>]}
[0m22:47:15.479909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62cac00e-9ef6-4fd8-a800-b0587009e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA36B74250>]}
[0m22:47:15.479909 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m22:47:15.480910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62cac00e-9ef6-4fd8-a800-b0587009e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA33EA3BD0>]}
[0m22:47:15.481909 [info ] [MainThread]: 
[0m22:47:15.482909 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:47:15.486027 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m22:47:15.495027 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m22:47:15.496028 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m22:47:15.496028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:15.575138 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m22:47:15.576143 [debug] [ThreadPool]: On list_projeto: Close
[0m22:47:15.578138 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m22:47:15.582139 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:47:15.583139 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m22:47:15.583139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:15.728601 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:47:15.728601 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m22:47:15.728601 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:47:15.732743 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m22:47:15.733771 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m22:47:15.733771 [debug] [ThreadPool]: On list_projeto_public: Close
[0m22:47:15.738756 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:15.738756 [debug] [MainThread]: On master: BEGIN
[0m22:47:15.739757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:47:15.770756 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:47:15.770756 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:15.771756 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:47:15.784004 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m22:47:15.785004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62cac00e-9ef6-4fd8-a800-b0587009e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA36585F90>]}
[0m22:47:15.786005 [debug] [MainThread]: On master: ROLLBACK
[0m22:47:15.786005 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:15.786005 [debug] [MainThread]: On master: BEGIN
[0m22:47:15.787006 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:47:15.787006 [debug] [MainThread]: On master: COMMIT
[0m22:47:15.787006 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:15.788003 [debug] [MainThread]: On master: COMMIT
[0m22:47:15.788003 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:47:15.788003 [debug] [MainThread]: On master: Close
[0m22:47:15.789005 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:47:15.789005 [info ] [MainThread]: 
[0m22:47:15.807378 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m22:47:15.808373 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_walmart ................................. [RUN]
[0m22:47:15.808373 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m22:47:15.809371 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m22:47:15.811373 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m22:47:15.811373 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 22:47:15.809371 => 2023-03-30 22:47:15.811373
[0m22:47:15.811373 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m22:47:15.840883 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m22:47:15.841884 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:47:15.841884 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m22:47:15.841884 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:47:15.872883 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m22:47:15.873882 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:47:15.873882 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m22:47:15.887403 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m22:47:15.892405 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:47:15.892405 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m22:47:15.893402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:47:15.895403 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:47:15.895403 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m22:47:15.896406 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m22:47:15.910414 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m22:47:15.911412 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:47:15.911412 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m22:47:16.022571 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m22:47:16.027575 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m22:47:16.027575 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m22:47:16.029571 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m22:47:16.030571 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 22:47:15.811373 => 2023-03-30 22:47:16.030571
[0m22:47:16.030571 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m22:47:16.031570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62cac00e-9ef6-4fd8-a800-b0587009e45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA362F3E90>]}
[0m22:47:16.031570 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.22s]
[0m22:47:16.033572 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m22:47:16.036417 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:47:16.036417 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:16.036417 [debug] [MainThread]: On master: BEGIN
[0m22:47:16.036417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:47:16.072417 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:47:16.072417 [debug] [MainThread]: On master: COMMIT
[0m22:47:16.072417 [debug] [MainThread]: Using postgres connection "master"
[0m22:47:16.073417 [debug] [MainThread]: On master: COMMIT
[0m22:47:16.073417 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m22:47:16.073417 [debug] [MainThread]: On master: Close
[0m22:47:16.074417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:16.074417 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m22:47:16.074417 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m22:47:16.074417 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m22:47:16.075424 [info ] [MainThread]: 
[0m22:47:16.075424 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m22:47:16.076418 [debug] [MainThread]: Command end result
[0m22:47:16.081416 [info ] [MainThread]: 
[0m22:47:16.081416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:47:16.082417 [info ] [MainThread]: 
[0m22:47:16.082417 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:47:16.082417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA3634FB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA36A04B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA36672850>]}
[0m22:47:16.083416 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:05:01.373422 | e10e934d-0f28-403a-a198-d38d7e084a4d ==============================
[0m23:05:01.373422 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:05:01.375081 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:05:01.375608 [debug] [MainThread]: Tracking: tracking
[0m23:05:01.383300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B792DE990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B792DD690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B792F69D0>]}
[0m23:05:01.391300 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:05:01.426298 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:05:01.426298 [debug] [MainThread]: Partial parsing: added file: projeto_final://models\view_1.sql
[0m23:05:01.440048 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:05:01.453046 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m23:05:01.457052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e10e934d-0f28-403a-a198-d38d7e084a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B793C74D0>]}
[0m23:05:01.461051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e10e934d-0f28-403a-a198-d38d7e084a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B7966FD10>]}
[0m23:05:01.461051 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m23:05:01.462052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e10e934d-0f28-403a-a198-d38d7e084a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B793B7850>]}
[0m23:05:01.463051 [info ] [MainThread]: 
[0m23:05:01.464631 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:05:01.465630 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:05:01.474138 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:05:01.474138 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:05:01.474138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:01.506392 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:05:01.508405 [debug] [ThreadPool]: On list_projeto: Close
[0m23:05:01.509405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:05:01.514408 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:05:01.514408 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:05:01.514408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:01.543406 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:05:01.543406 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:05:01.543406 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:05:01.545403 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m23:05:01.547409 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:05:01.547409 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:05:01.552408 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:01.553409 [debug] [MainThread]: On master: BEGIN
[0m23:05:01.553409 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:05:01.587344 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:05:01.587344 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:01.588343 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:05:01.591342 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m23:05:01.592343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e10e934d-0f28-403a-a198-d38d7e084a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B79398290>]}
[0m23:05:01.592343 [debug] [MainThread]: On master: ROLLBACK
[0m23:05:01.592343 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:01.593342 [debug] [MainThread]: On master: BEGIN
[0m23:05:01.593342 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:05:01.593342 [debug] [MainThread]: On master: COMMIT
[0m23:05:01.594345 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:01.594345 [debug] [MainThread]: On master: COMMIT
[0m23:05:01.594345 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:05:01.594345 [debug] [MainThread]: On master: Close
[0m23:05:01.595343 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:05:01.595343 [info ] [MainThread]: 
[0m23:05:01.599343 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:05:01.599343 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:05:01.599343 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:05:01.600343 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:05:01.600343 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:05:01.601345 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:05:01.601345 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:05:01.601345 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:05:01.603343 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:05:01.604343 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:05:01.605343 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:05:01.601345 => 2023-03-30 23:05:01.605343
[0m23:05:01.605343 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:05:01.604343 => 2023-03-30 23:05:01.605343
[0m23:05:01.605343 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:05:01.606345 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:05:01.634342 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:05:01.638342 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:05:01.639346 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:01.639346 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:05:01.639346 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:05:01.640346 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:05:01.640346 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:05:01.640346 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:05:01.671862 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:05:01.671862 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:01.671862 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:05:01.672862 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:05:01.672862 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:05:01.672862 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    SELECT order_id,
	order_state,
	state
FROM walmart_source.walmart
WHERE state == 'California'
  );
[0m23:05:01.673860 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:05:01.678861 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:01.678861 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: FROM walmart_source.walmart
             ^

[0m23:05:01.678861 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:05:01.679860 [debug] [Thread-2 (]: On model.projeto_final.view_1: ROLLBACK
[0m23:05:01.679860 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:05:01.635342 => 2023-03-30 23:05:01.679860
[0m23:05:01.679860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:05:01.680863 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:05:01.693861 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:05:01.695860 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:01.695860 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:05:01.696860 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:05:01.700859 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:01.700859 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:05:01.701864 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:05:01.702862 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:05:01.606345 => 2023-03-30 23:05:01.702862
[0m23:05:01.703859 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:05:01.703859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e10e934d-0f28-403a-a198-d38d7e084a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B7937F050>]}
[0m23:05:01.704861 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.10s]
[0m23:05:01.705861 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:05:01.710034 [debug] [Thread-2 (]: Database Error in model view_1 (models\view_1.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: FROM walmart_source.walmart
               ^
  compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:05:01.711039 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e10e934d-0f28-403a-a198-d38d7e084a4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B78E05490>]}
[0m23:05:01.711039 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model public.view_1 ............................. [[31mERROR[0m in 0.11s]
[0m23:05:01.711039 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:05:01.713034 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:05:01.713034 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:01.713034 [debug] [MainThread]: On master: BEGIN
[0m23:05:01.713034 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:05:01.743038 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:05:01.743038 [debug] [MainThread]: On master: COMMIT
[0m23:05:01.743038 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:01.744033 [debug] [MainThread]: On master: COMMIT
[0m23:05:01.744033 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:05:01.744033 [debug] [MainThread]: On master: Close
[0m23:05:01.745034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:01.745034 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:05:01.745034 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:05:01.745034 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:05:01.745034 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:05:01.746034 [info ] [MainThread]: 
[0m23:05:01.746034 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m23:05:01.747034 [debug] [MainThread]: Command end result
[0m23:05:01.751033 [info ] [MainThread]: 
[0m23:05:01.752035 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:05:01.752035 [info ] [MainThread]: 
[0m23:05:01.752035 [error] [MainThread]: [33mDatabase Error in model view_1 (models\view_1.sql)[0m
[0m23:05:01.753033 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m23:05:01.753033 [error] [MainThread]:   LINE 7: FROM walmart_source.walmart
[0m23:05:01.753033 [error] [MainThread]:                ^
[0m23:05:01.754033 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:05:01.754033 [info ] [MainThread]: 
[0m23:05:01.754033 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m23:05:01.755038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B793B42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B793C6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B78B19390>]}
[0m23:05:01.755038 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:05:09.009062 | 29f887d1-d25b-4a67-bae5-c969af876edf ==============================
[0m23:05:09.009062 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:05:09.011061 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m23:05:09.011061 [debug] [MainThread]: Tracking: tracking
[0m23:05:09.019062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE1A20CF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE19F34AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE1A6E9710>]}
[0m23:05:09.027061 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:05:09.064069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:05:09.064069 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:05:09.064069 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m23:05:09.070067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29f887d1-d25b-4a67-bae5-c969af876edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE1A1E4110>]}
[0m23:05:09.074581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29f887d1-d25b-4a67-bae5-c969af876edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE1A7E4590>]}
[0m23:05:09.074581 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m23:05:09.075580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29f887d1-d25b-4a67-bae5-c969af876edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE16533ED0>]}
[0m23:05:09.076580 [info ] [MainThread]: 
[0m23:05:09.077578 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:05:09.079579 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:05:09.087579 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:05:09.087579 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:05:09.087579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:09.120845 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:05:09.121855 [debug] [ThreadPool]: On list_projeto: Close
[0m23:05:09.122844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:05:09.127843 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:05:09.127843 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:05:09.127843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:09.156939 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:05:09.156939 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:05:09.156939 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:05:09.159947 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m23:05:09.160946 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:05:09.160946 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:05:09.165946 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:09.165946 [debug] [MainThread]: On master: BEGIN
[0m23:05:09.165946 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:05:09.194455 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:05:09.195456 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:09.195456 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:05:09.198456 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m23:05:09.200456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29f887d1-d25b-4a67-bae5-c969af876edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE1A1F9310>]}
[0m23:05:09.200456 [debug] [MainThread]: On master: ROLLBACK
[0m23:05:09.200456 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:09.200456 [debug] [MainThread]: On master: BEGIN
[0m23:05:09.201460 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:05:09.201460 [debug] [MainThread]: On master: COMMIT
[0m23:05:09.201460 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:09.202455 [debug] [MainThread]: On master: COMMIT
[0m23:05:09.202455 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:05:09.202455 [debug] [MainThread]: On master: Close
[0m23:05:09.203455 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:05:09.203455 [info ] [MainThread]: 
[0m23:05:09.207199 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:05:09.207199 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:05:09.207199 [debug] [Thread-3 (]: Began running node seed.projeto_final.walmart
[0m23:05:09.208212 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:05:09.208212 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:05:09.209212 [info ] [Thread-3 (]: 3 of 3 START seed file public.walmart .......................................... [RUN]
[0m23:05:09.209212 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:05:09.210211 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:05:09.210211 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m23:05:09.210211 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:05:09.211212 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:05:09.211212 [debug] [Thread-3 (]: Began compiling node seed.projeto_final.walmart
[0m23:05:09.213210 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:05:09.214213 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:05:09.214213 [debug] [Thread-3 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 23:05:09.214213 => 2023-03-30 23:05:09.214213
[0m23:05:09.215212 [debug] [Thread-3 (]: Began executing node seed.projeto_final.walmart
[0m23:05:09.215212 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:05:09.211212 => 2023-03-30 23:05:09.215212
[0m23:05:09.215212 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:05:09.213210 => 2023-03-30 23:05:09.215212
[0m23:05:09.229210 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:05:09.229210 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:05:09.266706 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:05:09.269706 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:05:09.337049 [debug] [Thread-3 (]: Using postgres connection "seed.projeto_final.walmart"
[0m23:05:09.337049 [debug] [Thread-3 (]: On seed.projeto_final.walmart: BEGIN
[0m23:05:09.338051 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:09.338051 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:05:09.338051 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:05:09.338051 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:05:09.339053 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:05:09.339053 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:05:09.339053 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:05:09.371053 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:05:09.371053 [debug] [Thread-3 (]: Using postgres connection "seed.projeto_final.walmart"
[0m23:05:09.371053 [debug] [Thread-3 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "projeto"."public"."walmart"
[0m23:05:09.373563 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:05:09.373563 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:09.373563 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:05:09.374564 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:05:09.374923 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:05:09.374923 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    SELECT order_id,
	order_state,
	state
FROM walmart_source.walmart
WHERE state == 'California'
  );
[0m23:05:09.374923 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: FROM walmart_source.walmart
             ^

[0m23:05:09.375937 [debug] [Thread-2 (]: On model.projeto_final.view_1: ROLLBACK
[0m23:05:09.375937 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:05:09.266706 => 2023-03-30 23:05:09.375937
[0m23:05:09.375937 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:05:09.375937 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m23:05:10.330603 [debug] [Thread-2 (]: Database Error in model view_1 (models\view_1.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: FROM walmart_source.walmart
               ^
  compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:05:10.377120 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29f887d1-d25b-4a67-bae5-c969af876edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE19F43310>]}
[0m23:05:10.441120 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model public.view_1 ............................. [[31mERROR[0m in 1.17s]
[0m23:05:10.522208 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:05:16.118765 [debug] [Thread-3 (]: Using postgres connection "seed.projeto_final.walmart"
[0m23:05:16.118765 [debug] [Thread-3 (]: On seed.projeto_final.walmart: 
          insert into "projeto"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m23:05:16.160936 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "Order ID" of relation "walmart" does not exist
LINE 2: ...        insert into "projeto"."public"."walmart" ("Order ID"...
                                                             ^

[0m23:05:16.160936 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 7 seconds
[0m23:05:16.160936 [debug] [Thread-3 (]: On seed.projeto_final.walmart: ROLLBACK
[0m23:05:16.166930 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:16.166930 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:05:16.166930 [debug] [Thread-3 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 23:05:09.216211 => 2023-03-30 23:05:16.166930
[0m23:05:16.167935 [debug] [Thread-3 (]: On seed.projeto_final.walmart: Close
[0m23:05:16.167935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:05:16.170934 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:16.170934 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:05:16.170934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:05:16.185441 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:05:16.186444 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:16.187443 [debug] [Thread-3 (]: Database Error in seed walmart (seeds\walmart.csv)
  column "Order ID" of relation "walmart" does not exist
  LINE 2: ...        insert into "projeto"."public"."walmart" ("Order ID"...
                                                               ^
[0m23:05:16.187443 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:05:16.188440 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29f887d1-d25b-4a67-bae5-c969af876edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE1AB0D450>]}
[0m23:05:16.188440 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:05:16.188440 [error] [Thread-3 (]: 3 of 3 ERROR loading seed file public.walmart .................................. [[31mERROR[0m in 6.98s]
[0m23:05:16.192442 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:16.192442 [debug] [Thread-3 (]: Finished running node seed.projeto_final.walmart
[0m23:05:16.193441 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:05:16.194442 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:05:16.195441 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:05:09.236703 => 2023-03-30 23:05:16.195441
[0m23:05:16.195441 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:05:16.196442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29f887d1-d25b-4a67-bae5-c969af876edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE19FDF8D0>]}
[0m23:05:16.196442 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 6.99s]
[0m23:05:16.197442 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:05:16.198444 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:05:16.198444 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:16.198444 [debug] [MainThread]: On master: BEGIN
[0m23:05:16.199447 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:05:16.227441 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:05:16.228442 [debug] [MainThread]: On master: COMMIT
[0m23:05:16.228442 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:16.228442 [debug] [MainThread]: On master: COMMIT
[0m23:05:16.228442 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:05:16.229444 [debug] [MainThread]: On master: Close
[0m23:05:16.229444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:16.230441 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:05:16.230441 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:05:16.230441 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:05:16.230441 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:05:16.230441 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m23:05:16.231442 [info ] [MainThread]: 
[0m23:05:16.231442 [info ] [MainThread]: Finished running 2 view models, 1 seed in 0 hours 0 minutes and 7.15 seconds (7.15s).
[0m23:05:16.232441 [debug] [MainThread]: Command end result
[0m23:05:16.236441 [info ] [MainThread]: 
[0m23:05:16.237441 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m23:05:16.237441 [info ] [MainThread]: 
[0m23:05:16.238445 [error] [MainThread]: [33mDatabase Error in model view_1 (models\view_1.sql)[0m
[0m23:05:16.238445 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m23:05:16.238445 [error] [MainThread]:   LINE 7: FROM walmart_source.walmart
[0m23:05:16.239445 [error] [MainThread]:                ^
[0m23:05:16.239445 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:05:16.239445 [info ] [MainThread]: 
[0m23:05:16.239445 [error] [MainThread]: [33mDatabase Error in seed walmart (seeds\walmart.csv)[0m
[0m23:05:16.240447 [error] [MainThread]:   column "Order ID" of relation "walmart" does not exist
[0m23:05:16.240447 [error] [MainThread]:   LINE 2: ...        insert into "projeto"."public"."walmart" ("Order ID"...
[0m23:05:16.240447 [error] [MainThread]:                                                                ^
[0m23:05:16.241444 [info ] [MainThread]: 
[0m23:05:16.241444 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m23:05:16.242446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE1A2EC690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE1AB4A250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE1AB49A90>]}
[0m23:05:16.242446 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:05:28.369181 | 011efa87-ab21-4f90-ba21-0131e77ee3d7 ==============================
[0m23:05:28.369181 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:05:28.370181 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m23:05:28.371180 [debug] [MainThread]: Tracking: tracking
[0m23:05:28.379185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907E1E5410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907E8FF650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907E171090>]}
[0m23:05:28.383184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907E69AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907E1E5410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002907E143C50>]}
[0m23:05:28.383184 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:05:33.490646 | c080fa50-5ea1-4e07-b3ab-99e687e91cbd ==============================
[0m23:05:33.490646 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:05:33.492645 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m23:05:33.492645 [debug] [MainThread]: Tracking: tracking
[0m23:05:33.500977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F03A5BF1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F03A524690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F03A5C8850>]}
[0m23:05:33.508976 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:05:33.508976 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:05:33.509977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c080fa50-5ea1-4e07-b3ab-99e687e91cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F03A5C8790>]}
[0m23:05:33.945229 [debug] [MainThread]: 1699: static parser successfully parsed stg_walmart.sql
[0m23:05:33.954778 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:05:33.994277 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m23:05:33.998691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c080fa50-5ea1-4e07-b3ab-99e687e91cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F03A883AD0>]}
[0m23:05:34.002690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c080fa50-5ea1-4e07-b3ab-99e687e91cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F03A8C84D0>]}
[0m23:05:34.003691 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m23:05:34.003691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c080fa50-5ea1-4e07-b3ab-99e687e91cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F039E03490>]}
[0m23:05:34.004691 [info ] [MainThread]: 
[0m23:05:34.005691 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:05:34.007696 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:05:34.015691 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:05:34.015691 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:05:34.015691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:34.047691 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:05:34.048698 [debug] [ThreadPool]: On list_projeto: Close
[0m23:05:34.050691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:05:34.055691 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:05:34.055691 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:05:34.055691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:34.084434 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:05:34.084434 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:05:34.084434 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:05:34.087463 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m23:05:34.088463 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:05:34.088463 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:05:34.092999 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:34.094001 [debug] [MainThread]: On master: BEGIN
[0m23:05:34.094001 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:05:34.121987 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:05:34.122987 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:34.122987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:05:34.125987 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m23:05:34.126987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c080fa50-5ea1-4e07-b3ab-99e687e91cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F03A5BE310>]}
[0m23:05:34.127987 [debug] [MainThread]: On master: ROLLBACK
[0m23:05:34.127987 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:34.127987 [debug] [MainThread]: On master: BEGIN
[0m23:05:34.128987 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:05:34.128987 [debug] [MainThread]: On master: COMMIT
[0m23:05:34.128987 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:34.128987 [debug] [MainThread]: On master: COMMIT
[0m23:05:34.129987 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:05:34.129987 [debug] [MainThread]: On master: Close
[0m23:05:34.129987 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:05:34.130988 [info ] [MainThread]: 
[0m23:05:34.134987 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:05:34.134987 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:05:34.134987 [debug] [Thread-3 (]: Began running node seed.projeto_final.walmart
[0m23:05:34.135987 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:05:34.135987 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:05:34.135987 [info ] [Thread-3 (]: 3 of 3 START seed file public.walmart .......................................... [RUN]
[0m23:05:34.136990 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:05:34.136990 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:05:34.137987 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.projeto_final.walmart'
[0m23:05:34.137987 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:05:34.137987 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:05:34.137987 [debug] [Thread-3 (]: Began compiling node seed.projeto_final.walmart
[0m23:05:34.139987 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:05:34.140987 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:05:34.141987 [debug] [Thread-3 (]: Timing info for seed.projeto_final.walmart (compile): 2023-03-30 23:05:34.141987 => 2023-03-30 23:05:34.141987
[0m23:05:34.142991 [debug] [Thread-3 (]: Began executing node seed.projeto_final.walmart
[0m23:05:34.162987 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:05:34.138987 => 2023-03-30 23:05:34.162987
[0m23:05:34.163988 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:05:34.140987 => 2023-03-30 23:05:34.163988
[0m23:05:34.163988 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:05:34.221504 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:05:34.233504 [debug] [Thread-3 (]: Using postgres connection "seed.projeto_final.walmart"
[0m23:05:34.262719 [debug] [Thread-3 (]: On seed.projeto_final.walmart: BEGIN
[0m23:05:34.261731 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:05:34.258718 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:05:34.262719 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:05:34.263717 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:05:34.264717 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:34.264717 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:05:34.264717 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:05:34.264717 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:05:34.265717 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:05:34.295232 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:05:34.296234 [debug] [Thread-3 (]: Using postgres connection "seed.projeto_final.walmart"
[0m23:05:34.296234 [debug] [Thread-3 (]: On seed.projeto_final.walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "seed.projeto_final.walmart"} */
truncate table "projeto"."public"."walmart"
[0m23:05:34.297237 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:05:34.297237 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:05:34.297237 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    SELECT order_id,
	order_state,
	state
FROM walmart_source.walmart
WHERE state == 'California'
  );
[0m23:05:34.297237 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: FROM walmart_source.walmart
             ^

[0m23:05:34.298239 [debug] [Thread-2 (]: On model.projeto_final.view_1: ROLLBACK
[0m23:05:34.298239 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:05:34.259729 => 2023-03-30 23:05:34.298239
[0m23:05:34.298239 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:05:34.300235 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:05:34.300235 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:34.301237 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0 seconds
[0m23:05:34.301237 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:05:35.043796 [debug] [Thread-2 (]: Database Error in model view_1 (models\view_1.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: FROM walmart_source.walmart
               ^
  compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:05:35.106363 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c080fa50-5ea1-4e07-b3ab-99e687e91cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F03A9A1F90>]}
[0m23:05:35.154363 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model public.view_1 ............................. [[31mERROR[0m in 0.97s]
[0m23:05:35.250888 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:05:41.002606 [debug] [Thread-3 (]: Using postgres connection "seed.projeto_final.walmart"
[0m23:05:41.002606 [debug] [Thread-3 (]: On seed.projeto_final.walmart: 
          insert into "projeto"."public"."walmart" ("Order ID", "Order Date", "Ship Date", "Customer Name", "Country", "City", "State", "Category", "Product Name", "Sales", "Quantity", "Profit") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s...
[0m23:05:41.043606 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "Order ID" of relation "walmart" does not exist
LINE 2: ...        insert into "projeto"."public"."walmart" ("Order ID"...
                                                             ^

[0m23:05:41.043606 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 7 seconds
[0m23:05:41.044606 [debug] [Thread-3 (]: On seed.projeto_final.walmart: ROLLBACK
[0m23:05:41.049606 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:41.049606 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:05:41.050606 [debug] [Thread-3 (]: Timing info for seed.projeto_final.walmart (execute): 2023-03-30 23:05:34.142991 => 2023-03-30 23:05:41.050606
[0m23:05:41.050606 [debug] [Thread-3 (]: On seed.projeto_final.walmart: Close
[0m23:05:41.050606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:05:41.053606 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:41.054607 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:05:41.054607 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:05:41.055607 [debug] [Thread-3 (]: Database Error in seed walmart (seeds\walmart.csv)
  column "Order ID" of relation "walmart" does not exist
  LINE 2: ...        insert into "projeto"."public"."walmart" ("Order ID"...
                                                               ^
[0m23:05:41.070609 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:05:41.071606 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c080fa50-5ea1-4e07-b3ab-99e687e91cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F03A5BDF50>]}
[0m23:05:41.071606 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:41.071606 [error] [Thread-3 (]: 3 of 3 ERROR loading seed file public.walmart .................................. [[31mERROR[0m in 6.93s]
[0m23:05:41.072608 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:05:41.072608 [debug] [Thread-3 (]: Finished running node seed.projeto_final.walmart
[0m23:05:41.073625 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:05:41.076652 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:05:41.077653 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:05:41.078797 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:05:41.079809 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:05:34.234703 => 2023-03-30 23:05:41.078797
[0m23:05:41.079809 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:05:41.079809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c080fa50-5ea1-4e07-b3ab-99e687e91cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F03AA0A290>]}
[0m23:05:41.080812 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 6.94s]
[0m23:05:41.080812 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:05:41.081808 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:05:41.082810 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:41.082810 [debug] [MainThread]: On master: BEGIN
[0m23:05:41.082810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:05:41.112333 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:05:41.113334 [debug] [MainThread]: On master: COMMIT
[0m23:05:41.113334 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:41.113334 [debug] [MainThread]: On master: COMMIT
[0m23:05:41.114333 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:05:41.114333 [debug] [MainThread]: On master: Close
[0m23:05:41.114333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:41.115335 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:05:41.115335 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:05:41.115335 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:05:41.115335 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:05:41.115335 [debug] [MainThread]: Connection 'seed.projeto_final.walmart' was properly closed.
[0m23:05:41.116334 [info ] [MainThread]: 
[0m23:05:41.116334 [info ] [MainThread]: Finished running 2 view models, 1 seed in 0 hours 0 minutes and 7.11 seconds (7.11s).
[0m23:05:41.117334 [debug] [MainThread]: Command end result
[0m23:05:41.121333 [info ] [MainThread]: 
[0m23:05:41.122335 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m23:05:41.122335 [info ] [MainThread]: 
[0m23:05:41.122335 [error] [MainThread]: [33mDatabase Error in model view_1 (models\view_1.sql)[0m
[0m23:05:41.123335 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m23:05:41.123335 [error] [MainThread]:   LINE 7: FROM walmart_source.walmart
[0m23:05:41.123335 [error] [MainThread]:                ^
[0m23:05:41.124333 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:05:41.124333 [info ] [MainThread]: 
[0m23:05:41.124333 [error] [MainThread]: [33mDatabase Error in seed walmart (seeds\walmart.csv)[0m
[0m23:05:41.125334 [error] [MainThread]:   column "Order ID" of relation "walmart" does not exist
[0m23:05:41.125334 [error] [MainThread]:   LINE 2: ...        insert into "projeto"."public"."walmart" ("Order ID"...
[0m23:05:41.125334 [error] [MainThread]:                                                                ^
[0m23:05:41.126335 [info ] [MainThread]: 
[0m23:05:41.126335 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m23:05:41.126335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F03A4E1A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F039DE9D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F03AA06810>]}
[0m23:05:41.127335 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:06:30.991112 | f8879470-e98f-4f29-969a-8a1f54bfcc6e ==============================
[0m23:06:30.991112 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:06:30.993434 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m23:06:30.993950 [debug] [MainThread]: Tracking: tracking
[0m23:06:31.001463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439E0D3B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439E94B550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439E94BF50>]}
[0m23:06:31.009463 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:06:31.044462 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m23:06:31.044462 [debug] [MainThread]: Partial parsing: deleted file: projeto_final://seeds\walmart.csv
[0m23:06:31.048463 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m23:06:31.053462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8879470-e98f-4f29-969a-8a1f54bfcc6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439E932FD0>]}
[0m23:06:31.057463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8879470-e98f-4f29-969a-8a1f54bfcc6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439E94E410>]}
[0m23:06:31.057463 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:06:31.058464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8879470-e98f-4f29-969a-8a1f54bfcc6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439E954A90>]}
[0m23:06:31.059463 [info ] [MainThread]: 
[0m23:06:31.060466 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:06:31.062463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:06:31.070469 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:06:31.070469 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:06:31.071474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:31.102978 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:06:31.103978 [debug] [ThreadPool]: On list_projeto: Close
[0m23:06:31.105979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:06:31.109978 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:06:31.109978 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:06:31.110978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:31.245859 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:06:31.245859 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:06:31.245859 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:06:31.248887 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m23:06:31.249888 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:06:31.249888 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:06:31.254874 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:31.255874 [debug] [MainThread]: On master: BEGIN
[0m23:06:31.255874 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:06:31.284393 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:06:31.284393 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:31.285399 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:06:31.288394 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m23:06:31.289393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8879470-e98f-4f29-969a-8a1f54bfcc6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439BB9AB50>]}
[0m23:06:31.289393 [debug] [MainThread]: On master: ROLLBACK
[0m23:06:31.290393 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:31.290393 [debug] [MainThread]: On master: BEGIN
[0m23:06:31.290393 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:06:31.291395 [debug] [MainThread]: On master: COMMIT
[0m23:06:31.291395 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:31.291395 [debug] [MainThread]: On master: COMMIT
[0m23:06:31.291395 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:06:31.292393 [debug] [MainThread]: On master: Close
[0m23:06:31.292393 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:06:31.293399 [info ] [MainThread]: 
[0m23:06:31.296394 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:06:31.297393 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:06:31.297393 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:06:31.297393 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:06:31.298394 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:06:31.298394 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:06:31.299394 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:06:31.299394 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:06:31.301393 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:06:31.302393 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:06:31.303396 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:06:31.299394 => 2023-03-30 23:06:31.303396
[0m23:06:31.303396 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:06:31.303396 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:06:31.301393 => 2023-03-30 23:06:31.303396
[0m23:06:31.332393 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:06:31.332393 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:06:31.335393 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:06:31.336393 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:06:31.336393 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:06:31.336393 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:06:31.337394 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:06:31.337394 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:06:31.337394 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:06:31.368398 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:06:31.369399 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:06:31.369399 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:06:31.369399 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:06:31.369399 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:06:31.370399 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    SELECT order_id,
	order_state,
	state
FROM walmart_source.walmart
WHERE state == 'California'
  );
[0m23:06:31.370399 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "walmart_source.walmart" does not exist
LINE 7: FROM walmart_source.walmart
             ^

[0m23:06:31.370399 [debug] [Thread-2 (]: On model.projeto_final.view_1: ROLLBACK
[0m23:06:31.371401 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:06:31.371401 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:06:31.332393 => 2023-03-30 23:06:31.371401
[0m23:06:31.376398 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:06:31.376398 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:06:31.377398 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:06:31.379404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:06:31.381398 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:06:31.381398 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:06:31.382902 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:06:31.397907 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:06:31.397907 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:06:31.397907 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:06:31.399908 [debug] [Thread-2 (]: Database Error in model view_1 (models\view_1.sql)
  relation "walmart_source.walmart" does not exist
  LINE 7: FROM walmart_source.walmart
               ^
  compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:06:31.399908 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:06:31.399908 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8879470-e98f-4f29-969a-8a1f54bfcc6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439E972990>]}
[0m23:06:31.403907 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:06:31.404908 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:06:31.403907 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model public.view_1 ............................. [[31mERROR[0m in 0.10s]
[0m23:06:31.405908 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:06:31.405908 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:06:31.406907 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:06:31.303396 => 2023-03-30 23:06:31.406907
[0m23:06:31.407907 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:06:31.407907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8879470-e98f-4f29-969a-8a1f54bfcc6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439EC7A290>]}
[0m23:06:31.408908 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m23:06:31.408908 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:06:31.409907 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:06:31.409907 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:31.410908 [debug] [MainThread]: On master: BEGIN
[0m23:06:31.410908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:06:31.439756 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:06:31.439756 [debug] [MainThread]: On master: COMMIT
[0m23:06:31.439756 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:31.439756 [debug] [MainThread]: On master: COMMIT
[0m23:06:31.440752 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:06:31.440752 [debug] [MainThread]: On master: Close
[0m23:06:31.441753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:06:31.441753 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:06:31.441753 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:06:31.441753 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:06:31.442754 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:06:31.442754 [info ] [MainThread]: 
[0m23:06:31.442754 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m23:06:31.443753 [debug] [MainThread]: Command end result
[0m23:06:31.447752 [info ] [MainThread]: 
[0m23:06:31.447752 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:06:31.448753 [info ] [MainThread]: 
[0m23:06:31.448753 [error] [MainThread]: [33mDatabase Error in model view_1 (models\view_1.sql)[0m
[0m23:06:31.449752 [error] [MainThread]:   relation "walmart_source.walmart" does not exist
[0m23:06:31.449752 [error] [MainThread]:   LINE 7: FROM walmart_source.walmart
[0m23:06:31.449752 [error] [MainThread]:                ^
[0m23:06:31.450752 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:06:31.450752 [info ] [MainThread]: 
[0m23:06:31.450752 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m23:06:31.451752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439E0CB010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439E965150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002439E965390>]}
[0m23:06:31.451752 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:07:07.623170 | 46e3fadb-0c65-4c87-a784-b83b555e89e2 ==============================
[0m23:07:07.623170 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:07:07.625169 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m23:07:07.625169 [debug] [MainThread]: Tracking: tracking
[0m23:07:07.634170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46FFEB850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46FD51110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46FFEA310>]}
[0m23:07:07.638171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46FFFE4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46FFFE210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46FD3B250>]}
[0m23:07:07.639170 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:07:21.702019 | fd33f35b-da7f-47e4-8cb6-5c8b70215dab ==============================
[0m23:07:21.702019 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:07:21.704532 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m23:07:21.704532 [debug] [MainThread]: Tracking: tracking
[0m23:07:21.712532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285C0FAFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285C0D3BA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285C0DDFD50>]}
[0m23:07:21.719533 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:07:21.720534 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:07:21.721132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fd33f35b-da7f-47e4-8cb6-5c8b70215dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285C15AF250>]}
[0m23:07:22.164255 [debug] [MainThread]: 1699: static parser successfully parsed stg_walmart.sql
[0m23:07:22.174255 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:07:22.204264 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m23:07:22.208787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd33f35b-da7f-47e4-8cb6-5c8b70215dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285C1508F50>]}
[0m23:07:22.212786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd33f35b-da7f-47e4-8cb6-5c8b70215dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285C18659D0>]}
[0m23:07:22.213786 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:07:22.213786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd33f35b-da7f-47e4-8cb6-5c8b70215dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285C10CB390>]}
[0m23:07:22.214786 [info ] [MainThread]: 
[0m23:07:22.216781 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:07:22.217785 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:07:22.226781 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:07:22.226781 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:07:22.226781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:22.258802 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:07:22.259785 [debug] [ThreadPool]: On list_projeto: Close
[0m23:07:22.260783 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:07:22.265782 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:07:22.265782 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:07:22.266785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:22.294791 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:07:22.294791 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:07:22.295788 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:07:22.297794 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m23:07:22.298790 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:07:22.299788 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:07:22.304300 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:22.304300 [debug] [MainThread]: On master: BEGIN
[0m23:07:22.304300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:07:22.333311 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:07:22.334308 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:22.334308 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:07:22.337312 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m23:07:22.339306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd33f35b-da7f-47e4-8cb6-5c8b70215dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285C162EC50>]}
[0m23:07:22.339306 [debug] [MainThread]: On master: ROLLBACK
[0m23:07:22.339306 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:22.340312 [debug] [MainThread]: On master: BEGIN
[0m23:07:22.340312 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:07:22.340312 [debug] [MainThread]: On master: COMMIT
[0m23:07:22.341308 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:22.341308 [debug] [MainThread]: On master: COMMIT
[0m23:07:22.341308 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:07:22.341308 [debug] [MainThread]: On master: Close
[0m23:07:22.342312 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:07:22.342312 [info ] [MainThread]: 
[0m23:07:22.345650 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:07:22.346663 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:07:22.346973 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:07:22.346973 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:07:22.347983 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:07:22.347983 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:07:22.347983 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:07:22.348984 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:07:22.350982 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:07:22.351986 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:07:22.353012 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:07:22.350982 => 2023-03-30 23:07:22.353012
[0m23:07:22.353012 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:07:22.348984 => 2023-03-30 23:07:22.353012
[0m23:07:22.354027 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:07:22.354027 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:07:22.383027 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:07:22.387022 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:07:22.388028 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:07:22.388028 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:07:22.388028 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:07:22.389026 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:07:22.389026 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:07:22.389026 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:07:22.420546 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:07:22.421547 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:07:22.421547 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:07:22.421547 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    SELECT order_id,
	order_state,
	state
FROM walmart
WHERE state == 'California'
  );
[0m23:07:22.422547 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:07:22.422547 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:07:22.422547 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "order_state" does not exist
LINE 5:  order_state,
         ^
HINT:  Perhaps you meant to reference the column "walmart.order_date".

[0m23:07:22.422547 [debug] [Thread-2 (]: On model.projeto_final.view_1: ROLLBACK
[0m23:07:22.423545 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:07:22.354027 => 2023-03-30 23:07:22.423545
[0m23:07:22.423545 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:07:22.424545 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:07:22.429545 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:07:22.430545 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:07:22.430545 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:07:22.432545 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:07:22.433544 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:07:22.433544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:07:22.447545 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:07:22.448547 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:07:22.448547 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:07:22.449548 [debug] [Thread-2 (]: Database Error in model view_1 (models\view_1.sql)
  column "order_state" does not exist
  LINE 5:  order_state,
           ^
  HINT:  Perhaps you meant to reference the column "walmart.order_date".
  compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:07:22.449548 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:07:22.449548 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd33f35b-da7f-47e4-8cb6-5c8b70215dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285C15BEA90>]}
[0m23:07:22.454550 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:07:22.454550 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:07:22.454550 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model public.view_1 ............................. [[31mERROR[0m in 0.10s]
[0m23:07:22.456547 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:07:22.456547 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:07:22.457547 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:07:22.384026 => 2023-03-30 23:07:22.457547
[0m23:07:22.457547 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:07:22.458547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd33f35b-da7f-47e4-8cb6-5c8b70215dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285C0D4A810>]}
[0m23:07:22.458547 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m23:07:22.459547 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:07:22.460545 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:07:22.460545 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:22.460545 [debug] [MainThread]: On master: BEGIN
[0m23:07:22.461548 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:07:22.490980 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:07:22.491494 [debug] [MainThread]: On master: COMMIT
[0m23:07:22.491494 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:22.492011 [debug] [MainThread]: On master: COMMIT
[0m23:07:22.492011 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:07:22.492011 [debug] [MainThread]: On master: Close
[0m23:07:22.493029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:22.493029 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:07:22.493029 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:07:22.493029 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:07:22.494018 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:07:22.494018 [info ] [MainThread]: 
[0m23:07:22.494018 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m23:07:22.495018 [debug] [MainThread]: Command end result
[0m23:07:22.499017 [info ] [MainThread]: 
[0m23:07:22.500019 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:07:22.500019 [info ] [MainThread]: 
[0m23:07:22.500019 [error] [MainThread]: [33mDatabase Error in model view_1 (models\view_1.sql)[0m
[0m23:07:22.501017 [error] [MainThread]:   column "order_state" does not exist
[0m23:07:22.501017 [error] [MainThread]:   LINE 5:  order_state,
[0m23:07:22.501017 [error] [MainThread]:            ^
[0m23:07:22.502017 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "walmart.order_date".
[0m23:07:22.502017 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:07:22.502017 [info ] [MainThread]: 
[0m23:07:22.502017 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m23:07:22.503017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285C1819C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285C1852BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285C162FFD0>]}
[0m23:07:22.503017 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:07:44.706949 | d76191ba-c72e-4432-9aac-5036c447c229 ==============================
[0m23:07:44.706949 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:07:44.707949 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m23:07:44.708950 [debug] [MainThread]: Tracking: tracking
[0m23:07:44.716955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001954D78B490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001954D6A4E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001954D73B250>]}
[0m23:07:44.724457 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:07:44.758462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:07:44.758462 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m23:07:44.769462 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:07:44.781462 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m23:07:44.788462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd76191ba-c72e-4432-9aac-5036c447c229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001954DBB9E50>]}
[0m23:07:44.795462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd76191ba-c72e-4432-9aac-5036c447c229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001954DC7CB50>]}
[0m23:07:44.796462 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:07:44.796462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd76191ba-c72e-4432-9aac-5036c447c229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001954DC94290>]}
[0m23:07:44.797462 [info ] [MainThread]: 
[0m23:07:44.799466 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:07:44.800464 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:07:44.809462 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:07:44.809462 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:07:44.810467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:44.843978 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:07:44.844978 [debug] [ThreadPool]: On list_projeto: Close
[0m23:07:44.846980 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:07:44.850982 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:07:44.851984 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:07:44.851984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:44.879978 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:07:44.880978 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:07:44.880978 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:07:44.883978 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m23:07:44.884979 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:07:44.884979 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:07:44.889978 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:44.889978 [debug] [MainThread]: On master: BEGIN
[0m23:07:44.889978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:07:44.922895 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:07:44.922895 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:44.922895 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:07:44.927416 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m23:07:44.928415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd76191ba-c72e-4432-9aac-5036c447c229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001954D6CB210>]}
[0m23:07:44.928415 [debug] [MainThread]: On master: ROLLBACK
[0m23:07:44.928415 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:44.929413 [debug] [MainThread]: On master: BEGIN
[0m23:07:44.929413 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:07:44.929413 [debug] [MainThread]: On master: COMMIT
[0m23:07:44.930410 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:44.930410 [debug] [MainThread]: On master: COMMIT
[0m23:07:44.930410 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:07:44.930410 [debug] [MainThread]: On master: Close
[0m23:07:44.931411 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:07:44.932413 [info ] [MainThread]: 
[0m23:07:44.935973 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:07:44.935973 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:07:44.936422 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:07:44.936422 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:07:44.937433 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:07:44.937433 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:07:44.937433 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:07:44.938435 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:07:44.940434 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:07:44.941434 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:07:44.941434 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:07:44.938435 => 2023-03-30 23:07:44.941434
[0m23:07:44.942434 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:07:44.940434 => 2023-03-30 23:07:44.942434
[0m23:07:44.942434 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:07:44.942434 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:07:44.971432 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:07:44.975433 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:07:44.975433 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:07:44.976433 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:07:44.976433 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:07:44.976433 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:07:44.976433 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:07:44.977434 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:07:45.008436 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:07:45.008436 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:07:45.009433 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:07:45.009433 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:07:45.009433 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:07:45.009433 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    SELECT order_id,
	walmart.order_state,
	walmart.state
FROM walmart
  );
[0m23:07:45.010439 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column walmart.order_state does not exist
LINE 5:  walmart.order_state,
         ^
HINT:  Perhaps you meant to reference the column "walmart.order_date".

[0m23:07:45.010439 [debug] [Thread-2 (]: On model.projeto_final.view_1: ROLLBACK
[0m23:07:45.011440 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:07:44.972432 => 2023-03-30 23:07:45.011440
[0m23:07:45.011440 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:07:45.011440 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:07:45.016439 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:07:45.017439 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:07:45.018439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:07:45.020439 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:07:45.021438 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:07:45.021438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:07:45.035890 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:07:45.036890 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:07:45.036890 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:07:45.038892 [debug] [Thread-2 (]: Database Error in model view_1 (models\view_1.sql)
  column walmart.order_state does not exist
  LINE 5:  walmart.order_state,
           ^
  HINT:  Perhaps you meant to reference the column "walmart.order_date".
  compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:07:45.038892 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:07:45.038892 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd76191ba-c72e-4432-9aac-5036c447c229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001954DEE4DD0>]}
[0m23:07:45.042899 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:07:45.043892 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model public.view_1 ............................. [[31mERROR[0m in 0.10s]
[0m23:07:45.043892 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:07:45.044892 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:07:45.046902 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:07:45.047892 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:07:44.942434 => 2023-03-30 23:07:45.047892
[0m23:07:45.047892 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:07:45.047892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd76191ba-c72e-4432-9aac-5036c447c229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001954D7A1390>]}
[0m23:07:45.048893 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m23:07:45.048893 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:07:45.050893 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:07:45.050893 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:45.050893 [debug] [MainThread]: On master: BEGIN
[0m23:07:45.050893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:07:45.080792 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:07:45.080792 [debug] [MainThread]: On master: COMMIT
[0m23:07:45.080792 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:45.081820 [debug] [MainThread]: On master: COMMIT
[0m23:07:45.081820 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:07:45.081820 [debug] [MainThread]: On master: Close
[0m23:07:45.082816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:45.082816 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:07:45.082816 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:07:45.082816 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:07:45.083808 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:07:45.083808 [info ] [MainThread]: 
[0m23:07:45.083808 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m23:07:45.084806 [debug] [MainThread]: Command end result
[0m23:07:45.088806 [info ] [MainThread]: 
[0m23:07:45.088806 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:07:45.089813 [info ] [MainThread]: 
[0m23:07:45.089813 [error] [MainThread]: [33mDatabase Error in model view_1 (models\view_1.sql)[0m
[0m23:07:45.090809 [error] [MainThread]:   column walmart.order_state does not exist
[0m23:07:45.090809 [error] [MainThread]:   LINE 5:  walmart.order_state,
[0m23:07:45.090809 [error] [MainThread]:            ^
[0m23:07:45.091811 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "walmart.order_date".
[0m23:07:45.091811 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:07:45.091811 [info ] [MainThread]: 
[0m23:07:45.091811 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m23:07:45.092811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001954DC7E6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001954D4D16D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001954E047690>]}
[0m23:07:45.092811 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:08:30.863428 | 38fb1931-66a9-40e5-bf10-4a0a81d2fba8 ==============================
[0m23:08:30.863428 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:08:30.865069 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m23:08:30.865069 [debug] [MainThread]: Tracking: tracking
[0m23:08:30.874084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC7C0C350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC5054BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC81074D0>]}
[0m23:08:30.882083 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:08:30.916083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:08:30.917085 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m23:08:30.928084 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:08:30.941083 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m23:08:30.945087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38fb1931-66a9-40e5-bf10-4a0a81d2fba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC80F9D10>]}
[0m23:08:30.950087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38fb1931-66a9-40e5-bf10-4a0a81d2fba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC8407B50>]}
[0m23:08:30.950087 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:08:30.950087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38fb1931-66a9-40e5-bf10-4a0a81d2fba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC81C4990>]}
[0m23:08:30.952089 [info ] [MainThread]: 
[0m23:08:30.953090 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:08:30.955088 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:08:30.963598 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:08:30.963598 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:08:30.963598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:31.097230 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:08:31.098229 [debug] [ThreadPool]: On list_projeto: Close
[0m23:08:31.100230 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:08:31.105227 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:08:31.106227 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:08:31.106227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:31.135231 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:08:31.135231 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:08:31.136228 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:08:31.138225 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m23:08:31.139228 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:08:31.139228 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:08:31.144228 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:31.145229 [debug] [MainThread]: On master: BEGIN
[0m23:08:31.145229 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:08:31.174345 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:08:31.174345 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:31.174345 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:08:31.178347 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m23:08:31.179345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38fb1931-66a9-40e5-bf10-4a0a81d2fba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC81D27D0>]}
[0m23:08:31.179345 [debug] [MainThread]: On master: ROLLBACK
[0m23:08:31.179345 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:31.180345 [debug] [MainThread]: On master: BEGIN
[0m23:08:31.180345 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:08:31.180345 [debug] [MainThread]: On master: COMMIT
[0m23:08:31.181349 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:31.181349 [debug] [MainThread]: On master: COMMIT
[0m23:08:31.181349 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:08:31.181349 [debug] [MainThread]: On master: Close
[0m23:08:31.182348 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:08:31.182348 [info ] [MainThread]: 
[0m23:08:31.186347 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:08:31.186347 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:08:31.187345 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:08:31.187345 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:08:31.188345 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:08:31.188345 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:08:31.188345 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:08:31.189346 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:08:31.191345 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:08:31.192344 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:08:31.192344 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:08:31.189346 => 2023-03-30 23:08:31.192344
[0m23:08:31.193346 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:08:31.191345 => 2023-03-30 23:08:31.193346
[0m23:08:31.193346 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:08:31.193346 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:08:31.223349 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:08:31.226348 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:08:31.227357 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:08:31.227357 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:08:31.227357 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:08:31.227357 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:08:31.228345 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:08:31.228345 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:08:31.259857 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:08:31.259857 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:08:31.260858 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:08:31.260858 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:08:31.261859 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:08:31.261859 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    SELECT walmart.order_id,
	walmart.order_date,
	walmart.state
FROM walmart
  );
[0m23:08:31.261859 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:08:31.266859 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:08:31.267859 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:08:31.267859 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:08:31.269858 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:08:31.269858 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:08:31.270859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:08:31.271861 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:08:31.272859 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:08:31.272859 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:08:31.285858 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:08:31.285858 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:08:31.285858 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:08:31.286860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:08:31.289861 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:08:31.289861 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:08:31.289861 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:08:31.293860 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:08:31.293860 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:08:31.294859 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:08:31.294859 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:08:31.294859 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:08:31.295859 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:08:31.223349 => 2023-03-30 23:08:31.295859
[0m23:08:31.297860 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:08:31.297860 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:08:31.297860 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:08:31.298861 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38fb1931-66a9-40e5-bf10-4a0a81d2fba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC8520B90>]}
[0m23:08:31.298861 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.11s]
[0m23:08:31.300859 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:08:31.301861 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:08:31.302860 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:08:31.193346 => 2023-03-30 23:08:31.302860
[0m23:08:31.302860 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:08:31.303862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38fb1931-66a9-40e5-bf10-4a0a81d2fba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC78F3510>]}
[0m23:08:31.303862 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m23:08:31.304865 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:08:31.305863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:08:31.305863 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:31.305863 [debug] [MainThread]: On master: BEGIN
[0m23:08:31.305863 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:08:31.335860 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:08:31.335860 [debug] [MainThread]: On master: COMMIT
[0m23:08:31.336859 [debug] [MainThread]: Using postgres connection "master"
[0m23:08:31.336859 [debug] [MainThread]: On master: COMMIT
[0m23:08:31.336859 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:08:31.336859 [debug] [MainThread]: On master: Close
[0m23:08:31.337865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:31.337865 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:08:31.337865 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:08:31.338863 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:08:31.338863 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:08:31.338863 [info ] [MainThread]: 
[0m23:08:31.338863 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m23:08:31.339859 [debug] [MainThread]: Command end result
[0m23:08:31.343863 [info ] [MainThread]: 
[0m23:08:31.344866 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:08:31.344866 [info ] [MainThread]: 
[0m23:08:31.344866 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:08:31.345863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC81C5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC84C5210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC7939210>]}
[0m23:08:31.345863 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:10:59.918074 | 04197b32-4df5-4b05-bf07-fea2fd70969d ==============================
[0m23:10:59.918074 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:10:59.919074 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:10:59.919074 [debug] [MainThread]: Tracking: tracking
[0m23:10:59.928125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D76CA0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D7624810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D70BF950>]}
[0m23:10:59.935632 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:10:59.970424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:10:59.970424 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m23:10:59.980933 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:10:59.993955 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m23:10:59.997954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04197b32-4df5-4b05-bf07-fea2fd70969d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D794D110>]}
[0m23:11:00.003468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04197b32-4df5-4b05-bf07-fea2fd70969d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D711E690>]}
[0m23:11:00.003468 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:11:00.004476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04197b32-4df5-4b05-bf07-fea2fd70969d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D7193250>]}
[0m23:11:00.005473 [info ] [MainThread]: 
[0m23:11:00.007474 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:11:00.008475 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:11:00.017983 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:11:00.017983 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:11:00.017983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:00.050352 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:11:00.051866 [debug] [ThreadPool]: On list_projeto: Close
[0m23:11:00.052867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:11:00.057097 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:11:00.058095 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:11:00.058095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:00.195353 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:11:00.195353 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:11:00.195353 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:11:00.198357 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m23:11:00.199353 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:11:00.199353 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:11:00.204867 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:00.204867 [debug] [MainThread]: On master: BEGIN
[0m23:11:00.204867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:11:00.234257 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:11:00.235263 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:00.235263 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:11:00.238264 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m23:11:00.240264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04197b32-4df5-4b05-bf07-fea2fd70969d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D7109B50>]}
[0m23:11:00.240264 [debug] [MainThread]: On master: ROLLBACK
[0m23:11:00.241264 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:00.241264 [debug] [MainThread]: On master: BEGIN
[0m23:11:00.241264 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:11:00.241264 [debug] [MainThread]: On master: COMMIT
[0m23:11:00.241264 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:00.241264 [debug] [MainThread]: On master: COMMIT
[0m23:11:00.242769 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:11:00.242769 [debug] [MainThread]: On master: Close
[0m23:11:00.243776 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:11:00.243776 [info ] [MainThread]: 
[0m23:11:00.247300 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:11:00.247300 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:11:00.248157 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:11:00.248157 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:11:00.249168 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:11:00.249168 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:11:00.249168 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:11:00.250169 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:11:00.251318 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:11:00.252823 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:11:00.253829 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:11:00.250169 => 2023-03-30 23:11:00.253829
[0m23:11:00.253829 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:11:00.251318 => 2023-03-30 23:11:00.253829
[0m23:11:00.253829 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:11:00.254828 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:11:00.282856 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:11:00.286943 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:11:00.286943 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:00.287941 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:11:00.287941 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:11:00.287941 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:11:00.287941 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:11:00.288939 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:11:00.320490 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:11:00.320490 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:00.321490 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:11:00.322997 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:11:00.328012 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:00.328012 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:11:00.329014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:11:00.331013 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:00.331013 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:11:00.331013 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:11:00.346053 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:11:00.346053 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:00.347053 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:11:00.347662 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:11:00.351186 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:00.351186 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:11:00.352692 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:11:00.352692 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:11:00.254828 => 2023-03-30 23:11:00.352692
[0m23:11:00.353699 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:11:00.353699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04197b32-4df5-4b05-bf07-fea2fd70969d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D7926990>]}
[0m23:11:00.354698 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m23:11:00.355697 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:11:00.431259 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:11:00.431259 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:11:00.431259 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	walmart.order_date,
	walmart.state
from walmart
where walmart.state == 'California' and
walmart.order_id is not null
  );
[0m23:11:00.432771 [debug] [Thread-2 (]: Postgres adapter: Postgres error: operator does not exist: text == unknown
LINE 8: where walmart.state == 'California' and
                            ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m23:11:00.432771 [debug] [Thread-2 (]: On model.projeto_final.view_1: ROLLBACK
[0m23:11:00.432771 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:11:00.283939 => 2023-03-30 23:11:00.432771
[0m23:11:00.432771 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:11:00.436782 [debug] [Thread-2 (]: Database Error in model view_1 (models\view_1.sql)
  operator does not exist: text == unknown
  LINE 8: where walmart.state == 'California' and
                              ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:11:00.436782 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04197b32-4df5-4b05-bf07-fea2fd70969d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D79BC650>]}
[0m23:11:00.437782 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model public.view_1 ............................. [[31mERROR[0m in 0.19s]
[0m23:11:00.437782 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:11:00.438778 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:11:00.439777 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:00.439777 [debug] [MainThread]: On master: BEGIN
[0m23:11:00.439777 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:11:00.468832 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:11:00.469830 [debug] [MainThread]: On master: COMMIT
[0m23:11:00.469830 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:00.469830 [debug] [MainThread]: On master: COMMIT
[0m23:11:00.470831 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:11:00.470831 [debug] [MainThread]: On master: Close
[0m23:11:00.471831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:00.471831 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:11:00.471831 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:11:00.471831 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:11:00.471831 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:11:00.472832 [info ] [MainThread]: 
[0m23:11:00.472832 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m23:11:00.472832 [debug] [MainThread]: Command end result
[0m23:11:00.477974 [info ] [MainThread]: 
[0m23:11:00.477974 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:11:00.478972 [info ] [MainThread]: 
[0m23:11:00.478972 [error] [MainThread]: [33mDatabase Error in model view_1 (models\view_1.sql)[0m
[0m23:11:00.478972 [error] [MainThread]:   operator does not exist: text == unknown
[0m23:11:00.479970 [error] [MainThread]:   LINE 8: where walmart.state == 'California' and
[0m23:11:00.479970 [error] [MainThread]:                               ^
[0m23:11:00.480971 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m23:11:00.480971 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:11:00.480971 [info ] [MainThread]: 
[0m23:11:00.480971 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m23:11:00.481972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D7A30150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D4616690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D6E81150>]}
[0m23:11:00.481972 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:11:09.223381 | 7c24cc0c-7694-40cc-8d36-efac5fcdd68b ==============================
[0m23:11:09.223381 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:11:09.225385 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:11:09.225385 [debug] [MainThread]: Tracking: tracking
[0m23:11:09.233893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0C46815D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0C41DC3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0C4718250>]}
[0m23:11:09.241893 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:11:09.275438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:11:09.275438 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m23:11:09.285947 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:11:09.298456 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m23:11:09.302961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c24cc0c-7694-40cc-8d36-efac5fcdd68b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0C3EBB690>]}
[0m23:11:09.306965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c24cc0c-7694-40cc-8d36-efac5fcdd68b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0C49FBFD0>]}
[0m23:11:09.306965 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:11:09.307965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c24cc0c-7694-40cc-8d36-efac5fcdd68b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0C3EAE590>]}
[0m23:11:09.308965 [info ] [MainThread]: 
[0m23:11:09.309966 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:11:09.311965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:11:09.319475 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:11:09.320475 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:11:09.320475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:09.353017 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:11:09.353522 [debug] [ThreadPool]: On list_projeto: Close
[0m23:11:09.355527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:11:09.360037 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:11:09.360037 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:11:09.360037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:09.494630 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:11:09.495623 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:11:09.495623 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:11:09.497627 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m23:11:09.499624 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:11:09.499624 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:11:09.505133 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:09.505133 [debug] [MainThread]: On master: BEGIN
[0m23:11:09.505133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:11:09.533684 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:11:09.534689 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:09.534689 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:11:09.537693 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m23:11:09.538690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c24cc0c-7694-40cc-8d36-efac5fcdd68b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0C3ED0190>]}
[0m23:11:09.539688 [debug] [MainThread]: On master: ROLLBACK
[0m23:11:09.539688 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:09.539688 [debug] [MainThread]: On master: BEGIN
[0m23:11:09.540691 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:11:09.540691 [debug] [MainThread]: On master: COMMIT
[0m23:11:09.540691 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:09.541689 [debug] [MainThread]: On master: COMMIT
[0m23:11:09.541689 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:11:09.541689 [debug] [MainThread]: On master: Close
[0m23:11:09.541689 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:11:09.543197 [info ] [MainThread]: 
[0m23:11:09.546914 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:11:09.546914 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:11:09.547345 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:11:09.547345 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:11:09.548356 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:11:09.548356 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:11:09.548356 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:11:09.549357 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:11:09.551358 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:11:09.552864 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:11:09.552864 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:11:09.549357 => 2023-03-30 23:11:09.552864
[0m23:11:09.552864 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:11:09.551358 => 2023-03-30 23:11:09.552864
[0m23:11:09.553870 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:11:09.553870 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:11:09.583924 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:11:09.586925 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:11:09.587924 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:09.587924 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:11:09.588925 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:11:09.588925 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:11:09.588925 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:11:09.588925 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:11:09.621031 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:11:09.621031 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:11:09.621031 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:11:09.621031 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	walmart.order_date,
	walmart.state
from walmart
where walmart.state = 'California' and
walmart.order_id is not null
  );
[0m23:11:09.622027 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:09.622027 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:11:09.623542 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:11:09.623542 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:11:09.628547 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:11:09.630549 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:09.630549 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:11:09.630549 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:11:09.631550 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:11:09.631550 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:11:09.633054 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:11:09.635063 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:09.636061 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:11:09.636061 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:11:09.636061 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:11:09.636061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:11:09.651127 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:11:09.652127 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:11:09.653126 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:11:09.653126 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:09.653126 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:11:09.653126 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:11:09.654575 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:11:09.654575 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:11:09.658093 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:11:09.660097 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:09.660097 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:11:09.660097 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:11:09.661098 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:11:09.661098 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:11:09.662102 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:11:09.583924 => 2023-03-30 23:11:09.662102
[0m23:11:09.663603 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:11:09.553870 => 2023-03-30 23:11:09.663603
[0m23:11:09.663603 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:11:09.663603 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:11:09.664609 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c24cc0c-7694-40cc-8d36-efac5fcdd68b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0C4A2C7D0>]}
[0m23:11:09.665609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c24cc0c-7694-40cc-8d36-efac5fcdd68b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0C425DA90>]}
[0m23:11:09.665609 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.12s]
[0m23:11:09.665609 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m23:11:09.667935 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:11:09.667935 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:11:09.668937 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:11:09.669937 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:09.669937 [debug] [MainThread]: On master: BEGIN
[0m23:11:09.669937 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:11:09.698467 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:11:09.698467 [debug] [MainThread]: On master: COMMIT
[0m23:11:09.699466 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:09.699466 [debug] [MainThread]: On master: COMMIT
[0m23:11:09.699466 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:11:09.700467 [debug] [MainThread]: On master: Close
[0m23:11:09.700467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:09.700467 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:11:09.701467 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:11:09.701467 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:11:09.701467 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:11:09.701467 [info ] [MainThread]: 
[0m23:11:09.701467 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m23:11:09.701467 [debug] [MainThread]: Command end result
[0m23:11:09.706976 [info ] [MainThread]: 
[0m23:11:09.707977 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:11:09.707977 [info ] [MainThread]: 
[0m23:11:09.708977 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:11:09.708977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0C3ED36D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0C4764C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0C3EAF090>]}
[0m23:11:09.708977 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:11:58.835318 | 725ebe9f-a7fa-4072-bbc1-94d9f75f19a0 ==============================
[0m23:11:58.835318 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:11:58.837060 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:11:58.837060 [debug] [MainThread]: Tracking: tracking
[0m23:11:58.845587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B871062FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B870DFB010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87106A1D0>]}
[0m23:11:58.853585 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:11:58.886669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:11:58.887669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:11:58.887669 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m23:11:58.893581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '725ebe9f-a7fa-4072-bbc1-94d9f75f19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B870B81D50>]}
[0m23:11:58.897093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '725ebe9f-a7fa-4072-bbc1-94d9f75f19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B871144350>]}
[0m23:11:58.898094 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:11:58.898094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '725ebe9f-a7fa-4072-bbc1-94d9f75f19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B871062910>]}
[0m23:11:58.899093 [info ] [MainThread]: 
[0m23:11:58.901092 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:11:58.902096 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:11:58.910616 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:11:58.911618 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:11:58.911618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:58.946690 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:11:58.947688 [debug] [ThreadPool]: On list_projeto: Close
[0m23:11:58.949689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:11:58.954188 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:11:58.954188 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:11:58.954188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:58.982721 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:11:58.984225 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:11:58.984225 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:11:58.987231 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m23:11:58.988232 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:11:58.988232 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:11:58.993230 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:58.993230 [debug] [MainThread]: On master: BEGIN
[0m23:11:58.993230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:11:59.022760 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:11:59.022760 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:59.022760 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:11:59.026279 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m23:11:59.027276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '725ebe9f-a7fa-4072-bbc1-94d9f75f19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87110F7D0>]}
[0m23:11:59.028275 [debug] [MainThread]: On master: ROLLBACK
[0m23:11:59.028275 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:59.028275 [debug] [MainThread]: On master: BEGIN
[0m23:11:59.029276 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:11:59.029276 [debug] [MainThread]: On master: COMMIT
[0m23:11:59.029276 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:59.029276 [debug] [MainThread]: On master: COMMIT
[0m23:11:59.030273 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:11:59.030273 [debug] [MainThread]: On master: Close
[0m23:11:59.030273 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:11:59.031277 [info ] [MainThread]: 
[0m23:11:59.034274 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:11:59.034274 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:11:59.035516 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:11:59.035516 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:11:59.036516 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:11:59.036516 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:11:59.036516 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:11:59.037516 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:11:59.039517 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:11:59.040516 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:11:59.040516 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:11:59.037516 => 2023-03-30 23:11:59.040516
[0m23:11:59.041526 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:11:59.041526 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:11:59.039517 => 2023-03-30 23:11:59.041526
[0m23:11:59.069590 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:11:59.070590 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:11:59.074211 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:11:59.074211 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:59.074211 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:11:59.075231 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:11:59.075231 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:11:59.075231 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:11:59.076220 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:11:59.108522 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:11:59.108522 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:11:59.109522 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	walmart.order_date,
	walmart.state
from walmart
where walmart.state = 'California' and
walmart.order_id is not null
  );
[0m23:11:59.110521 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:11:59.116032 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:11:59.116032 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:11:59.116032 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:11:59.128548 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:11:59.129549 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:11:59.129549 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:11:59.130548 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:11:59.134551 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:11:59.134551 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:11:59.135055 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:11:59.136059 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:11:59.070590 => 2023-03-30 23:11:59.136059
[0m23:11:59.136059 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:11:59.137062 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '725ebe9f-a7fa-4072-bbc1-94d9f75f19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B871386C90>]}
[0m23:11:59.137062 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.10s]
[0m23:11:59.139064 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:11:59.219525 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:11:59.219525 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:59.219525 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:11:59.222102 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:11:59.223105 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:59.223105 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:11:59.224976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:11:59.225995 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:59.226998 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:11:59.226998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:11:59.231983 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:11:59.231983 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:59.231983 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:11:59.231983 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:11:59.232984 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:11:59.232984 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:11:59.235495 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:11:59.235495 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:11:59.041526 => 2023-03-30 23:11:59.235495
[0m23:11:59.236496 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:11:59.236496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '725ebe9f-a7fa-4072-bbc1-94d9f75f19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8713FBA50>]}
[0m23:11:59.237495 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.20s]
[0m23:11:59.237495 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:11:59.238499 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:11:59.239494 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:59.239494 [debug] [MainThread]: On master: BEGIN
[0m23:11:59.239494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:11:59.268032 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:11:59.269033 [debug] [MainThread]: On master: COMMIT
[0m23:11:59.269033 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:59.269033 [debug] [MainThread]: On master: COMMIT
[0m23:11:59.270033 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:11:59.270033 [debug] [MainThread]: On master: Close
[0m23:11:59.270033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:59.270033 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:11:59.270033 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:11:59.270033 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:11:59.271539 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:11:59.271539 [info ] [MainThread]: 
[0m23:11:59.271539 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m23:11:59.272545 [debug] [MainThread]: Command end result
[0m23:11:59.277057 [info ] [MainThread]: 
[0m23:11:59.277057 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:11:59.278056 [info ] [MainThread]: 
[0m23:11:59.278056 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:11:59.278056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B86A77CBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8714457D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B871444190>]}
[0m23:11:59.279056 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:12:11.674680 | 96e71b91-353d-4c62-a272-9d81decc258c ==============================
[0m23:12:11.674680 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:12:11.675687 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m23:12:11.676690 [debug] [MainThread]: Tracking: tracking
[0m23:12:11.685717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182ED6D26D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EDE2AC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EDE7D510>]}
[0m23:12:11.692716 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:12:11.726353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:12:11.726353 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:12:11.727355 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m23:12:11.732354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96e71b91-353d-4c62-a272-9d81decc258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EDA53F10>]}
[0m23:12:11.736876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96e71b91-353d-4c62-a272-9d81decc258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EDF54690>]}
[0m23:12:11.737873 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:12:11.737873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96e71b91-353d-4c62-a272-9d81decc258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EB1F95D0>]}
[0m23:12:11.738870 [info ] [MainThread]: 
[0m23:12:11.740868 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:12:11.741873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:12:11.751396 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:12:11.751396 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:12:11.751396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:11.783455 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:12:11.783455 [debug] [ThreadPool]: On list_projeto: Close
[0m23:12:11.785975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:12:11.789968 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:12:11.790968 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:12:11.790968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:11.819526 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:12:11.819526 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:12:11.820522 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:12:11.822526 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m23:12:11.823524 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:12:11.824521 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:12:11.829045 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:11.830044 [debug] [MainThread]: On master: BEGIN
[0m23:12:11.830044 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:12:11.859509 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:12:11.859509 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:11.859509 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:12:11.863537 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m23:12:11.864537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96e71b91-353d-4c62-a272-9d81decc258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EDF90790>]}
[0m23:12:11.865059 [debug] [MainThread]: On master: ROLLBACK
[0m23:12:11.865059 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:11.865059 [debug] [MainThread]: On master: BEGIN
[0m23:12:11.866072 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:12:11.866072 [debug] [MainThread]: On master: COMMIT
[0m23:12:11.866072 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:11.867070 [debug] [MainThread]: On master: COMMIT
[0m23:12:11.867070 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:12:11.867070 [debug] [MainThread]: On master: Close
[0m23:12:11.868067 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:12:11.868067 [info ] [MainThread]: 
[0m23:12:11.872064 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:12:11.872064 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:12:11.872064 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:12:11.873066 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:12:11.873066 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:12:11.873066 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:12:11.874571 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:12:11.874571 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:12:11.876577 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:12:11.877576 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:12:11.878576 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:12:11.874571 => 2023-03-30 23:12:11.878576
[0m23:12:11.878576 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:12:11.876577 => 2023-03-30 23:12:11.878576
[0m23:12:11.878576 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:12:11.878576 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:12:11.907618 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:12:11.910618 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:12:11.911672 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:12:11.911672 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:12:11.912698 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:12:11.912698 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:12:11.912698 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:12:11.912698 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:12:11.944739 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:12:11.944739 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:12:11.944739 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:12:11.944739 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:12:11.945747 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:12:11.945747 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	walmart.order_date,
	walmart.state
from walmart
where walmart.state = 'California' and
walmart.order_id is not null
  );
[0m23:12:11.946748 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:12:11.947745 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:12:11.951745 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:12:11.953745 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:12:11.954746 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:12:11.954746 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:12:11.954746 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:12:11.955842 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:12:11.956838 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:12:11.958840 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:12:11.958840 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:12:11.959839 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:12:11.959839 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:12:11.959839 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:12:11.974861 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:12:11.975869 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:12:11.975869 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:12:11.976874 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:12:11.976874 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:12:11.976874 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:12:11.977876 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:12:11.977876 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:12:11.983388 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:12:11.984893 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:12:11.984893 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:12:11.984893 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:12:11.985901 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:12:11.986901 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:12:11.987899 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:12:11.907618 => 2023-03-30 23:12:11.986901
[0m23:12:11.987899 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:12:11.878576 => 2023-03-30 23:12:11.987899
[0m23:12:11.988902 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:12:11.988902 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:12:11.989900 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e71b91-353d-4c62-a272-9d81decc258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EE2A2D90>]}
[0m23:12:11.989900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e71b91-353d-4c62-a272-9d81decc258c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EE2A4B50>]}
[0m23:12:11.990899 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.12s]
[0m23:12:11.990899 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m23:12:11.992900 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:12:11.992900 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:12:11.993899 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:12:11.994904 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:11.994904 [debug] [MainThread]: On master: BEGIN
[0m23:12:11.995417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:12:12.024459 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:12:12.024459 [debug] [MainThread]: On master: COMMIT
[0m23:12:12.024964 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:12.024964 [debug] [MainThread]: On master: COMMIT
[0m23:12:12.024964 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:12:12.025974 [debug] [MainThread]: On master: Close
[0m23:12:12.025974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:12.025974 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:12:12.026974 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:12:12.026974 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:12:12.026974 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:12:12.026974 [info ] [MainThread]: 
[0m23:12:12.027970 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m23:12:12.027970 [debug] [MainThread]: Command end result
[0m23:12:12.032974 [info ] [MainThread]: 
[0m23:12:12.032974 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:12:12.032974 [info ] [MainThread]: 
[0m23:12:12.034478 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:12:12.034478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182ED6A9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182ED6AAA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182ED6AB390>]}
[0m23:12:12.035484 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:12:32.600268 | 15980595-6c83-4bcf-9bc1-f3a798580611 ==============================
[0m23:12:32.600268 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:12:32.601269 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:12:32.602268 [debug] [MainThread]: Tracking: tracking
[0m23:12:32.610784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118049B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211FFC6BA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211804EAE50>]}
[0m23:12:32.619295 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:12:32.659501 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:12:32.659501 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:12:32.660499 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m23:12:32.666012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15980595-6c83-4bcf-9bc1-f3a798580611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211FFBBC0D0>]}
[0m23:12:32.670767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15980595-6c83-4bcf-9bc1-f3a798580611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211805B4550>]}
[0m23:12:32.670767 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:12:32.671774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15980595-6c83-4bcf-9bc1-f3a798580611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211FC263ED0>]}
[0m23:12:32.672775 [info ] [MainThread]: 
[0m23:12:32.673776 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:12:32.675346 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:12:32.684288 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:12:32.684288 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:12:32.685291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:32.717462 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:12:32.718461 [debug] [ThreadPool]: On list_projeto: Close
[0m23:12:32.720463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:12:32.724461 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:12:32.725461 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:12:32.725461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:32.754083 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:12:32.754083 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:12:32.754083 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:12:32.756596 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m23:12:32.757597 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:12:32.758597 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:12:32.763601 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:32.763601 [debug] [MainThread]: On master: BEGIN
[0m23:12:32.763601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:12:32.791633 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:12:32.792637 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:32.792637 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:12:32.796151 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m23:12:32.797151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15980595-6c83-4bcf-9bc1-f3a798580611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211807F3C50>]}
[0m23:12:32.798151 [debug] [MainThread]: On master: ROLLBACK
[0m23:12:32.798151 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:32.798151 [debug] [MainThread]: On master: BEGIN
[0m23:12:32.799151 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:12:32.799151 [debug] [MainThread]: On master: COMMIT
[0m23:12:32.799151 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:32.799151 [debug] [MainThread]: On master: COMMIT
[0m23:12:32.800151 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:12:32.800151 [debug] [MainThread]: On master: Close
[0m23:12:32.800151 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:12:32.801152 [info ] [MainThread]: 
[0m23:12:32.805150 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:12:32.805150 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:12:32.805150 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:12:32.805150 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:12:32.806330 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:12:32.806330 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:12:32.807329 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:12:32.807329 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:12:32.809328 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:12:32.810330 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:12:32.811329 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:12:32.807329 => 2023-03-30 23:12:32.811329
[0m23:12:32.811329 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:12:32.809328 => 2023-03-30 23:12:32.811329
[0m23:12:32.811329 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:12:32.811329 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:12:32.840857 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:12:32.843857 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:12:32.843857 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:12:32.843857 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:12:32.845361 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:12:32.845361 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:12:32.845361 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:12:32.845361 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:12:32.876904 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:12:32.876904 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:12:32.876904 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	walmart.order_date,
	walmart.state
from walmart
where walmart.state = 'California' and
walmart.order_id is not null
  );
[0m23:12:32.877905 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:12:32.877905 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:12:32.878904 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:12:32.878904 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:12:32.883903 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:12:32.883903 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:12:32.883903 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:12:32.886414 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:12:32.886414 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:12:32.887417 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:12:32.887417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:12:32.899432 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:12:32.901433 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:12:32.902432 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:12:32.902432 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:12:32.902432 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:12:32.903448 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:12:32.903448 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:12:32.906952 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:12:32.910949 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:12:32.911950 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:12:32.911950 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:12:32.911950 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:12:32.912949 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:12:32.913949 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:12:32.840857 => 2023-03-30 23:12:32.913949
[0m23:12:32.913949 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:12:32.913949 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:12:32.915455 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:12:32.916461 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15980595-6c83-4bcf-9bc1-f3a798580611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211808FD0D0>]}
[0m23:12:32.916461 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:12:32.916461 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.11s]
[0m23:12:32.918462 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:12:32.918462 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:12:32.920463 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:12:32.812330 => 2023-03-30 23:12:32.920463
[0m23:12:32.920463 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:12:32.920463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15980595-6c83-4bcf-9bc1-f3a798580611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211808FA350>]}
[0m23:12:32.921463 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m23:12:32.921463 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:12:32.922462 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:12:32.923462 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:32.923462 [debug] [MainThread]: On master: BEGIN
[0m23:12:32.923462 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:12:32.953019 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:12:32.954018 [debug] [MainThread]: On master: COMMIT
[0m23:12:32.954018 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:32.954018 [debug] [MainThread]: On master: COMMIT
[0m23:12:32.955021 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:12:32.955021 [debug] [MainThread]: On master: Close
[0m23:12:32.955527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:32.955527 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:12:32.955527 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:12:32.955527 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:12:32.956533 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:12:32.956533 [info ] [MainThread]: 
[0m23:12:32.956533 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m23:12:32.957534 [debug] [MainThread]: Command end result
[0m23:12:32.961533 [info ] [MainThread]: 
[0m23:12:32.961533 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:12:32.962537 [info ] [MainThread]: 
[0m23:12:32.962537 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:12:32.963536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211800B3A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211FF815190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211FF815650>]}
[0m23:12:32.963536 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:16:28.988257 | 3a353e51-4ac3-4714-b4af-9a7c133c45f5 ==============================
[0m23:16:28.988257 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:16:28.990257 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:16:28.990257 [debug] [MainThread]: Tracking: tracking
[0m23:16:28.998767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FE2BD490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FE2B95D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FB224CD0>]}
[0m23:16:29.006276 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:16:29.039802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:16:29.039802 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m23:16:29.051376 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:16:29.063857 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m23:16:29.067857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a353e51-4ac3-4714-b4af-9a7c133c45f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FDDE1610>]}
[0m23:16:29.071361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a353e51-4ac3-4714-b4af-9a7c133c45f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FE37CE10>]}
[0m23:16:29.072365 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:16:29.072365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a353e51-4ac3-4714-b4af-9a7c133c45f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FE373150>]}
[0m23:16:29.073369 [info ] [MainThread]: 
[0m23:16:29.075369 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:16:29.076369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:16:29.084879 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:16:29.084879 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:16:29.084879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:29.116405 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:16:29.118405 [debug] [ThreadPool]: On list_projeto: Close
[0m23:16:29.119412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:16:29.123915 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:16:29.123915 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:16:29.123915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:29.153386 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:16:29.153386 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:16:29.153386 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:16:29.156385 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m23:16:29.157386 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:16:29.157386 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:16:29.161891 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:29.162898 [debug] [MainThread]: On master: BEGIN
[0m23:16:29.162898 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:16:29.294188 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:16:29.294188 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:29.294188 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:16:29.298186 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m23:16:29.299187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a353e51-4ac3-4714-b4af-9a7c133c45f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FDDA78D0>]}
[0m23:16:29.300188 [debug] [MainThread]: On master: ROLLBACK
[0m23:16:29.300188 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:29.300188 [debug] [MainThread]: On master: BEGIN
[0m23:16:29.300188 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:16:29.301187 [debug] [MainThread]: On master: COMMIT
[0m23:16:29.301187 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:29.301692 [debug] [MainThread]: On master: COMMIT
[0m23:16:29.301692 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:16:29.301692 [debug] [MainThread]: On master: Close
[0m23:16:29.302698 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:16:29.302698 [info ] [MainThread]: 
[0m23:16:29.306704 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:16:29.306704 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:16:29.307704 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:16:29.307704 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:16:29.308708 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:16:29.308708 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:16:29.308708 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:16:29.309707 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:16:29.311216 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:16:29.312224 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:16:29.313227 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:16:29.309707 => 2023-03-30 23:16:29.313227
[0m23:16:29.313227 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:16:29.333268 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:16:29.311216 => 2023-03-30 23:16:29.333268
[0m23:16:29.342790 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:16:29.342790 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:16:29.343787 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:16:29.346789 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:16:29.346789 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:16:29.347788 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:16:29.347788 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:16:29.348790 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:16:29.348790 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:16:29.379324 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:16:29.379324 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:16:29.380326 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:16:29.380326 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:16:29.380326 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:16:29.380326 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date),
	walmart.state
from walmart
where walmart.state = 'California' and
walmart.order_id is not null
  );
[0m23:16:29.382364 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:16:29.382364 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:16:29.387373 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:16:29.389369 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:16:29.390370 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:16:29.390370 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:16:29.390370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:16:29.391373 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:16:29.392895 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:16:29.394890 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:16:29.394890 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:16:29.394890 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:16:29.395896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:16:29.395896 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:16:29.409398 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:16:29.411914 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:16:29.411914 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:16:29.411914 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:16:29.411914 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:16:29.412924 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:16:29.412924 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:16:29.412924 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:16:29.416919 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:16:29.418923 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:16:29.418923 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:16:29.418923 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:16:29.419921 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:16:29.419921 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:16:29.421426 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:16:29.343787 => 2023-03-30 23:16:29.421426
[0m23:16:29.422437 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:16:29.313227 => 2023-03-30 23:16:29.421426
[0m23:16:29.422437 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:16:29.422437 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:16:29.423432 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a353e51-4ac3-4714-b4af-9a7c133c45f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FE6E7A50>]}
[0m23:16:29.423432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a353e51-4ac3-4714-b4af-9a7c133c45f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FE2C9250>]}
[0m23:16:29.424432 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.11s]
[0m23:16:29.424432 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m23:16:29.425432 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:16:29.426431 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:16:29.427432 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:16:29.427432 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:29.428432 [debug] [MainThread]: On master: BEGIN
[0m23:16:29.428432 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:16:29.457882 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:16:29.457882 [debug] [MainThread]: On master: COMMIT
[0m23:16:29.457882 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:29.458885 [debug] [MainThread]: On master: COMMIT
[0m23:16:29.458885 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:16:29.458885 [debug] [MainThread]: On master: Close
[0m23:16:29.459882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:16:29.459882 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:16:29.459882 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:16:29.459882 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:16:29.459882 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:16:29.459882 [info ] [MainThread]: 
[0m23:16:29.461387 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m23:16:29.461387 [debug] [MainThread]: Command end result
[0m23:16:29.465397 [info ] [MainThread]: 
[0m23:16:29.466397 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:16:29.466397 [info ] [MainThread]: 
[0m23:16:29.467398 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:16:29.467398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FE3B4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FDB02010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221FE6AA2D0>]}
[0m23:16:29.467398 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:19:56.582496 | 8442b8f6-2ab3-4604-a84c-666a3d85082e ==============================
[0m23:19:56.582496 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:19:56.584498 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:19:56.584498 [debug] [MainThread]: Tracking: tracking
[0m23:19:56.593015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB965D410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB91FFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB913E650>]}
[0m23:19:56.600524 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:19:56.637585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:19:56.638586 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m23:19:56.648612 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:19:56.662138 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m23:19:56.665137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8442b8f6-2ab3-4604-a84c-666a3d85082e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB9743390>]}
[0m23:19:56.670650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8442b8f6-2ab3-4604-a84c-666a3d85082e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB972FB50>]}
[0m23:19:56.670650 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:19:56.671650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8442b8f6-2ab3-4604-a84c-666a3d85082e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB8F90950>]}
[0m23:19:56.672649 [info ] [MainThread]: 
[0m23:19:56.673650 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:19:56.674647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:19:56.684158 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:19:56.684158 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:19:56.684158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:56.717213 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:19:56.719219 [debug] [ThreadPool]: On list_projeto: Close
[0m23:19:56.720220 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:19:56.725223 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:19:56.725223 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:19:56.725223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:56.753821 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:19:56.753821 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:19:56.754823 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:19:56.757327 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m23:19:56.758338 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:19:56.758338 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:19:56.763333 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:56.763333 [debug] [MainThread]: On master: BEGIN
[0m23:19:56.763333 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:19:56.792873 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:19:56.792873 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:56.792873 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:19:56.796872 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m23:19:56.798033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8442b8f6-2ab3-4604-a84c-666a3d85082e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB9732410>]}
[0m23:19:56.798033 [debug] [MainThread]: On master: ROLLBACK
[0m23:19:56.799040 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:56.799040 [debug] [MainThread]: On master: BEGIN
[0m23:19:56.799040 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:19:56.799040 [debug] [MainThread]: On master: COMMIT
[0m23:19:56.800039 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:56.800039 [debug] [MainThread]: On master: COMMIT
[0m23:19:56.800039 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:19:56.800039 [debug] [MainThread]: On master: Close
[0m23:19:56.801039 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:19:56.801039 [info ] [MainThread]: 
[0m23:19:56.805039 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:19:56.805039 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:19:56.805039 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:19:56.806545 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:19:56.806545 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:19:56.807551 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:19:56.807551 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:19:56.807551 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:19:56.809552 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:19:56.811557 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:19:56.811557 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:19:56.808554 => 2023-03-30 23:19:56.811557
[0m23:19:56.811557 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:19:56.810550 => 2023-03-30 23:19:56.811557
[0m23:19:56.812554 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:19:56.812554 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:19:56.841524 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:19:56.845528 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:19:56.846528 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:19:56.846528 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:19:56.847035 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:19:56.847035 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:19:56.847035 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:19:56.847035 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:19:56.879100 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:19:56.879100 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:19:56.879100 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:19:56.880102 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:19:56.880102 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:19:56.880102 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	date(walmart.ship_date) as ship_date,
	int(walmart.quantity) as quantity,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.quantity/10 and
walmart.order_id is not null
  );
[0m23:19:56.880102 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "("
LINE 7:  int(walmart.quantity) as quantity,
            ^

[0m23:19:56.881100 [debug] [Thread-2 (]: On model.projeto_final.view_1: ROLLBACK
[0m23:19:56.881100 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:19:56.842524 => 2023-03-30 23:19:56.881100
[0m23:19:56.881100 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:19:56.882104 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:19:56.888610 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:19:56.888610 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:19:56.889615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:19:56.891615 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:19:56.891615 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:19:56.892614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:19:56.906635 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:19:56.907642 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:19:56.907642 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:19:56.908644 [debug] [Thread-2 (]: Database Error in model view_1 (models\view_1.sql)
  syntax error at or near "("
  LINE 7:  int(walmart.quantity) as quantity,
              ^
  compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:19:56.909641 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:19:56.909641 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8442b8f6-2ab3-4604-a84c-666a3d85082e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB9AAB7D0>]}
[0m23:19:56.913645 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:19:56.913645 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model public.view_1 ............................. [[31mERROR[0m in 0.10s]
[0m23:19:56.914643 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:19:56.915643 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:19:56.916640 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:19:56.917894 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:19:56.812554 => 2023-03-30 23:19:56.917894
[0m23:19:56.918897 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:19:56.918897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8442b8f6-2ab3-4604-a84c-666a3d85082e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB9A33F10>]}
[0m23:19:56.919896 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m23:19:56.919896 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:19:56.920890 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:19:56.921891 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:56.921891 [debug] [MainThread]: On master: BEGIN
[0m23:19:56.921891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:19:57.062404 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:19:57.062404 [debug] [MainThread]: On master: COMMIT
[0m23:19:57.062404 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:57.063421 [debug] [MainThread]: On master: COMMIT
[0m23:19:57.063421 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:19:57.063421 [debug] [MainThread]: On master: Close
[0m23:19:57.064430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:57.064430 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:19:57.064430 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:19:57.065433 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:19:57.065433 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:19:57.065433 [info ] [MainThread]: 
[0m23:19:57.065433 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m23:19:57.066939 [debug] [MainThread]: Command end result
[0m23:19:57.070945 [info ] [MainThread]: 
[0m23:19:57.071946 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:19:57.071946 [info ] [MainThread]: 
[0m23:19:57.071946 [error] [MainThread]: [33mDatabase Error in model view_1 (models\view_1.sql)[0m
[0m23:19:57.072948 [error] [MainThread]:   syntax error at or near "("
[0m23:19:57.072948 [error] [MainThread]:   LINE 7:  int(walmart.quantity) as quantity,
[0m23:19:57.072948 [error] [MainThread]:               ^
[0m23:19:57.072948 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:19:57.073945 [info ] [MainThread]: 
[0m23:19:57.073945 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m23:19:57.073945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB9A74310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB9A74D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EB964BD10>]}
[0m23:19:57.074945 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:20:40.940552 | fda117e8-0dd7-47a1-aeef-9c2da6defa95 ==============================
[0m23:20:40.940552 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:20:40.942552 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:20:40.942552 [debug] [MainThread]: Tracking: tracking
[0m23:20:40.951068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB824A8D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB82093750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB824B9310>]}
[0m23:20:40.959578 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:20:40.992619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:20:40.992619 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m23:20:41.003126 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:20:41.015636 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m23:20:41.019564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fda117e8-0dd7-47a1-aeef-9c2da6defa95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB827B5BD0>]}
[0m23:20:41.023562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fda117e8-0dd7-47a1-aeef-9c2da6defa95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8283EA90>]}
[0m23:20:41.023562 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:20:41.024562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fda117e8-0dd7-47a1-aeef-9c2da6defa95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8254F650>]}
[0m23:20:41.025562 [info ] [MainThread]: 
[0m23:20:41.026566 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:20:41.028076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:20:41.037082 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:20:41.037082 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:20:41.037082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:41.068954 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:20:41.070954 [debug] [ThreadPool]: On list_projeto: Close
[0m23:20:41.071954 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:20:41.075954 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:20:41.076954 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:20:41.076954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:41.106029 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:20:41.106029 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:20:41.106029 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:20:41.108530 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m23:20:41.109535 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:20:41.110535 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:20:41.115534 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:41.115534 [debug] [MainThread]: On master: BEGIN
[0m23:20:41.115534 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:20:41.144073 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:20:41.144073 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:41.145074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:20:41.148576 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m23:20:41.149582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fda117e8-0dd7-47a1-aeef-9c2da6defa95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB81FE0D50>]}
[0m23:20:41.149582 [debug] [MainThread]: On master: ROLLBACK
[0m23:20:41.150582 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:41.150582 [debug] [MainThread]: On master: BEGIN
[0m23:20:41.150582 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:20:41.151581 [debug] [MainThread]: On master: COMMIT
[0m23:20:41.151581 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:41.151581 [debug] [MainThread]: On master: COMMIT
[0m23:20:41.151581 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:20:41.152581 [debug] [MainThread]: On master: Close
[0m23:20:41.152581 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:20:41.153583 [info ] [MainThread]: 
[0m23:20:41.156581 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:20:41.156581 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:20:41.156581 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:20:41.156581 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:20:41.158085 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:20:41.159091 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:20:41.159091 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:20:41.159091 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:20:41.160595 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:20:41.162600 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:20:41.162600 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:20:41.159091 => 2023-03-30 23:20:41.162600
[0m23:20:41.162600 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:20:41.161600 => 2023-03-30 23:20:41.162600
[0m23:20:41.163600 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:20:41.163600 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:20:41.192123 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:20:41.195124 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:20:41.196381 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:20:41.196381 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:20:41.196381 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:20:41.196381 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:20:41.197896 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:20:41.197896 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:20:41.230445 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:20:41.230445 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:20:41.230445 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:20:41.230445 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:20:41.231447 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	date(walmart.ship_date) as ship_date,
	integer(walmart.quantity) as quantity,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.quantity/10 and
walmart.order_id is not null
  );
[0m23:20:41.231447 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:20:41.231447 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "("
LINE 7:  integer(walmart.quantity) as quantity,
                ^

[0m23:20:41.232445 [debug] [Thread-2 (]: On model.projeto_final.view_1: ROLLBACK
[0m23:20:41.232445 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:20:41.192123 => 2023-03-30 23:20:41.232445
[0m23:20:41.232445 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:20:41.234445 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:20:41.238959 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:20:41.239966 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:20:41.239966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:20:41.241966 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:20:41.242965 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:20:41.242965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:20:41.257988 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:20:41.257988 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:20:41.258993 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:20:41.258993 [debug] [Thread-2 (]: Database Error in model view_1 (models\view_1.sql)
  syntax error at or near "("
  LINE 7:  integer(walmart.quantity) as quantity,
                  ^
  compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:20:41.260500 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fda117e8-0dd7-47a1-aeef-9c2da6defa95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8286A110>]}
[0m23:20:41.260500 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:20:41.260500 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model public.view_1 ............................. [[31mERROR[0m in 0.10s]
[0m23:20:41.264506 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:20:41.266508 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:20:41.266508 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:20:41.268015 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:20:41.269022 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:20:41.163600 => 2023-03-30 23:20:41.269022
[0m23:20:41.269022 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:20:41.270025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fda117e8-0dd7-47a1-aeef-9c2da6defa95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB824B6E10>]}
[0m23:20:41.270025 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m23:20:41.271027 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:20:41.272021 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:20:41.272021 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:41.272021 [debug] [MainThread]: On master: BEGIN
[0m23:20:41.273022 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:20:41.301217 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:20:41.302216 [debug] [MainThread]: On master: COMMIT
[0m23:20:41.302216 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:41.302216 [debug] [MainThread]: On master: COMMIT
[0m23:20:41.302216 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:20:41.303217 [debug] [MainThread]: On master: Close
[0m23:20:41.303217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:20:41.303217 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:20:41.304216 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:20:41.304216 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:20:41.304216 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:20:41.304216 [info ] [MainThread]: 
[0m23:20:41.305212 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m23:20:41.305212 [debug] [MainThread]: Command end result
[0m23:20:41.309729 [info ] [MainThread]: 
[0m23:20:41.309729 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:20:41.310724 [info ] [MainThread]: 
[0m23:20:41.310724 [error] [MainThread]: [33mDatabase Error in model view_1 (models\view_1.sql)[0m
[0m23:20:41.310724 [error] [MainThread]:   syntax error at or near "("
[0m23:20:41.311725 [error] [MainThread]:   LINE 7:  integer(walmart.quantity) as quantity,
[0m23:20:41.311725 [error] [MainThread]:                   ^
[0m23:20:41.311725 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_1.sql
[0m23:20:41.311725 [info ] [MainThread]: 
[0m23:20:41.312726 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m23:20:41.312726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB81D307D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB81FBAB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB81F73550>]}
[0m23:20:41.312726 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:20:52.006712 | 8ccbcbc3-3971-4a87-87bf-d61f2b52ea88 ==============================
[0m23:20:52.006712 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:20:52.009225 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:20:52.009225 [debug] [MainThread]: Tracking: tracking
[0m23:20:52.017225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D6CBAD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D6C72F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D6A23BD0>]}
[0m23:20:52.024740 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:20:52.058298 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:20:52.058298 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m23:20:52.069336 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:20:52.080846 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.projeto_final.staging
[0m23:20:52.085846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ccbcbc3-3971-4a87-87bf-d61f2b52ea88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D72B3390>]}
[0m23:20:52.089356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ccbcbc3-3971-4a87-87bf-d61f2b52ea88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D71BF850>]}
[0m23:20:52.090356 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:20:52.090356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ccbcbc3-3971-4a87-87bf-d61f2b52ea88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D7294D10>]}
[0m23:20:52.091357 [info ] [MainThread]: 
[0m23:20:52.093356 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:20:52.094368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:20:52.102876 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:20:52.102876 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:20:52.102876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:52.136005 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:20:52.137004 [debug] [ThreadPool]: On list_projeto: Close
[0m23:20:52.138016 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:20:52.143325 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:20:52.143325 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:20:52.143325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:52.172441 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:20:52.172441 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:20:52.172441 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:20:52.175441 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m23:20:52.176443 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:20:52.176443 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:20:52.181968 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:52.181968 [debug] [MainThread]: On master: BEGIN
[0m23:20:52.181968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:20:52.211242 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:20:52.211242 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:52.211242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:20:52.215240 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m23:20:52.216240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ccbcbc3-3971-4a87-87bf-d61f2b52ea88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D6CBAB90>]}
[0m23:20:52.216240 [debug] [MainThread]: On master: ROLLBACK
[0m23:20:52.217242 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:52.217242 [debug] [MainThread]: On master: BEGIN
[0m23:20:52.217242 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:20:52.218241 [debug] [MainThread]: On master: COMMIT
[0m23:20:52.218241 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:52.218749 [debug] [MainThread]: On master: COMMIT
[0m23:20:52.218749 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:20:52.218749 [debug] [MainThread]: On master: Close
[0m23:20:52.219757 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:20:52.219757 [info ] [MainThread]: 
[0m23:20:52.223763 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:20:52.223763 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:20:52.223763 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:20:52.224766 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:20:52.224766 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:20:52.225766 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:20:52.225766 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:20:52.225766 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:20:52.228268 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:20:52.229276 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:20:52.229276 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:20:52.225766 => 2023-03-30 23:20:52.229276
[0m23:20:52.230277 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:20:52.230277 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:20:52.228268 => 2023-03-30 23:20:52.230277
[0m23:20:52.258801 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:20:52.259808 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:20:52.262806 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:20:52.263810 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:20:52.263810 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:20:52.263810 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:20:52.263810 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:20:52.264909 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:20:52.264909 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:20:52.296465 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:20:52.296465 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:20:52.296465 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:20:52.296465 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:20:52.296465 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:20:52.297972 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	date(walmart.ship_date) as ship_date,
	walmart.quantity,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.quantity/10 and
walmart.order_id is not null
  );
[0m23:20:52.298982 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:20:52.303977 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:20:52.303977 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:20:52.303977 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:20:52.305979 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:20:52.306977 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:20:52.306977 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:20:52.309091 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:20:52.309091 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:20:52.309091 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:20:52.311093 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:20:52.311093 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:20:52.311093 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:20:52.325602 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:20:52.325602 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:20:52.326606 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:20:52.328113 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:20:52.328113 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:20:52.328113 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:20:52.328113 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:20:52.329119 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:20:52.329119 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:20:52.333118 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:20:52.335118 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:20:52.335118 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:20:52.335118 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:20:52.336120 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:20:52.337122 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:20:52.338123 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:20:52.259808 => 2023-03-30 23:20:52.337122
[0m23:20:52.338631 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:20:52.230277 => 2023-03-30 23:20:52.338631
[0m23:20:52.338631 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:20:52.338631 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:20:52.339639 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ccbcbc3-3971-4a87-87bf-d61f2b52ea88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D75F2290>]}
[0m23:20:52.339639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ccbcbc3-3971-4a87-87bf-d61f2b52ea88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D71A5AD0>]}
[0m23:20:52.340636 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.11s]
[0m23:20:52.341638 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m23:20:52.342637 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:20:52.343636 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:20:52.344639 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:20:52.348146 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:52.349153 [debug] [MainThread]: On master: BEGIN
[0m23:20:52.349153 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:20:52.378688 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:20:52.378688 [debug] [MainThread]: On master: COMMIT
[0m23:20:52.379694 [debug] [MainThread]: Using postgres connection "master"
[0m23:20:52.379694 [debug] [MainThread]: On master: COMMIT
[0m23:20:52.379694 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:20:52.379694 [debug] [MainThread]: On master: Close
[0m23:20:52.380693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:20:52.380693 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:20:52.380693 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:20:52.381696 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:20:52.381696 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:20:52.381696 [info ] [MainThread]: 
[0m23:20:52.381696 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m23:20:52.382699 [debug] [MainThread]: Command end result
[0m23:20:52.386695 [info ] [MainThread]: 
[0m23:20:52.386695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:20:52.388199 [info ] [MainThread]: 
[0m23:20:52.388199 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:20:52.389207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D6A08250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D6D91750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D7279410>]}
[0m23:20:52.389207 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:21:16.038627 | 237e5666-c4aa-4531-88e1-7a4335eed651 ==============================
[0m23:21:16.038627 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:21:16.040330 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:21:16.040330 [debug] [MainThread]: Tracking: tracking
[0m23:21:16.048858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CBCF1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CBD87250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CC2ABD90>]}
[0m23:21:16.056863 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:21:16.062374 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:21:16.062374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '237e5666-c4aa-4531-88e1-7a4335eed651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CC545250>]}
[0m23:21:16.504129 [debug] [MainThread]: 1699: static parser successfully parsed stg_walmart.sql
[0m23:21:16.514636 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:21:16.547164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '237e5666-c4aa-4531-88e1-7a4335eed651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CC2D9B90>]}
[0m23:21:16.551677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '237e5666-c4aa-4531-88e1-7a4335eed651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CC574110>]}
[0m23:21:16.551677 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:21:16.552675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '237e5666-c4aa-4531-88e1-7a4335eed651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CBA5E150>]}
[0m23:21:16.553675 [info ] [MainThread]: 
[0m23:21:16.554678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:21:16.556681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:21:16.564200 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:21:16.565202 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:21:16.565202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:16.597763 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:21:16.598765 [debug] [ThreadPool]: On list_projeto: Close
[0m23:21:16.600283 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:21:16.605282 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:21:16.605282 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:21:16.605282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:16.633840 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:21:16.634836 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:21:16.634836 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:21:16.636836 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m23:21:16.638837 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:21:16.638837 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:21:16.643134 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:16.644134 [debug] [MainThread]: On master: BEGIN
[0m23:21:16.644134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:21:16.672680 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:21:16.673680 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:16.673680 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:21:16.677680 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m23:21:16.679189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '237e5666-c4aa-4531-88e1-7a4335eed651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CC3015D0>]}
[0m23:21:16.679189 [debug] [MainThread]: On master: ROLLBACK
[0m23:21:16.679189 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:16.680194 [debug] [MainThread]: On master: BEGIN
[0m23:21:16.680194 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:21:16.680194 [debug] [MainThread]: On master: COMMIT
[0m23:21:16.680194 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:16.681200 [debug] [MainThread]: On master: COMMIT
[0m23:21:16.681200 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:21:16.681200 [debug] [MainThread]: On master: Close
[0m23:21:16.682199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:21:16.682199 [info ] [MainThread]: 
[0m23:21:16.686201 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:21:16.686201 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:21:16.687207 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:21:16.687207 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:21:16.687207 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:21:16.688718 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:21:16.688718 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:21:16.688718 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:21:16.690729 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:21:16.692729 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:21:16.692729 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:21:16.688718 => 2023-03-30 23:21:16.692729
[0m23:21:16.692729 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:21:16.693729 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:21:16.691727 => 2023-03-30 23:21:16.693729
[0m23:21:16.728632 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:21:16.728632 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:21:16.732640 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:21:16.733645 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:21:16.733645 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:21:16.734639 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:21:16.734639 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:21:16.734639 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:21:16.734639 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:21:16.766780 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:21:16.766780 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:21:16.767781 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:21:16.767781 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:21:16.767781 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:21:16.767781 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	date(walmart.ship_date) as ship_date,
	walmart.quantity,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.quantity/10 and
walmart.order_id is not null
  );
[0m23:21:16.769286 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:21:16.774300 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:21:16.774300 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:21:16.774300 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:21:16.776299 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:21:16.777298 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:21:16.777298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:21:16.778805 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:21:16.778805 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:21:16.778805 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:21:16.781336 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:21:16.782335 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:21:16.782335 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:21:16.788896 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:21:16.796849 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:21:16.798852 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:21:16.798852 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:21:16.798852 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:21:16.798852 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:21:16.798852 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:21:16.801440 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:21:16.801440 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:21:16.805454 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:21:16.807453 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:21:16.807453 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:21:16.807453 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:21:16.809661 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:21:16.809661 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:21:16.810677 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:21:16.729639 => 2023-03-30 23:21:16.810677
[0m23:21:16.810677 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:21:16.693729 => 2023-03-30 23:21:16.810677
[0m23:21:16.811674 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:21:16.811674 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:21:16.812676 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237e5666-c4aa-4531-88e1-7a4335eed651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CC67BDD0>]}
[0m23:21:16.812676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237e5666-c4aa-4531-88e1-7a4335eed651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8C789C250>]}
[0m23:21:16.812676 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.12s]
[0m23:21:16.813676 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:21:16.814672 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:21:16.876905 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:21:16.878919 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:21:16.879425 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:16.879425 [debug] [MainThread]: On master: BEGIN
[0m23:21:16.879425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:21:16.907456 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:21:16.908961 [debug] [MainThread]: On master: COMMIT
[0m23:21:16.908961 [debug] [MainThread]: Using postgres connection "master"
[0m23:21:16.908961 [debug] [MainThread]: On master: COMMIT
[0m23:21:16.909966 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:21:16.909966 [debug] [MainThread]: On master: Close
[0m23:21:16.909966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:21:16.910966 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:21:16.910966 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:21:16.910966 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:21:16.910966 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:21:16.910966 [info ] [MainThread]: 
[0m23:21:16.911966 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m23:21:16.911966 [debug] [MainThread]: Command end result
[0m23:21:16.916965 [info ] [MainThread]: 
[0m23:21:16.916965 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:21:16.917968 [info ] [MainThread]: 
[0m23:21:16.917968 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:21:16.918975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CC2AAA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CC1FA110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CC1F93D0>]}
[0m23:21:16.918975 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:22:04.322144 | 123c03cd-bc4f-483e-a2f8-3e97c5f8748a ==============================
[0m23:22:04.322144 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:22:04.324145 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:22:04.324145 [debug] [MainThread]: Tracking: tracking
[0m23:22:04.333406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214DA15F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214D9DCE550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214D98B6E90>]}
[0m23:22:04.340923 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:22:04.375488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:22:04.375488 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m23:22:04.387006 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:22:04.404062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '123c03cd-bc4f-483e-a2f8-3e97c5f8748a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214DA1973D0>]}
[0m23:22:04.408062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '123c03cd-bc4f-483e-a2f8-3e97c5f8748a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214DA462DD0>]}
[0m23:22:04.408062 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:22:04.409061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '123c03cd-bc4f-483e-a2f8-3e97c5f8748a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214DA1846D0>]}
[0m23:22:04.410062 [info ] [MainThread]: 
[0m23:22:04.411577 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:22:04.412578 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:22:04.421089 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:22:04.421089 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:22:04.422096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:04.457638 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:22:04.458637 [debug] [ThreadPool]: On list_projeto: Close
[0m23:22:04.460142 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:22:04.464152 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:22:04.465152 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:22:04.465152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:04.494290 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:22:04.494290 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:22:04.494290 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:22:04.497316 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m23:22:04.498831 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:22:04.498831 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:22:04.503351 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:04.503351 [debug] [MainThread]: On master: BEGIN
[0m23:22:04.504351 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:22:04.535916 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:22:04.535916 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:04.535916 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:22:04.538912 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m23:22:04.540417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '123c03cd-bc4f-483e-a2f8-3e97c5f8748a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214DA3D3C90>]}
[0m23:22:04.541422 [debug] [MainThread]: On master: ROLLBACK
[0m23:22:04.541422 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:04.541422 [debug] [MainThread]: On master: BEGIN
[0m23:22:04.541422 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:22:04.542422 [debug] [MainThread]: On master: COMMIT
[0m23:22:04.542422 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:04.542422 [debug] [MainThread]: On master: COMMIT
[0m23:22:04.542422 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:22:04.543425 [debug] [MainThread]: On master: Close
[0m23:22:04.543425 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:22:04.544427 [info ] [MainThread]: 
[0m23:22:04.547422 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:22:04.547422 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:22:04.548421 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:22:04.548421 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:22:04.548421 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:22:04.549929 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:22:04.549929 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:22:04.549929 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:22:04.551935 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:22:04.552935 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:22:04.553934 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:22:04.549929 => 2023-03-30 23:22:04.553934
[0m23:22:04.553934 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:22:04.553934 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:22:04.551935 => 2023-03-30 23:22:04.553934
[0m23:22:04.583288 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:22:04.583288 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:22:04.587039 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:22:04.587039 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:22:04.588026 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:22:04.588026 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:22:04.588026 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:22:04.588026 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:22:04.589026 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:22:04.620091 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:22:04.620597 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:22:04.620597 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:22:04.620597 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:22:04.621605 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:22:04.621605 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	date(walmart.ship_date) as ship_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales/10 and
walmart.order_id is not null
  );
[0m23:22:04.622607 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:22:04.627604 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:22:04.627604 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:22:04.627604 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:22:04.630110 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:22:04.630110 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:22:04.630110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:22:04.632125 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:22:04.633124 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:22:04.633124 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:22:04.635122 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:22:04.635122 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:22:04.635122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:22:04.648644 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:22:04.650150 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:22:04.650150 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:22:04.651158 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:22:04.651158 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:22:04.652163 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:22:04.652163 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:22:04.652163 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:22:04.656166 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:22:04.656166 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:22:04.656166 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:22:04.658165 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:22:04.658165 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:22:04.659164 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:22:04.659164 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:22:04.660669 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:22:04.553934 => 2023-03-30 23:22:04.660669
[0m23:22:04.661677 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:22:04.584012 => 2023-03-30 23:22:04.661677
[0m23:22:04.661677 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:22:04.661677 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:22:04.662677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '123c03cd-bc4f-483e-a2f8-3e97c5f8748a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214DA16E350>]}
[0m23:22:04.662677 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '123c03cd-bc4f-483e-a2f8-3e97c5f8748a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214DA4E3890>]}
[0m23:22:04.663678 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m23:22:04.663678 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.11s]
[0m23:22:04.665678 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:22:04.665678 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:22:04.666677 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:22:04.666677 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:04.667676 [debug] [MainThread]: On master: BEGIN
[0m23:22:04.667676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:22:04.697090 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:22:04.697090 [debug] [MainThread]: On master: COMMIT
[0m23:22:04.698092 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:04.698092 [debug] [MainThread]: On master: COMMIT
[0m23:22:04.698092 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:22:04.699091 [debug] [MainThread]: On master: Close
[0m23:22:04.699091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:22:04.699091 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:22:04.699091 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:22:04.700322 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:22:04.700322 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:22:04.700322 [info ] [MainThread]: 
[0m23:22:04.700322 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m23:22:04.701329 [debug] [MainThread]: Command end result
[0m23:22:04.705332 [info ] [MainThread]: 
[0m23:22:04.706334 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:22:04.706334 [info ] [MainThread]: 
[0m23:22:04.707329 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:22:04.707329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214D98E9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214D9BBBC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214D98B6DD0>]}
[0m23:22:04.707329 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:22:53.379766 | 5858778f-0fb7-45fa-9516-6da9af116d10 ==============================
[0m23:22:53.379766 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:22:53.382275 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:22:53.383283 [debug] [MainThread]: Tracking: tracking
[0m23:22:53.391277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5ECACA950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5ECB00150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5ED1FF8D0>]}
[0m23:22:53.399314 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:22:53.432872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:22:53.433871 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m23:22:53.444379 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:22:53.459891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5858778f-0fb7-45fa-9516-6da9af116d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5ECAD2290>]}
[0m23:22:53.464400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5858778f-0fb7-45fa-9516-6da9af116d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5ED5DF7D0>]}
[0m23:22:53.464400 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:22:53.465400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5858778f-0fb7-45fa-9516-6da9af116d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5ED247D10>]}
[0m23:22:53.466407 [info ] [MainThread]: 
[0m23:22:53.467405 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:22:53.469401 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:22:53.476910 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:22:53.477910 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:22:53.477910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:53.512958 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:22:53.513954 [debug] [ThreadPool]: On list_projeto: Close
[0m23:22:53.515956 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:22:53.519955 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:22:53.519955 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:22:53.519955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:53.549995 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:22:53.549995 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:22:53.549995 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:22:53.552506 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m23:22:53.553503 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:22:53.554504 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:22:53.558504 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:53.559504 [debug] [MainThread]: On master: BEGIN
[0m23:22:53.559504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:22:53.589563 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:22:53.590564 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:53.590564 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:22:53.594074 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m23:22:53.595074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5858778f-0fb7-45fa-9516-6da9af116d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5ED5BBC90>]}
[0m23:22:53.595074 [debug] [MainThread]: On master: ROLLBACK
[0m23:22:53.596074 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:53.596074 [debug] [MainThread]: On master: BEGIN
[0m23:22:53.596074 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:22:53.597081 [debug] [MainThread]: On master: COMMIT
[0m23:22:53.597081 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:53.597081 [debug] [MainThread]: On master: COMMIT
[0m23:22:53.597081 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:22:53.598075 [debug] [MainThread]: On master: Close
[0m23:22:53.598075 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:22:53.599073 [info ] [MainThread]: 
[0m23:22:53.602587 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:22:53.602587 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:22:53.603583 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:22:53.603583 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:22:53.604583 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:22:53.604583 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:22:53.604583 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:22:53.605583 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:22:53.607583 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:22:53.608583 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:22:53.608583 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:22:53.605583 => 2023-03-30 23:22:53.608583
[0m23:22:53.609583 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:22:53.609583 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:22:53.607583 => 2023-03-30 23:22:53.609583
[0m23:22:53.638140 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:22:53.639140 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:22:53.641646 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:22:53.642655 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:22:53.642655 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:22:53.643651 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:22:53.643651 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:22:53.643651 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:22:53.643651 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:22:53.675192 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:22:53.675192 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:22:53.675192 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:22:53.676189 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:22:53.676189 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:22:53.677189 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	date(walmart.ship_date) as ship_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.5 and
walmart.order_id is not null
  );
[0m23:22:53.678188 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:22:53.679189 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:22:53.684224 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:22:53.686224 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:22:53.686224 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:22:53.687224 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:22:53.687224 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:22:53.687224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:22:53.689224 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:22:53.691225 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:22:53.691730 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:22:53.691730 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:22:53.692739 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:22:53.692739 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:22:53.707248 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:22:53.709248 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:22:53.709248 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:22:53.709248 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:22:53.709248 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:22:53.710249 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:22:53.710249 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:22:53.710249 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:22:53.714392 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:22:53.716392 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:22:53.716392 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:22:53.716392 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:22:53.718395 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:22:53.718395 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:22:53.719395 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:22:53.609583 => 2023-03-30 23:22:53.719395
[0m23:22:53.720392 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:22:53.639140 => 2023-03-30 23:22:53.720392
[0m23:22:53.720392 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:22:53.720392 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:22:53.721395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5858778f-0fb7-45fa-9516-6da9af116d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5ED6CF090>]}
[0m23:22:53.721395 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5858778f-0fb7-45fa-9516-6da9af116d10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5ED68BA90>]}
[0m23:22:53.722610 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m23:22:53.722610 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.12s]
[0m23:22:53.724611 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:22:53.724611 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:22:53.726612 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:22:53.726612 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:53.726612 [debug] [MainThread]: On master: BEGIN
[0m23:22:53.726612 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:22:53.756028 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:22:53.757036 [debug] [MainThread]: On master: COMMIT
[0m23:22:53.757036 [debug] [MainThread]: Using postgres connection "master"
[0m23:22:53.757036 [debug] [MainThread]: On master: COMMIT
[0m23:22:53.758026 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:22:53.758026 [debug] [MainThread]: On master: Close
[0m23:22:53.758026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:22:53.759025 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:22:53.759025 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:22:53.759025 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:22:53.759025 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:22:53.760033 [info ] [MainThread]: 
[0m23:22:53.760033 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m23:22:53.760033 [debug] [MainThread]: Command end result
[0m23:22:53.764545 [info ] [MainThread]: 
[0m23:22:53.765544 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:22:53.765544 [info ] [MainThread]: 
[0m23:22:53.765544 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:22:53.766543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5ED263B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5ED5E8450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5ED62BAD0>]}
[0m23:22:53.766543 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:23:16.387487 | 547b39a6-6bf7-4139-bf05-7b0d5e2533e0 ==============================
[0m23:23:16.387487 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:23:16.389487 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:23:16.389487 [debug] [MainThread]: Tracking: tracking
[0m23:23:16.398003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832EA42510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832F209C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832EA761D0>]}
[0m23:23:16.405513 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:23:16.440046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:23:16.441048 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m23:23:16.452079 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:23:16.469600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '547b39a6-6bf7-4139-bf05-7b0d5e2533e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832F2A3910>]}
[0m23:23:16.475112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '547b39a6-6bf7-4139-bf05-7b0d5e2533e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832F2A3910>]}
[0m23:23:16.475112 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:23:16.476114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '547b39a6-6bf7-4139-bf05-7b0d5e2533e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832F2D4B10>]}
[0m23:23:16.477112 [info ] [MainThread]: 
[0m23:23:16.479109 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:23:16.480110 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:23:16.488623 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:23:16.488623 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:23:16.488623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:16.622632 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:23:16.623639 [debug] [ThreadPool]: On list_projeto: Close
[0m23:23:16.624644 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:23:16.629648 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:23:16.629648 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:23:16.630649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:16.659756 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:23:16.659756 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:23:16.659756 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:23:16.662263 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m23:23:16.663269 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:23:16.664268 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:23:16.669268 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:16.669268 [debug] [MainThread]: On master: BEGIN
[0m23:23:16.669268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:23:16.698821 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:23:16.698821 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:16.699820 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:23:16.702324 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m23:23:16.704332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '547b39a6-6bf7-4139-bf05-7b0d5e2533e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832F2F2B90>]}
[0m23:23:16.704332 [debug] [MainThread]: On master: ROLLBACK
[0m23:23:16.704332 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:16.705330 [debug] [MainThread]: On master: BEGIN
[0m23:23:16.705330 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:23:16.705330 [debug] [MainThread]: On master: COMMIT
[0m23:23:16.706331 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:16.706331 [debug] [MainThread]: On master: COMMIT
[0m23:23:16.706331 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:23:16.706331 [debug] [MainThread]: On master: Close
[0m23:23:16.707331 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:23:16.707331 [info ] [MainThread]: 
[0m23:23:16.711836 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:23:16.711836 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:23:16.711836 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:23:16.711836 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:23:16.712843 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:23:16.712843 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:23:16.713847 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:23:16.713847 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:23:16.715842 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:23:16.716847 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:23:16.717846 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:23:16.713847 => 2023-03-30 23:23:16.717846
[0m23:23:16.717846 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:23:16.717846 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:23:16.715842 => 2023-03-30 23:23:16.717846
[0m23:23:16.746900 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:23:16.747641 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:23:16.750658 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:23:16.750658 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:23:16.750658 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:23:16.750658 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:23:16.752164 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:23:16.752164 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:23:16.752164 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:23:16.783716 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:23:16.784716 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:23:16.784716 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:23:16.784716 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:23:16.784716 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:23:16.784716 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	date(walmart.ship_date) as ship_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.35 and
walmart.order_id is not null
  );
[0m23:23:16.786718 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:23:16.791715 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:23:16.791715 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:23:16.791715 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:23:16.794021 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:23:16.794021 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:23:16.794021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:23:16.796020 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:23:16.796020 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:23:16.796020 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:23:16.798021 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:23:16.799020 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:23:16.799020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:23:16.813042 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:23:16.813042 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:23:16.813042 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:23:16.815042 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:23:16.815042 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:23:16.815042 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:23:16.816041 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:23:16.816761 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:23:16.816761 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:23:16.819777 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:23:16.822280 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:23:16.822280 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:23:16.822280 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:23:16.823286 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:23:16.823286 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:23:16.824289 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:23:16.747641 => 2023-03-30 23:23:16.824289
[0m23:23:16.825287 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:23:16.717846 => 2023-03-30 23:23:16.825287
[0m23:23:16.825287 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:23:16.825287 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:23:16.826288 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '547b39a6-6bf7-4139-bf05-7b0d5e2533e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832F606B50>]}
[0m23:23:16.827296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '547b39a6-6bf7-4139-bf05-7b0d5e2533e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832ED0C690>]}
[0m23:23:16.827296 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.11s]
[0m23:23:16.828287 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m23:23:16.829287 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:23:16.829287 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:23:16.830288 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:23:16.830288 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:16.831796 [debug] [MainThread]: On master: BEGIN
[0m23:23:16.831796 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:23:16.860209 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:23:16.861714 [debug] [MainThread]: On master: COMMIT
[0m23:23:16.861714 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:16.861714 [debug] [MainThread]: On master: COMMIT
[0m23:23:16.862721 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:23:16.862721 [debug] [MainThread]: On master: Close
[0m23:23:16.863720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:16.863720 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:23:16.863720 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:23:16.863720 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:23:16.864728 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:23:16.864728 [info ] [MainThread]: 
[0m23:23:16.864728 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m23:23:16.865727 [debug] [MainThread]: Command end result
[0m23:23:16.869727 [info ] [MainThread]: 
[0m23:23:16.870729 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:23:16.870729 [info ] [MainThread]: 
[0m23:23:16.870729 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:23:16.871726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832F53F350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832F53CFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832F53CF10>]}
[0m23:23:16.872234 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:23:36.971557 | 03fdae8c-7603-4575-9da4-07474272a83c ==============================
[0m23:23:36.971557 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:23:36.973065 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:23:36.973065 [debug] [MainThread]: Tracking: tracking
[0m23:23:36.981075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F7ACC87D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F7A521510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F7AC96A50>]}
[0m23:23:36.990586 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:23:37.024628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:23:37.024628 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m23:23:37.037145 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:23:37.054677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03fdae8c-7603-4575-9da4-07474272a83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F7B0086D0>]}
[0m23:23:37.059679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03fdae8c-7603-4575-9da4-07474272a83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F7B0A2690>]}
[0m23:23:37.059679 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:23:37.060682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03fdae8c-7603-4575-9da4-07474272a83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F7B0A0410>]}
[0m23:23:37.061682 [info ] [MainThread]: 
[0m23:23:37.062676 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:23:37.063946 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:23:37.072457 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:23:37.073469 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:23:37.073469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:37.108556 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:23:37.110552 [debug] [ThreadPool]: On list_projeto: Close
[0m23:23:37.111555 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:23:37.116581 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:23:37.116581 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:23:37.116581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:37.147425 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:23:37.148432 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:23:37.148432 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:23:37.150453 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m23:23:37.152432 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:23:37.152432 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:23:37.157710 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:37.157710 [debug] [MainThread]: On master: BEGIN
[0m23:23:37.157710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:23:37.187268 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:23:37.188263 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:37.188263 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:23:37.191268 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m23:23:37.193380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03fdae8c-7603-4575-9da4-07474272a83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F7B039790>]}
[0m23:23:37.193380 [debug] [MainThread]: On master: ROLLBACK
[0m23:23:37.194381 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:37.194381 [debug] [MainThread]: On master: BEGIN
[0m23:23:37.194381 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:23:37.194381 [debug] [MainThread]: On master: COMMIT
[0m23:23:37.195379 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:37.195379 [debug] [MainThread]: On master: COMMIT
[0m23:23:37.195379 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:23:37.195379 [debug] [MainThread]: On master: Close
[0m23:23:37.196385 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:23:37.196385 [info ] [MainThread]: 
[0m23:23:37.200381 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:23:37.200381 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:23:37.200381 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_walmart ................................. [RUN]
[0m23:23:37.201380 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:23:37.201380 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:23:37.202380 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:23:37.202380 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:23:37.202380 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:23:37.204594 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:23:37.205593 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:23:37.206593 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:23:37.202380 => 2023-03-30 23:23:37.206593
[0m23:23:37.206593 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:23:37.205593 => 2023-03-30 23:23:37.206593
[0m23:23:37.206593 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:23:37.207595 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:23:37.237645 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:23:37.240643 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:23:37.241644 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:23:37.241644 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:23:37.242644 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:23:37.242644 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:23:37.242644 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:23:37.242644 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:23:37.275767 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:23:37.276765 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:23:37.276765 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:23:37.276765 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:23:37.276765 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:23:37.276765 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	date(walmart.ship_date) as ship_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:23:37.278766 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:23:37.285276 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:23:37.285276 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:23:37.285276 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:23:37.289278 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:23:37.290276 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:23:37.290276 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:23:37.290276 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:23:37.293792 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:23:37.296798 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:23:37.297800 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:23:37.297800 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:23:37.298799 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:23:37.298799 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:23:37.320846 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:23:37.323364 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:23:37.323364 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:23:37.323364 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:23:37.324360 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:23:37.324360 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:23:37.414780 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:23:37.419790 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:23:37.419790 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:23:37.419790 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:23:37.422296 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:23:37.422296 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:23:37.423302 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:23:37.424303 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:23:37.237645 => 2023-03-30 23:23:37.424303
[0m23:23:37.424303 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:23:37.424303 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:23:37.425304 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:23:37.207595 => 2023-03-30 23:23:37.425304
[0m23:23:37.426305 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03fdae8c-7603-4575-9da4-07474272a83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F7B09FD10>]}
[0m23:23:37.426305 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:23:37.426305 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.22s]
[0m23:23:37.427302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03fdae8c-7603-4575-9da4-07474272a83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F7B023A10>]}
[0m23:23:37.428300 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:23:37.429300 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.23s]
[0m23:23:37.429300 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:23:37.431303 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:23:37.431303 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:37.431303 [debug] [MainThread]: On master: BEGIN
[0m23:23:37.431303 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:23:37.463566 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:23:37.463566 [debug] [MainThread]: On master: COMMIT
[0m23:23:37.464574 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:37.464574 [debug] [MainThread]: On master: COMMIT
[0m23:23:37.464574 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:23:37.464574 [debug] [MainThread]: On master: Close
[0m23:23:37.465572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:37.465572 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:23:37.465572 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:23:37.465572 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:23:37.466572 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:23:37.466572 [info ] [MainThread]: 
[0m23:23:37.466572 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m23:23:37.467571 [debug] [MainThread]: Command end result
[0m23:23:37.471571 [info ] [MainThread]: 
[0m23:23:37.472575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:23:37.472575 [info ] [MainThread]: 
[0m23:23:37.473082 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:23:37.473082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F7A5C8B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F7A800890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F7A8ABED0>]}
[0m23:23:37.474089 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:31:32.609101 | bf2c4c04-5115-42c8-a5bb-2656e1273ead ==============================
[0m23:31:32.609101 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:31:32.611525 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:31:32.611525 [debug] [MainThread]: Tracking: tracking
[0m23:31:32.620366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFE1FC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFE263D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFE1FE8D0>]}
[0m23:31:32.628877 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:31:32.677261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:31:32.677261 [debug] [MainThread]: Partial parsing: added file: projeto_final://models\view_2.sql
[0m23:31:32.678261 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m23:31:32.690267 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:31:32.701776 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:31:32.709776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf2c4c04-5115-42c8-a5bb-2656e1273ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFE6AE010>]}
[0m23:31:32.713778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf2c4c04-5115-42c8-a5bb-2656e1273ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFEAD7390>]}
[0m23:31:32.714780 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:31:32.714780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2c4c04-5115-42c8-a5bb-2656e1273ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFDF3D090>]}
[0m23:31:32.715779 [info ] [MainThread]: 
[0m23:31:32.717776 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:31:32.718764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:31:32.727774 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:31:32.727774 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:31:32.727774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:32.770408 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:31:32.772409 [debug] [ThreadPool]: On list_projeto: Close
[0m23:31:32.773414 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:31:32.778411 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:31:32.778411 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:31:32.778411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:32.807885 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:31:32.807885 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:31:32.807885 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:31:32.811249 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m23:31:32.812262 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:31:32.812262 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:31:32.817260 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:32.817260 [debug] [MainThread]: On master: BEGIN
[0m23:31:32.818259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:31:32.847262 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:31:32.847262 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:32.847262 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:31:32.851800 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m23:31:32.852803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2c4c04-5115-42c8-a5bb-2656e1273ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFEA62CD0>]}
[0m23:31:32.853802 [debug] [MainThread]: On master: ROLLBACK
[0m23:31:32.853802 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:32.853802 [debug] [MainThread]: On master: BEGIN
[0m23:31:32.854801 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:31:32.854801 [debug] [MainThread]: On master: COMMIT
[0m23:31:32.854801 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:32.854801 [debug] [MainThread]: On master: COMMIT
[0m23:31:32.855800 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:31:32.855800 [debug] [MainThread]: On master: Close
[0m23:31:32.855800 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:31:32.856804 [info ] [MainThread]: 
[0m23:31:32.862470 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:31:32.862470 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:31:32.862470 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:31:32.862470 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:31:32.863471 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:31:32.863471 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:31:32.864470 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:31:32.864470 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:31:32.865474 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:31:32.865474 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:31:32.865474 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:31:32.866471 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:31:32.868469 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:31:32.869474 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:31:32.870470 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:31:32.871471 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:31:32.866471 => 2023-03-30 23:31:32.870470
[0m23:31:32.871471 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:31:32.871471 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:31:32.868469 => 2023-03-30 23:31:32.871471
[0m23:31:32.896473 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:31:32.869474 => 2023-03-30 23:31:32.896473
[0m23:31:32.901988 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:31:32.900981 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:31:32.900981 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:31:32.904982 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:31:32.907985 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:31:32.907985 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:31:32.908986 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:31:32.908986 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:31:32.908986 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:31:32.908986 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:31:32.909983 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:31:32.909983 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:31:32.909983 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:31:32.909983 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:31:32.943985 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:31:32.943985 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:31:32.943985 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:31:32.944985 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:31:32.944985 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:31:32.944985 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
	walmart.quantity,
	walmart.state
from walmart
where walmart.ship_date > walmart.order_date and
walmart.order_id is not null
  );
[0m23:31:32.945981 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:31:32.946983 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:31:32.946983 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:31:32.950689 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:31:32.950689 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:31:32.950689 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:31:32.955689 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:31:32.957689 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:31:32.959689 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:31:32.959689 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m23:31:32.959689 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:31:32.960696 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:31:32.961690 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:31:32.961690 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:31:32.961690 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:31:32.963689 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:31:32.977694 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:31:32.979690 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:31:32.979690 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:31:32.980690 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:31:32.980690 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:31:32.980690 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:31:32.981690 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:31:32.981690 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:31:32.984695 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:31:32.985694 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:31:32.985694 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:31:32.986701 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:31:32.986701 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:31:32.986701 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:31:33.103534 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m23:31:33.104533 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:31:33.104533 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:31:33.108531 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:31:33.110532 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:31:33.111532 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:31:33.111532 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m23:31:33.112533 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:31:33.112533 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:31:33.113535 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m23:31:33.114533 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:31:32.901988 => 2023-03-30 23:31:33.114533
[0m23:31:33.114533 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:31:33.114533 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:31:33.114533 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:31:33.115533 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:31:32.904982 => 2023-03-30 23:31:33.115533
[0m23:31:33.116533 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:31:32.871471 => 2023-03-30 23:31:33.116533
[0m23:31:33.116533 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2c4c04-5115-42c8-a5bb-2656e1273ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFEA92290>]}
[0m23:31:33.117532 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:31:33.117532 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:31:33.117532 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.25s]
[0m23:31:33.118533 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2c4c04-5115-42c8-a5bb-2656e1273ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFE2CD950>]}
[0m23:31:33.119533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2c4c04-5115-42c8-a5bb-2656e1273ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFEB47E10>]}
[0m23:31:33.120535 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:31:33.121534 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.25s]
[0m23:31:33.121534 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.26s]
[0m23:31:33.122532 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:31:33.122532 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:31:33.124532 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:31:33.124532 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:33.124532 [debug] [MainThread]: On master: BEGIN
[0m23:31:33.124532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:31:33.158197 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:31:33.158197 [debug] [MainThread]: On master: COMMIT
[0m23:31:33.158197 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:33.159226 [debug] [MainThread]: On master: COMMIT
[0m23:31:33.159226 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:31:33.159226 [debug] [MainThread]: On master: Close
[0m23:31:33.160214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:33.160214 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:31:33.160214 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:31:33.160214 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:31:33.160214 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:31:33.161212 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:31:33.161212 [info ] [MainThread]: 
[0m23:31:33.161212 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m23:31:33.162212 [debug] [MainThread]: Command end result
[0m23:31:33.167211 [info ] [MainThread]: 
[0m23:31:33.167211 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:31:33.168211 [info ] [MainThread]: 
[0m23:31:33.168211 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:31:33.169214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFDFEEAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFE1BD4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFE7D3950>]}
[0m23:31:33.169214 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:32:44.533254 | 10e0e2fa-f33a-4bde-baad-11f1a53a3c44 ==============================
[0m23:32:44.533254 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:32:44.535342 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:32:44.535342 [debug] [MainThread]: Tracking: tracking
[0m23:32:44.544358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002773A77CB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002773AF54810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002773A9EBC10>]}
[0m23:32:44.552356 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:32:44.585871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:32:44.585871 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:32:44.596871 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:32:44.611872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10e0e2fa-f33a-4bde-baad-11f1a53a3c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002773AFEFE10>]}
[0m23:32:44.616726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10e0e2fa-f33a-4bde-baad-11f1a53a3c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002773AF13310>]}
[0m23:32:44.616726 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:32:44.616726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10e0e2fa-f33a-4bde-baad-11f1a53a3c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002773AFFE810>]}
[0m23:32:44.617741 [info ] [MainThread]: 
[0m23:32:44.619741 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:44.620744 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:32:44.628744 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:32:44.629746 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:32:44.629746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:44.661753 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:32:44.662751 [debug] [ThreadPool]: On list_projeto: Close
[0m23:32:44.664750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:32:44.669259 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:32:44.669259 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:32:44.669259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:44.699042 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:32:44.699042 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:32:44.699042 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:32:44.702071 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:32:44.703062 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:32:44.704074 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:32:44.709056 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:44.709056 [debug] [MainThread]: On master: BEGIN
[0m23:32:44.709056 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:44.741297 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:32:44.741297 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:44.742297 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:32:44.745297 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:32:44.747297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10e0e2fa-f33a-4bde-baad-11f1a53a3c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002773B285850>]}
[0m23:32:44.747297 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:44.747297 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:44.748285 [debug] [MainThread]: On master: BEGIN
[0m23:32:44.748285 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:32:44.748285 [debug] [MainThread]: On master: COMMIT
[0m23:32:44.749285 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:44.749285 [debug] [MainThread]: On master: COMMIT
[0m23:32:44.749285 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:32:44.749285 [debug] [MainThread]: On master: Close
[0m23:32:44.750285 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:32:44.750285 [info ] [MainThread]: 
[0m23:32:44.754286 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:32:44.754286 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:32:44.754286 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:32:44.755289 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:32:44.755289 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:32:44.756287 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:32:44.756287 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:32:44.757288 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:32:44.757288 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:32:44.757288 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:32:44.757288 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:32:44.758287 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:32:44.760286 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:32:44.761287 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:32:44.762286 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:32:44.763286 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:32:44.758287 => 2023-03-30 23:32:44.763286
[0m23:32:44.764292 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:32:44.760286 => 2023-03-30 23:32:44.764292
[0m23:32:44.764292 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:32:44.764292 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:32:44.764292 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:32:44.761287 => 2023-03-30 23:32:44.764292
[0m23:32:44.792800 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:32:44.795557 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:32:44.796557 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:32:44.799556 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:32:44.799556 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:32:44.800556 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:32:44.800556 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:32:44.800556 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:32:44.800556 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:32:44.801556 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:32:44.801556 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:32:44.801556 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:32:44.802557 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:32:44.834556 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:32:44.835561 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:32:44.835561 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:32:44.835561 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:32:44.836560 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:32:44.836560 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:32:44.837560 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:32:44.837560 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:32:44.842557 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:32:44.842557 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:32:44.842557 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:32:44.842557 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:32:44.844556 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:32:44.845556 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    (ship_date-order_date) as o_s_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.ship_date > walmart.order_date and
walmart.order_id is not null
  );
[0m23:32:44.845556 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:32:44.845556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:32:44.847555 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:32:44.847555 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:32:44.848555 [debug] [Thread-3 (]: Postgres adapter: Postgres error: operator does not exist: text - text
LINE 7:     (ship_date-order_date) as o_s_delta,
                      ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m23:32:44.848555 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:32:44.849557 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:32:44.850557 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m23:32:44.850557 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:32:44.850557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:32:44.851425 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:32:44.797556 => 2023-03-30 23:32:44.851425
[0m23:32:44.866443 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:32:44.867443 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:32:44.867443 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:32:44.867443 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:32:44.868948 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:32:44.870954 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:32:44.870954 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:32:44.870954 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:32:44.871954 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:32:44.871954 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:32:44.875953 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:32:44.877953 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:32:44.877953 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:32:44.877953 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:32:44.878953 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:32:44.879956 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:32:44.880954 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:32:44.764292 => 2023-03-30 23:32:44.880954
[0m23:32:44.880954 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:32:44.793541 => 2023-03-30 23:32:44.880954
[0m23:32:44.881954 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:32:44.881954 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:32:44.882958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10e0e2fa-f33a-4bde-baad-11f1a53a3c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002773B39A290>]}
[0m23:32:44.882958 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10e0e2fa-f33a-4bde-baad-11f1a53a3c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002773B35F750>]}
[0m23:32:44.883954 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:32:44.883954 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:32:44.885955 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:32:44.885955 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:32:44.887786 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  operator does not exist: text - text
  LINE 7:     (ship_date-order_date) as o_s_delta,
                        ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:32:44.888802 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10e0e2fa-f33a-4bde-baad-11f1a53a3c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002773B384050>]}
[0m23:32:44.888802 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.13s]
[0m23:32:44.889799 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:32:44.890801 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:44.890801 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:44.890801 [debug] [MainThread]: On master: BEGIN
[0m23:32:44.891801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:44.919917 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:32:44.920925 [debug] [MainThread]: On master: COMMIT
[0m23:32:44.920925 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:44.920925 [debug] [MainThread]: On master: COMMIT
[0m23:32:44.921914 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:32:44.921914 [debug] [MainThread]: On master: Close
[0m23:32:44.921914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:44.922914 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:32:44.922914 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:32:44.922914 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:32:44.922914 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:32:44.922914 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:32:44.923921 [info ] [MainThread]: 
[0m23:32:44.923921 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m23:32:44.924916 [debug] [MainThread]: Command end result
[0m23:32:44.929914 [info ] [MainThread]: 
[0m23:32:44.930916 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:32:44.930916 [info ] [MainThread]: 
[0m23:32:44.930916 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m23:32:44.931914 [error] [MainThread]:   operator does not exist: text - text
[0m23:32:44.931914 [error] [MainThread]:   LINE 7:     (ship_date-order_date) as o_s_delta,
[0m23:32:44.931914 [error] [MainThread]:                         ^
[0m23:32:44.932915 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m23:32:44.932915 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:32:44.932915 [info ] [MainThread]: 
[0m23:32:44.932915 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:32:44.933913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002773AAC3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002773AE56010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002773AB03310>]}
[0m23:32:44.933913 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:32:56.423445 | 8f72ef2a-2094-4433-a038-a5525eb2308e ==============================
[0m23:32:56.423445 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:32:56.425092 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:32:56.425092 [debug] [MainThread]: Tracking: tracking
[0m23:32:56.433130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027763C18F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277636806D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027763681850>]}
[0m23:32:56.441126 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:32:56.475131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:32:56.475131 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:32:56.485641 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:32:56.501640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f72ef2a-2094-4433-a038-a5525eb2308e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027763C0E990>]}
[0m23:32:56.505641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f72ef2a-2094-4433-a038-a5525eb2308e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027763EED350>]}
[0m23:32:56.506643 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:32:56.506643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f72ef2a-2094-4433-a038-a5525eb2308e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277610B5050>]}
[0m23:32:56.507640 [info ] [MainThread]: 
[0m23:32:56.509642 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:56.510640 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:32:56.518641 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:32:56.519641 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:32:56.519641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:56.550640 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:32:56.552640 [debug] [ThreadPool]: On list_projeto: Close
[0m23:32:56.553641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:32:56.558639 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:32:56.558639 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:32:56.558639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:56.587153 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:32:56.588152 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:32:56.588152 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:32:56.590153 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:32:56.592152 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:32:56.592152 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:32:56.597152 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:56.597152 [debug] [MainThread]: On master: BEGIN
[0m23:32:56.597152 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:56.627152 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:32:56.627152 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:56.628153 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:32:56.631153 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:32:56.633151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f72ef2a-2094-4433-a038-a5525eb2308e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027763EEE490>]}
[0m23:32:56.633151 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:56.633151 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:56.633151 [debug] [MainThread]: On master: BEGIN
[0m23:32:56.634154 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:32:56.634154 [debug] [MainThread]: On master: COMMIT
[0m23:32:56.635153 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:56.635153 [debug] [MainThread]: On master: COMMIT
[0m23:32:56.635153 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:32:56.635153 [debug] [MainThread]: On master: Close
[0m23:32:56.636152 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:32:56.636152 [info ] [MainThread]: 
[0m23:32:56.640152 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:32:56.640152 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:32:56.640152 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:32:56.641156 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:32:56.641156 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:32:56.641156 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:32:56.642152 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:32:56.643156 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:32:56.643156 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:32:56.643156 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:32:56.643156 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:32:56.644154 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:32:56.646152 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:32:56.647157 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:32:56.648154 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:32:56.649158 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:32:56.644154 => 2023-03-30 23:32:56.649158
[0m23:32:56.649158 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:32:56.646152 => 2023-03-30 23:32:56.649158
[0m23:32:56.649158 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:32:56.650156 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:32:56.650156 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:32:56.647157 => 2023-03-30 23:32:56.650156
[0m23:32:56.679688 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:32:56.683684 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:32:56.683684 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:32:56.684688 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:32:56.687687 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:32:56.687687 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:32:56.687687 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:32:56.688689 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:32:56.688689 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:32:56.688689 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:32:56.688689 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:32:56.689687 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:32:56.689687 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:32:56.722684 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:32:56.722684 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:32:56.722684 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:32:56.723687 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:32:56.723687 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:32:56.723687 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:32:56.724686 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:32:56.724686 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:32:56.729687 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:32:56.729687 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:32:56.729687 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:32:56.730685 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:32:56.732688 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:32:56.732688 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    (ship_date - order_date) as o_s_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.ship_date > walmart.order_date and
walmart.order_id is not null
  );
[0m23:32:56.732688 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:32:56.733685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:32:56.735687 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:32:56.735687 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:32:56.735687 [debug] [Thread-3 (]: Postgres adapter: Postgres error: operator does not exist: text - text
LINE 7:     (ship_date - order_date) as o_s_delta,
                       ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m23:32:56.735687 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:32:56.737688 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:32:56.737688 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m23:32:56.738683 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:32:56.738683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:32:56.738683 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:32:56.684688 => 2023-03-30 23:32:56.738683
[0m23:32:56.752687 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:32:56.753688 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:32:56.753688 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:32:56.753688 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:32:56.755687 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:32:56.756684 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:32:56.756684 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:32:56.757684 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:32:56.757684 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:32:56.762688 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:32:56.762688 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:32:56.762688 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:32:56.764697 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:32:56.765696 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:32:56.766693 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  operator does not exist: text - text
  LINE 7:     (ship_date - order_date) as o_s_delta,
                         ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:32:56.766693 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:32:56.766693 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:32:56.766693 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f72ef2a-2094-4433-a038-a5525eb2308e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027763FE8B90>]}
[0m23:32:56.767696 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:32:56.650156 => 2023-03-30 23:32:56.767696
[0m23:32:56.768696 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:32:56.679688 => 2023-03-30 23:32:56.768696
[0m23:32:56.769697 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:32:56.769697 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.12s]
[0m23:32:56.769697 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:32:56.770697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f72ef2a-2094-4433-a038-a5525eb2308e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027763C43590>]}
[0m23:32:56.771693 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:32:56.772693 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f72ef2a-2094-4433-a038-a5525eb2308e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027763F6C350>]}
[0m23:32:56.772693 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:32:56.773692 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:32:56.773692 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:32:56.773692 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:32:56.775694 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:56.775694 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:56.775694 [debug] [MainThread]: On master: BEGIN
[0m23:32:56.775694 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:56.805205 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:32:56.805205 [debug] [MainThread]: On master: COMMIT
[0m23:32:56.805205 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:56.806204 [debug] [MainThread]: On master: COMMIT
[0m23:32:56.806204 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:32:56.806204 [debug] [MainThread]: On master: Close
[0m23:32:56.807206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:56.807206 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:32:56.807206 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:32:56.807206 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:32:56.808206 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:32:56.808206 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:32:56.808206 [info ] [MainThread]: 
[0m23:32:56.808206 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m23:32:56.809205 [debug] [MainThread]: Command end result
[0m23:32:56.814206 [info ] [MainThread]: 
[0m23:32:56.815205 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:32:56.816206 [info ] [MainThread]: 
[0m23:32:56.816206 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m23:32:56.816206 [error] [MainThread]:   operator does not exist: text - text
[0m23:32:56.817205 [error] [MainThread]:   LINE 7:     (ship_date - order_date) as o_s_delta,
[0m23:32:56.817205 [error] [MainThread]:                          ^
[0m23:32:56.817205 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m23:32:56.818205 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:32:56.818205 [info ] [MainThread]: 
[0m23:32:56.818205 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:32:56.819205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277610B5050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027763B4BB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277634677D0>]}
[0m23:32:56.819205 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:33:19.989659 | d85b51df-1ee3-4f39-ad93-2b693865cb4d ==============================
[0m23:33:19.989659 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:33:19.990659 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:33:19.990659 [debug] [MainThread]: Tracking: tracking
[0m23:33:19.999760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E609BA450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E609BA490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6090AF10>]}
[0m23:33:20.006760 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:33:20.041760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:33:20.041760 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:33:20.052760 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:33:20.068760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd85b51df-1ee3-4f39-ad93-2b693865cb4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E60C3D710>]}
[0m23:33:20.072767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd85b51df-1ee3-4f39-ad93-2b693865cb4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E60C8D790>]}
[0m23:33:20.072767 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:33:20.073767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd85b51df-1ee3-4f39-ad93-2b693865cb4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E608B7FD0>]}
[0m23:33:20.074767 [info ] [MainThread]: 
[0m23:33:20.076764 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:33:20.077768 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:33:20.086273 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:33:20.086273 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:33:20.086273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:20.118687 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:33:20.119688 [debug] [ThreadPool]: On list_projeto: Close
[0m23:33:20.120686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:33:20.125685 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:33:20.125685 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:33:20.126689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:20.154773 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:33:20.154773 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:33:20.155762 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:33:20.157762 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:33:20.158764 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:33:20.159762 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:33:20.163762 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:20.164761 [debug] [MainThread]: On master: BEGIN
[0m23:33:20.164761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:33:20.193423 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:33:20.193423 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:20.193423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:33:20.197451 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:33:20.198451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd85b51df-1ee3-4f39-ad93-2b693865cb4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E60C8DF90>]}
[0m23:33:20.199451 [debug] [MainThread]: On master: ROLLBACK
[0m23:33:20.199451 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:20.199451 [debug] [MainThread]: On master: BEGIN
[0m23:33:20.200452 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:33:20.200452 [debug] [MainThread]: On master: COMMIT
[0m23:33:20.200452 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:20.201451 [debug] [MainThread]: On master: COMMIT
[0m23:33:20.201451 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:33:20.201451 [debug] [MainThread]: On master: Close
[0m23:33:20.202443 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:33:20.202443 [info ] [MainThread]: 
[0m23:33:20.206437 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:33:20.206437 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:33:20.206437 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:33:20.206437 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:33:20.207440 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:33:20.207440 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:33:20.208440 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:33:20.208440 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:33:20.209437 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:33:20.209437 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:33:20.209437 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:33:20.209437 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:33:20.211438 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:33:20.212437 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:33:20.214437 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:33:20.214437 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:33:20.209437 => 2023-03-30 23:33:20.214437
[0m23:33:20.215442 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:33:20.215442 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:33:20.211438 => 2023-03-30 23:33:20.215442
[0m23:33:20.233436 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:33:20.212437 => 2023-03-30 23:33:20.233436
[0m23:33:20.244437 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:33:20.244437 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:33:20.244437 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:33:20.248437 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:33:20.251437 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:33:20.251774 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:33:20.251774 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:33:20.251774 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:33:20.252792 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:33:20.252792 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:33:20.252792 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:33:20.252792 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:33:20.253789 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:33:20.253789 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:33:20.286301 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:33:20.286301 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:33:20.287301 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:33:20.288308 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:33:20.288308 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:33:20.288308 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:33:20.288308 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:33:20.289304 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:33:20.294302 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:33:20.294302 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:33:20.294302 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:33:20.294302 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:33:20.296305 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:33:20.297304 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    (ship_date + order_date) as o_s_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.ship_date > walmart.order_date and
walmart.order_id is not null
  );
[0m23:33:20.297304 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:33:20.297304 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:33:20.299303 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:33:20.300302 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:33:20.300302 [debug] [Thread-3 (]: Postgres adapter: Postgres error: operator does not exist: text + text
LINE 7:     (ship_date + order_date) as o_s_delta,
                       ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m23:33:20.300302 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:33:20.302302 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:33:20.302302 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m23:33:20.302302 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:33:20.302302 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:33:20.303304 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:33:20.248437 => 2023-03-30 23:33:20.303304
[0m23:33:20.317303 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:33:20.317942 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:33:20.317942 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:33:20.317942 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:33:20.317942 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:33:20.320958 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:33:20.321958 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:33:20.321958 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:33:20.323958 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  operator does not exist: text + text
  LINE 7:     (ship_date + order_date) as o_s_delta,
                         ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:33:20.323958 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd85b51df-1ee3-4f39-ad93-2b693865cb4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E609BDF10>]}
[0m23:33:20.324959 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.12s]
[0m23:33:20.325958 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:33:20.422947 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:33:20.422947 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:33:20.426974 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:33:20.428962 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:33:20.428962 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:33:20.429965 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:33:20.430965 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:33:20.430965 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:33:20.431965 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:33:20.215442 => 2023-03-30 23:33:20.431965
[0m23:33:20.432963 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:33:20.245439 => 2023-03-30 23:33:20.432963
[0m23:33:20.432963 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:33:20.432963 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:33:20.433964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd85b51df-1ee3-4f39-ad93-2b693865cb4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5DC89950>]}
[0m23:33:20.433964 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd85b51df-1ee3-4f39-ad93-2b693865cb4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E60C16BD0>]}
[0m23:33:20.434961 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.23s]
[0m23:33:20.434961 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.23s]
[0m23:33:20.435963 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:33:20.435963 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:33:20.436965 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:33:20.437962 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:20.437962 [debug] [MainThread]: On master: BEGIN
[0m23:33:20.437962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:33:20.466304 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:33:20.467302 [debug] [MainThread]: On master: COMMIT
[0m23:33:20.467302 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:20.467302 [debug] [MainThread]: On master: COMMIT
[0m23:33:20.468302 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:33:20.468302 [debug] [MainThread]: On master: Close
[0m23:33:20.468302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:33:20.469303 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:33:20.469303 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:33:20.469303 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:33:20.469303 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:33:20.469303 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:33:20.470309 [info ] [MainThread]: 
[0m23:33:20.470309 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m23:33:20.471308 [debug] [MainThread]: Command end result
[0m23:33:20.476310 [info ] [MainThread]: 
[0m23:33:20.476310 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:33:20.477310 [info ] [MainThread]: 
[0m23:33:20.477310 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m23:33:20.478310 [error] [MainThread]:   operator does not exist: text + text
[0m23:33:20.478310 [error] [MainThread]:   LINE 7:     (ship_date + order_date) as o_s_delta,
[0m23:33:20.478310 [error] [MainThread]:                          ^
[0m23:33:20.479309 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m23:33:20.479309 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:33:20.479309 [info ] [MainThread]: 
[0m23:33:20.479309 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:33:20.480309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E60A23ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E604C3F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E608B7350>]}
[0m23:33:20.480309 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:34:00.769916 | f26d572e-d4a6-4e07-b8db-f51a824af0ad ==============================
[0m23:34:00.769916 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:34:00.770916 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:34:00.770916 [debug] [MainThread]: Tracking: tracking
[0m23:34:00.779532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF6C8C610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF69B3810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF71B8E10>]}
[0m23:34:00.787535 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:34:00.821046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:34:00.822046 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:34:00.833048 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:34:00.849045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f26d572e-d4a6-4e07-b8db-f51a824af0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF71B9A50>]}
[0m23:34:00.853049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f26d572e-d4a6-4e07-b8db-f51a824af0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF74FFC90>]}
[0m23:34:00.853049 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:34:00.854045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f26d572e-d4a6-4e07-b8db-f51a824af0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF6F57410>]}
[0m23:34:00.855046 [info ] [MainThread]: 
[0m23:34:00.856046 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:34:00.858047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:34:00.866046 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:34:00.866046 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:34:00.866046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:00.898050 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:34:00.899553 [debug] [ThreadPool]: On list_projeto: Close
[0m23:34:00.900562 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:34:00.905559 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:34:00.905559 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:34:00.905559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:00.934588 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:34:00.934588 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:34:00.934588 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:34:00.937587 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:34:00.938593 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:34:00.938593 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:34:00.943586 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:00.944588 [debug] [MainThread]: On master: BEGIN
[0m23:34:00.944588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:34:00.975186 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:34:00.975186 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:00.976185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:34:00.979185 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:34:00.981185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f26d572e-d4a6-4e07-b8db-f51a824af0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF7296350>]}
[0m23:34:00.981185 [debug] [MainThread]: On master: ROLLBACK
[0m23:34:00.982184 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:00.982184 [debug] [MainThread]: On master: BEGIN
[0m23:34:00.982184 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:34:00.982184 [debug] [MainThread]: On master: COMMIT
[0m23:34:00.983186 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:00.983186 [debug] [MainThread]: On master: COMMIT
[0m23:34:00.983186 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:34:00.983186 [debug] [MainThread]: On master: Close
[0m23:34:00.984186 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:34:00.984186 [info ] [MainThread]: 
[0m23:34:00.988191 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:34:00.988191 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:34:00.988191 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:34:00.989193 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:34:00.989193 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:34:00.989193 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:34:00.990192 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:34:00.990192 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:34:00.991193 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:34:00.991193 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:34:00.991193 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:34:00.992194 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:34:00.994196 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:34:00.995192 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:34:00.996195 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:34:00.997194 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:34:00.992194 => 2023-03-30 23:34:00.997194
[0m23:34:00.997194 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:34:00.997194 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:34:00.994196 => 2023-03-30 23:34:00.997194
[0m23:34:00.998195 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:34:00.995192 => 2023-03-30 23:34:00.998195
[0m23:34:01.027707 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:34:01.027707 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:34:01.028707 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:34:01.031705 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:34:01.031705 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:01.034710 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:34:01.035710 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:34:01.035710 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:01.035710 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:34:01.035710 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:34:01.036710 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:34:01.036710 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:34:01.036710 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:34:01.037710 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:34:01.069708 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:34:01.070707 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:01.070707 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:34:01.070707 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:34:01.071708 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:34:01.071708 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    (1 + 1) as o_s_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.ship_date > walmart.order_date and
walmart.order_id is not null
  );
[0m23:34:01.072707 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:34:01.077706 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:01.077706 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:34:01.077706 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:34:01.079710 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:34:01.080708 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2" rename to "view_2__dbt_backup"
[0m23:34:01.080708 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:34:01.082705 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:01.082705 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:34:01.082705 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:34:01.084710 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:34:01.084710 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m23:34:01.084710 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:34:01.093719 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:34:01.100230 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:34:01.101236 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:34:01.101236 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:01.102240 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:34:01.102240 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:34:01.102240 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:34:01.103456 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:34:01.103456 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m23:34:01.106468 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:01.108468 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:34:01.108468 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:34:01.108468 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m23:34:01.110469 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:34:01.110469 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m23:34:01.111471 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:34:01.028707 => 2023-03-30 23:34:01.111471
[0m23:34:01.112468 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:34:01.031705 => 2023-03-30 23:34:01.112468
[0m23:34:01.112468 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:34:01.112468 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:34:01.113469 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f26d572e-d4a6-4e07-b8db-f51a824af0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF7618B90>]}
[0m23:34:01.113469 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f26d572e-d4a6-4e07-b8db-f51a824af0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF75D1FD0>]}
[0m23:34:01.114475 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.12s]
[0m23:34:01.114475 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.12s]
[0m23:34:01.116469 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:34:01.116469 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:34:01.178037 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:34:01.178037 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:01.179031 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:34:01.180032 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:34:01.183031 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:01.183031 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:34:01.184035 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:34:01.185041 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:01.185041 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:34:01.186041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:34:01.187041 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:34:01.187041 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:01.188041 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:34:01.188679 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:34:01.190694 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:01.190694 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:34:01.192520 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:34:01.192520 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:34:00.998195 => 2023-03-30 23:34:01.192520
[0m23:34:01.193534 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:34:01.193534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f26d572e-d4a6-4e07-b8db-f51a824af0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF7657690>]}
[0m23:34:01.194534 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.20s]
[0m23:34:01.194534 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:34:01.195532 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:34:01.196532 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:01.196532 [debug] [MainThread]: On master: BEGIN
[0m23:34:01.196532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:34:01.225863 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:34:01.226876 [debug] [MainThread]: On master: COMMIT
[0m23:34:01.226876 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:01.226876 [debug] [MainThread]: On master: COMMIT
[0m23:34:01.226876 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:34:01.227879 [debug] [MainThread]: On master: Close
[0m23:34:01.227879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:01.227879 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:34:01.228878 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:34:01.228878 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:34:01.228878 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:34:01.228878 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:34:01.228878 [info ] [MainThread]: 
[0m23:34:01.229876 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m23:34:01.229876 [debug] [MainThread]: Command end result
[0m23:34:01.234878 [info ] [MainThread]: 
[0m23:34:01.234878 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:34:01.234878 [info ] [MainThread]: 
[0m23:34:01.235875 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:34:01.235875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF6D9C2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF7183510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF7182350>]}
[0m23:34:01.236877 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:34:24.348718 | 8ef7de94-d860-4ba0-a127-555248a45a77 ==============================
[0m23:34:24.348718 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:34:24.349717 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:34:24.350717 [debug] [MainThread]: Tracking: tracking
[0m23:34:24.358717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266BE7BE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266BE2C9210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266BE2CA1D0>]}
[0m23:34:24.365717 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:34:24.399721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:34:24.400721 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:34:24.410721 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:34:24.427230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ef7de94-d860-4ba0-a127-555248a45a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266BE2A4DD0>]}
[0m23:34:24.431230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ef7de94-d860-4ba0-a127-555248a45a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266BEB4EC10>]}
[0m23:34:24.431230 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:34:24.432230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ef7de94-d860-4ba0-a127-555248a45a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266BDFBEF10>]}
[0m23:34:24.433230 [info ] [MainThread]: 
[0m23:34:24.434231 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:34:24.436232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:34:24.444231 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:34:24.444231 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:34:24.445231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:24.477231 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:34:24.478231 [debug] [ThreadPool]: On list_projeto: Close
[0m23:34:24.480231 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:34:24.484230 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:34:24.484230 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:34:24.485230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:24.513235 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:34:24.513235 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:34:24.513235 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:34:24.516450 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:34:24.517450 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:34:24.517450 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:34:24.522450 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:24.522450 [debug] [MainThread]: On master: BEGIN
[0m23:34:24.523451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:34:24.552456 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:34:24.552456 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:24.552456 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:34:24.556451 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:34:24.557450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ef7de94-d860-4ba0-a127-555248a45a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266BE2B67D0>]}
[0m23:34:24.558452 [debug] [MainThread]: On master: ROLLBACK
[0m23:34:24.558452 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:24.558452 [debug] [MainThread]: On master: BEGIN
[0m23:34:24.559451 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:34:24.559451 [debug] [MainThread]: On master: COMMIT
[0m23:34:24.559451 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:24.559451 [debug] [MainThread]: On master: COMMIT
[0m23:34:24.560450 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:34:24.560450 [debug] [MainThread]: On master: Close
[0m23:34:24.560450 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:34:24.561451 [info ] [MainThread]: 
[0m23:34:24.564451 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:34:24.565450 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:34:24.565450 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:34:24.565450 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:34:24.566451 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:34:24.566451 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:34:24.567452 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:34:24.567452 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:34:24.567452 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:34:24.568450 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:34:24.568450 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:34:24.568450 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:34:24.570451 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:34:24.571450 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:34:24.573450 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:34:24.574452 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:34:24.568450 => 2023-03-30 23:34:24.573450
[0m23:34:24.574452 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:34:24.574452 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:34:24.570451 => 2023-03-30 23:34:24.574452
[0m23:34:24.587450 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:34:24.571450 => 2023-03-30 23:34:24.587450
[0m23:34:24.603460 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:34:24.603460 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:34:24.603460 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:34:24.607455 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:34:24.610455 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:34:24.610455 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:24.610455 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:34:24.611457 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:24.611457 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:34:24.611457 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:34:24.611457 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:34:24.612455 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:34:24.612455 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:34:24.612455 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:34:24.645691 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:34:24.645691 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:24.645691 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:34:24.645691 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:34:24.646693 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:24.646693 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:34:24.647696 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:34:24.647696 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:34:24.647696 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    (walmart.ship_date + walmart.order_date) as o_s_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.ship_date > walmart.order_date and
walmart.order_id is not null
  );
[0m23:34:24.647696 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:34:24.648694 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:34:24.653694 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:24.653694 [debug] [Thread-3 (]: Postgres adapter: Postgres error: operator does not exist: text + text
LINE 7:     (walmart.ship_date + walmart.order_date) as o_s_delta,
                               ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m23:34:24.655693 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:24.655693 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:34:24.655693 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m23:34:24.656693 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:34:24.656693 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:34:24.607455 => 2023-03-30 23:34:24.656693
[0m23:34:24.656693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:34:24.656693 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:34:24.657697 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:34:24.658693 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:24.661696 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:24.662693 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:34:24.662693 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:34:24.663698 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:34:24.663698 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:34:24.677694 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:34:24.679693 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:34:24.679693 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:24.680695 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:24.680695 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:34:24.680695 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:34:24.682696 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  operator does not exist: text + text
  LINE 7:     (walmart.ship_date + walmart.order_date) as o_s_delta,
                                 ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:34:24.682696 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:34:24.682696 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ef7de94-d860-4ba0-a127-555248a45a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266BEC5AD10>]}
[0m23:34:24.682696 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:34:24.686694 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:24.687693 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.12s]
[0m23:34:24.689693 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:24.689693 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:34:24.690693 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:34:24.691693 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:34:24.692695 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:34:24.692695 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:34:24.693696 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:34:24.574452 => 2023-03-30 23:34:24.693696
[0m23:34:24.694695 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:34:24.604456 => 2023-03-30 23:34:24.694695
[0m23:34:24.694695 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:34:24.695693 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:34:24.695693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ef7de94-d860-4ba0-a127-555248a45a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266BEB794D0>]}
[0m23:34:24.696700 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ef7de94-d860-4ba0-a127-555248a45a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266BE2B6790>]}
[0m23:34:24.696700 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:34:24.697693 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:34:24.697693 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:34:24.697693 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:34:24.699700 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:34:24.699700 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:24.699700 [debug] [MainThread]: On master: BEGIN
[0m23:34:24.700698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:34:24.729210 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:34:24.730209 [debug] [MainThread]: On master: COMMIT
[0m23:34:24.730209 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:24.730209 [debug] [MainThread]: On master: COMMIT
[0m23:34:24.731207 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:34:24.731207 [debug] [MainThread]: On master: Close
[0m23:34:24.731207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:24.732213 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:34:24.732213 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:34:24.732213 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:34:24.732213 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:34:24.733211 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:34:24.733211 [info ] [MainThread]: 
[0m23:34:24.733211 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m23:34:24.734213 [debug] [MainThread]: Command end result
[0m23:34:24.739207 [info ] [MainThread]: 
[0m23:34:24.739207 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:34:24.740207 [info ] [MainThread]: 
[0m23:34:24.740207 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m23:34:24.741207 [error] [MainThread]:   operator does not exist: text + text
[0m23:34:24.741207 [error] [MainThread]:   LINE 7:     (walmart.ship_date + walmart.order_date) as o_s_delta,
[0m23:34:24.741207 [error] [MainThread]:                                  ^
[0m23:34:24.742207 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m23:34:24.742207 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:34:24.742207 [info ] [MainThread]: 
[0m23:34:24.742207 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:34:24.743207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266BE7BE3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266BE77BAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266BE00C990>]}
[0m23:34:24.743207 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:34:44.610492 | 1a1c5167-3961-41be-bc96-10ecc9b519e3 ==============================
[0m23:34:44.610492 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:34:44.612491 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:34:44.612491 [debug] [MainThread]: Tracking: tracking
[0m23:34:44.621013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002153DA2C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002153DB153D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002153DB814D0>]}
[0m23:34:44.628011 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:34:44.662011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:34:44.663011 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:34:44.673010 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:34:44.689010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a1c5167-3961-41be-bc96-10ecc9b519e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002153E61F810>]}
[0m23:34:44.694012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a1c5167-3961-41be-bc96-10ecc9b519e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002153E62CFD0>]}
[0m23:34:44.695013 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:34:44.695013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a1c5167-3961-41be-bc96-10ecc9b519e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002153E257ED0>]}
[0m23:34:44.696010 [info ] [MainThread]: 
[0m23:34:44.698013 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:34:44.699012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:34:44.708015 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:34:44.708015 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:34:44.708015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:44.743542 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:34:44.744539 [debug] [ThreadPool]: On list_projeto: Close
[0m23:34:44.746542 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:34:44.751538 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:34:44.751538 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:34:44.751538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:44.781020 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:34:44.781020 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:34:44.781020 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:34:44.784048 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:34:44.785048 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:34:44.785048 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:34:44.790035 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:44.790035 [debug] [MainThread]: On master: BEGIN
[0m23:34:44.791035 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:34:44.819039 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:34:44.819039 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:44.819039 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:34:44.823355 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:34:44.824355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a1c5167-3961-41be-bc96-10ecc9b519e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002153E2AA750>]}
[0m23:34:44.824355 [debug] [MainThread]: On master: ROLLBACK
[0m23:34:44.825355 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:44.825355 [debug] [MainThread]: On master: BEGIN
[0m23:34:44.825355 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:34:44.826360 [debug] [MainThread]: On master: COMMIT
[0m23:34:44.826360 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:44.826360 [debug] [MainThread]: On master: COMMIT
[0m23:34:44.826360 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:34:44.827355 [debug] [MainThread]: On master: Close
[0m23:34:44.827355 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:34:44.828359 [info ] [MainThread]: 
[0m23:34:44.831355 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:34:44.832355 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:34:44.832355 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:34:44.832355 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:34:44.833356 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:34:44.833356 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:34:44.834357 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:34:44.834357 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:34:44.834357 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:34:44.835355 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:34:44.835355 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:34:44.835355 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:34:44.837356 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:34:44.838355 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:34:44.840355 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:34:44.840355 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:34:44.835355 => 2023-03-30 23:34:44.840355
[0m23:34:44.841357 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:34:44.841357 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:34:44.837356 => 2023-03-30 23:34:44.841357
[0m23:34:44.851355 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:34:44.838355 => 2023-03-30 23:34:44.851355
[0m23:34:44.869731 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:34:44.870732 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:34:44.870732 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:34:44.873730 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:34:44.876729 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:34:44.876729 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:44.877731 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:34:44.877731 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:44.877731 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:34:44.877731 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:34:44.878730 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:34:44.878730 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:34:44.878730 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:34:44.878730 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:34:44.910739 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:34:44.911739 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:44.911739 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:34:44.912741 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:34:44.912741 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:44.913744 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:34:44.913744 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:34:44.917740 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:44.919247 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:34:44.919247 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:34:44.919247 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:34:44.919247 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:34:44.921252 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:44.922252 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    (float(walmart.ship_date) + float(walmart.order_date)) as o_s_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.ship_date > walmart.order_date and
walmart.order_id is not null
  );
[0m23:34:44.922252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:34:44.922252 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:34:44.924253 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:44.924253 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "walmart"
LINE 7:     (float(walmart.ship_date) + float(walmart.order_date)) a...
                   ^

[0m23:34:44.925257 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:34:44.925257 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:34:44.925257 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m23:34:44.927252 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:44.927252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:34:44.927252 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:34:44.873730 => 2023-03-30 23:34:44.927252
[0m23:34:44.928253 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:34:44.942252 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:34:44.942252 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:34:44.942877 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:44.942877 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:34:44.944890 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:34:44.945890 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:34:44.946889 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:44.946889 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:34:44.946889 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:34:44.950891 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:34:44.951889 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:34:44.951889 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:34:44.953889 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:34:44.953889 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:34:44.954890 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:34:44.955890 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  syntax error at or near "walmart"
  LINE 7:     (float(walmart.ship_date) + float(walmart.order_date)) a...
                     ^
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:34:44.955890 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:34:44.956889 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:34:44.841357 => 2023-03-30 23:34:44.956889
[0m23:34:44.956889 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a1c5167-3961-41be-bc96-10ecc9b519e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002153E64DA90>]}
[0m23:34:44.957889 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:34:44.870732 => 2023-03-30 23:34:44.957889
[0m23:34:44.957889 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:34:44.958889 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.12s]
[0m23:34:44.958889 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:34:44.959890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a1c5167-3961-41be-bc96-10ecc9b519e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002153E2AA190>]}
[0m23:34:44.960891 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:34:44.961892 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a1c5167-3961-41be-bc96-10ecc9b519e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002153E5C1250>]}
[0m23:34:44.961892 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:34:44.962890 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:34:44.962890 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:34:44.962890 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:34:44.964890 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:34:44.964890 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:44.964890 [debug] [MainThread]: On master: BEGIN
[0m23:34:44.964890 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:34:44.993894 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:34:44.994891 [debug] [MainThread]: On master: COMMIT
[0m23:34:44.994891 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:44.994891 [debug] [MainThread]: On master: COMMIT
[0m23:34:44.995889 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:34:44.995889 [debug] [MainThread]: On master: Close
[0m23:34:44.996891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:44.996891 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:34:44.996891 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:34:44.996891 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:34:44.997889 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:34:44.997889 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:34:44.997889 [info ] [MainThread]: 
[0m23:34:44.997889 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m23:34:44.998889 [debug] [MainThread]: Command end result
[0m23:34:45.003888 [info ] [MainThread]: 
[0m23:34:45.004895 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:34:45.004895 [info ] [MainThread]: 
[0m23:34:45.004895 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m23:34:45.005894 [error] [MainThread]:   syntax error at or near "walmart"
[0m23:34:45.005894 [error] [MainThread]:   LINE 7:     (float(walmart.ship_date) + float(walmart.order_date)) a...
[0m23:34:45.005894 [error] [MainThread]:                      ^
[0m23:34:45.006895 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:34:45.006895 [info ] [MainThread]: 
[0m23:34:45.006895 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:34:45.007894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002153E34F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002153E27ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002153E2A9E50>]}
[0m23:34:45.007894 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:35:25.288401 | 29a77be3-2b85-4692-8365-24ef92fde7ce ==============================
[0m23:35:25.288401 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:35:25.290402 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:35:25.290402 [debug] [MainThread]: Tracking: tracking
[0m23:35:25.298403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FC5F2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FCADAD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FCB94AD0>]}
[0m23:35:25.306403 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:35:25.341409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:35:25.341409 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:35:25.351919 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:35:25.367921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29a77be3-2b85-4692-8365-24ef92fde7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FCE5E850>]}
[0m23:35:25.371921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29a77be3-2b85-4692-8365-24ef92fde7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FCA9EE10>]}
[0m23:35:25.372921 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:35:25.372921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29a77be3-2b85-4692-8365-24ef92fde7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FCB8B910>]}
[0m23:35:25.373920 [info ] [MainThread]: 
[0m23:35:25.375921 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:35:25.376921 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:35:25.384919 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:35:25.385919 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:35:25.385919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:25.418022 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:35:25.419023 [debug] [ThreadPool]: On list_projeto: Close
[0m23:35:25.420028 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:35:25.425020 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:35:25.425020 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:35:25.425020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:25.454534 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:35:25.454534 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:35:25.454534 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:35:25.457535 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:35:25.458535 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:35:25.458535 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:35:25.463535 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:25.464536 [debug] [MainThread]: On master: BEGIN
[0m23:35:25.464536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:35:25.493534 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:35:25.493534 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:25.493534 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:35:25.497533 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:35:25.498537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29a77be3-2b85-4692-8365-24ef92fde7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FCADBB90>]}
[0m23:35:25.499535 [debug] [MainThread]: On master: ROLLBACK
[0m23:35:25.499535 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:25.499535 [debug] [MainThread]: On master: BEGIN
[0m23:35:25.500534 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:35:25.500534 [debug] [MainThread]: On master: COMMIT
[0m23:35:25.500534 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:25.500534 [debug] [MainThread]: On master: COMMIT
[0m23:35:25.501534 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:35:25.501534 [debug] [MainThread]: On master: Close
[0m23:35:25.501534 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:35:25.502535 [info ] [MainThread]: 
[0m23:35:25.506533 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:35:25.506533 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:35:25.506533 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:35:25.506533 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:35:25.507535 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:35:25.507535 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:35:25.508538 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:35:25.508538 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:35:25.509538 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:35:25.509538 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:35:25.509538 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:35:25.509538 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:35:25.511538 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:35:25.513534 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:35:25.514539 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:35:25.515535 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:35:25.510537 => 2023-03-30 23:35:25.515535
[0m23:35:25.515535 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:35:25.515535 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:35:25.512538 => 2023-03-30 23:35:25.515535
[0m23:35:25.516535 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:35:25.513534 => 2023-03-30 23:35:25.516535
[0m23:35:25.544546 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:35:25.545545 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:35:25.545545 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:35:25.548570 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:35:25.551566 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:35:25.551566 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:35:25.552571 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:35:25.552571 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:35:25.552571 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:35:25.553568 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:35:25.553568 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:35:25.553568 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:35:25.554571 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:35:25.554571 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:35:25.586566 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:35:25.587566 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:35:25.587566 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:35:25.587566 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:35:25.587566 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:35:25.588567 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:35:25.588567 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:35:25.589568 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:35:25.594566 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:35:25.594566 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:35:25.594566 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:35:25.594566 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:35:25.596569 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:35:25.596569 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    (date(walmart.ship_date) + date(walmart.order_date)) as o_s_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.ship_date > walmart.order_date and
walmart.order_id is not null
  );
[0m23:35:25.597569 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:35:25.597569 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:35:25.599567 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:35:25.600568 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:35:25.600568 [debug] [Thread-3 (]: Postgres adapter: Postgres error: operator does not exist: date + date
LINE 7:     (date(walmart.ship_date) + date(walmart.order_date)) as ...
                                     ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m23:35:25.600568 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:35:25.602566 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:35:25.602566 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m23:35:25.602566 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:35:25.603572 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:35:25.603572 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:35:25.548570 => 2023-03-30 23:35:25.603572
[0m23:35:25.609566 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:35:25.618566 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:35:25.619161 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:35:25.620190 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:35:25.621177 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:35:25.622177 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:35:25.622177 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:35:25.622177 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:35:25.623177 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:35:25.623177 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:35:25.628175 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:35:25.629177 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:35:25.630175 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:35:25.630175 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:35:25.631181 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  operator does not exist: date + date
  LINE 7:     (date(walmart.ship_date) + date(walmart.order_date)) as ...
                                       ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:35:25.632182 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:35:25.632182 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:35:25.632182 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29a77be3-2b85-4692-8365-24ef92fde7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FCEA5510>]}
[0m23:35:25.633181 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:35:25.516535 => 2023-03-30 23:35:25.633181
[0m23:35:25.634181 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:35:25.545545 => 2023-03-30 23:35:25.634181
[0m23:35:25.635180 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:35:25.634181 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.12s]
[0m23:35:25.635180 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:35:25.635180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29a77be3-2b85-4692-8365-24ef92fde7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FCAE5390>]}
[0m23:35:25.637182 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:35:25.637694 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29a77be3-2b85-4692-8365-24ef92fde7ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FCEEF950>]}
[0m23:35:25.637694 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:35:25.638707 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:35:25.638707 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:35:25.639706 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:35:25.640708 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:35:25.640708 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:25.640708 [debug] [MainThread]: On master: BEGIN
[0m23:35:25.641705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:35:25.771540 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:35:25.772540 [debug] [MainThread]: On master: COMMIT
[0m23:35:25.772540 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:25.772540 [debug] [MainThread]: On master: COMMIT
[0m23:35:25.773540 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:35:25.773540 [debug] [MainThread]: On master: Close
[0m23:35:25.773540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:25.774540 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:35:25.774540 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:35:25.774540 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:35:25.774540 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:35:25.774540 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:35:25.775541 [info ] [MainThread]: 
[0m23:35:25.775541 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m23:35:25.775541 [debug] [MainThread]: Command end result
[0m23:35:25.781540 [info ] [MainThread]: 
[0m23:35:25.781540 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:35:25.781540 [info ] [MainThread]: 
[0m23:35:25.782542 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m23:35:25.782542 [error] [MainThread]:   operator does not exist: date + date
[0m23:35:25.782542 [error] [MainThread]:   LINE 7:     (date(walmart.ship_date) + date(walmart.order_date)) as ...
[0m23:35:25.783541 [error] [MainThread]:                                        ^
[0m23:35:25.783541 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m23:35:25.783541 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:35:25.784541 [info ] [MainThread]: 
[0m23:35:25.784541 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:35:25.784541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FC6001D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FC57FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FC30E6D0>]}
[0m23:35:25.785539 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:36:15.970012 | f36fbe26-db9c-4c40-bf0a-824135c7f54f ==============================
[0m23:36:15.970012 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:36:15.972012 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:36:15.972012 [debug] [MainThread]: Tracking: tracking
[0m23:36:15.980288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290ED86A450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290ECFE4A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290EA714CD0>]}
[0m23:36:15.988276 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:36:16.022276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:36:16.022276 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:36:16.033277 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:36:16.049276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f36fbe26-db9c-4c40-bf0a-824135c7f54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290EDB63D50>]}
[0m23:36:16.053276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f36fbe26-db9c-4c40-bf0a-824135c7f54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290EDAC7C10>]}
[0m23:36:16.054276 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:36:16.054276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f36fbe26-db9c-4c40-bf0a-824135c7f54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290ED71F8D0>]}
[0m23:36:16.055276 [info ] [MainThread]: 
[0m23:36:16.057276 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:36:16.058281 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:36:16.066281 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:36:16.067284 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:36:16.067284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:16.199135 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:36:16.201131 [debug] [ThreadPool]: On list_projeto: Close
[0m23:36:16.202136 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:36:16.207131 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:36:16.207131 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:36:16.207131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:16.236758 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:36:16.236758 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:36:16.236758 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:36:16.239774 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:36:16.240771 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:36:16.240771 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:36:16.245776 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:16.245776 [debug] [MainThread]: On master: BEGIN
[0m23:36:16.246777 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:36:16.274286 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:36:16.275287 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:16.275287 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:36:16.278286 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:36:16.280288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f36fbe26-db9c-4c40-bf0a-824135c7f54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290ED897310>]}
[0m23:36:16.280288 [debug] [MainThread]: On master: ROLLBACK
[0m23:36:16.281286 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:16.281286 [debug] [MainThread]: On master: BEGIN
[0m23:36:16.281286 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:36:16.282294 [debug] [MainThread]: On master: COMMIT
[0m23:36:16.282294 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:16.282294 [debug] [MainThread]: On master: COMMIT
[0m23:36:16.282294 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:36:16.283290 [debug] [MainThread]: On master: Close
[0m23:36:16.283290 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:36:16.284287 [info ] [MainThread]: 
[0m23:36:16.287287 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:36:16.287287 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:36:16.287287 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:36:16.288287 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:36:16.288287 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:36:16.289288 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:36:16.289288 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:36:16.290286 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:36:16.290286 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:36:16.290286 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:36:16.291286 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:36:16.291286 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:36:16.293286 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:36:16.294286 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:36:16.295286 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:36:16.296295 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:36:16.291286 => 2023-03-30 23:36:16.296295
[0m23:36:16.297288 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:36:16.293286 => 2023-03-30 23:36:16.297288
[0m23:36:16.297288 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:36:16.297288 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:36:16.294286 => 2023-03-30 23:36:16.297288
[0m23:36:16.297288 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:36:16.326286 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:36:16.326286 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:36:16.330288 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:36:16.333286 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:36:16.333286 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:36:16.334287 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:36:16.334287 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:36:16.334287 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:36:16.334287 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:36:16.335287 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:36:16.335287 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:36:16.335287 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:36:16.336287 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:36:16.368296 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:36:16.368296 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:36:16.368296 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:36:16.369298 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:36:16.369298 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:36:16.369298 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:36:16.370297 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:36:16.374803 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:36:16.375805 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:36:16.375805 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:36:16.375805 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:36:16.377803 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:36:16.377803 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:36:16.378805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:36:16.378805 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:36:16.378805 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    DATEDIFF(DAYS, date(walmart.ship_date) , date(walmart.order_date)) as o_s_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.ship_date > walmart.order_date and
walmart.order_id is not null
  );
[0m23:36:16.380803 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:36:16.380803 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:36:16.381806 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:36:16.381806 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "days" does not exist
LINE 7:     DATEDIFF(DAYS, date(walmart.ship_date) , date(walmart.or...
                     ^

[0m23:36:16.382806 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:36:16.383806 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m23:36:16.383806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:36:16.383806 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:36:16.384807 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:36:16.330288 => 2023-03-30 23:36:16.384807
[0m23:36:16.398803 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:36:16.399810 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:36:16.400028 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:36:16.400028 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:36:16.402041 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:36:16.403045 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:36:16.403045 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:36:16.403045 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:36:16.404044 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:36:16.408041 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:36:16.408041 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:36:16.408041 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:36:16.410045 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:36:16.411044 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:36:16.411044 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:36:16.412043 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  column "days" does not exist
  LINE 7:     DATEDIFF(DAYS, date(walmart.ship_date) , date(walmart.or...
                       ^
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:36:16.412043 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:36:16.413041 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:36:16.297288 => 2023-03-30 23:36:16.413041
[0m23:36:16.414041 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f36fbe26-db9c-4c40-bf0a-824135c7f54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290EDC1C090>]}
[0m23:36:16.415046 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:36:16.327289 => 2023-03-30 23:36:16.415046
[0m23:36:16.415046 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:36:16.415046 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:36:16.415046 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.12s]
[0m23:36:16.416044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f36fbe26-db9c-4c40-bf0a-824135c7f54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290EDBB6C50>]}
[0m23:36:16.417042 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f36fbe26-db9c-4c40-bf0a-824135c7f54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290ED86F910>]}
[0m23:36:16.418041 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:36:16.418041 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:36:16.419044 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:36:16.419044 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:36:16.420043 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:36:16.421041 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:36:16.421041 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:16.421041 [debug] [MainThread]: On master: BEGIN
[0m23:36:16.422040 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:36:16.451042 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:36:16.452041 [debug] [MainThread]: On master: COMMIT
[0m23:36:16.452041 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:16.452041 [debug] [MainThread]: On master: COMMIT
[0m23:36:16.453042 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:36:16.453042 [debug] [MainThread]: On master: Close
[0m23:36:16.454040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:16.454040 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:36:16.454040 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:36:16.454040 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:36:16.454040 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:36:16.454040 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:36:16.455041 [info ] [MainThread]: 
[0m23:36:16.455041 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m23:36:16.456041 [debug] [MainThread]: Command end result
[0m23:36:16.461045 [info ] [MainThread]: 
[0m23:36:16.461045 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:36:16.462045 [info ] [MainThread]: 
[0m23:36:16.462045 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m23:36:16.463045 [error] [MainThread]:   column "days" does not exist
[0m23:36:16.463045 [error] [MainThread]:   LINE 7:     DATEDIFF(DAYS, date(walmart.ship_date) , date(walmart.or...
[0m23:36:16.463045 [error] [MainThread]:                        ^
[0m23:36:16.464046 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:36:16.464046 [info ] [MainThread]: 
[0m23:36:16.464046 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:36:16.465045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290ED71F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290ECCE4A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290ED021810>]}
[0m23:36:16.465045 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:36:54.715269 | 527f3235-27c3-439c-91dc-14d90c674f7d ==============================
[0m23:36:54.715269 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:36:54.716269 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:36:54.717270 [debug] [MainThread]: Tracking: tracking
[0m23:36:54.725274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CB78E2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CBE5C1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CBF2DDD0>]}
[0m23:36:54.733270 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:36:54.768270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:36:54.768270 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:36:54.779271 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:36:54.795277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '527f3235-27c3-439c-91dc-14d90c674f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CBE942D0>]}
[0m23:36:54.800280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '527f3235-27c3-439c-91dc-14d90c674f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CB9A1FD0>]}
[0m23:36:54.801275 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:36:54.801275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '527f3235-27c3-439c-91dc-14d90c674f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CB9FBC90>]}
[0m23:36:54.802274 [info ] [MainThread]: 
[0m23:36:54.804281 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:36:54.805275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:36:54.813786 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:36:54.813786 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:36:54.814788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:54.846792 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:36:54.847790 [debug] [ThreadPool]: On list_projeto: Close
[0m23:36:54.849791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:36:54.853787 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:36:54.853787 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:36:54.854789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:54.996461 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:36:54.996461 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:36:54.997462 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:36:54.999461 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:36:55.000464 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:36:55.000464 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:36:55.005968 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:55.005968 [debug] [MainThread]: On master: BEGIN
[0m23:36:55.005968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:36:55.034978 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:36:55.035974 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:55.035974 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:36:55.038978 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:36:55.040976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '527f3235-27c3-439c-91dc-14d90c674f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CB6E35D0>]}
[0m23:36:55.040976 [debug] [MainThread]: On master: ROLLBACK
[0m23:36:55.041976 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:55.041976 [debug] [MainThread]: On master: BEGIN
[0m23:36:55.041976 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:36:55.041976 [debug] [MainThread]: On master: COMMIT
[0m23:36:55.042973 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:55.042973 [debug] [MainThread]: On master: COMMIT
[0m23:36:55.042973 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:36:55.042973 [debug] [MainThread]: On master: Close
[0m23:36:55.043975 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:36:55.043975 [info ] [MainThread]: 
[0m23:36:55.048452 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:36:55.048452 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:36:55.048452 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:36:55.049450 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:36:55.049450 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:36:55.049450 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:36:55.050450 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:36:55.050450 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:36:55.051449 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:36:55.051449 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:36:55.051449 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:36:55.052451 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:36:55.054449 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:36:55.055450 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:36:55.057449 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:36:55.057449 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:36:55.052451 => 2023-03-30 23:36:55.057449
[0m23:36:55.058450 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:36:55.054449 => 2023-03-30 23:36:55.058450
[0m23:36:55.058450 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:36:55.058450 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:36:55.055450 => 2023-03-30 23:36:55.058450
[0m23:36:55.058450 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:36:55.087448 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:36:55.087448 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:36:55.091451 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:36:55.094453 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:36:55.094453 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:36:55.095453 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:36:55.095453 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:36:55.095453 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:36:55.096452 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:36:55.096452 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:36:55.096452 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:36:55.097452 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:36:55.097452 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:36:55.129967 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:36:55.130969 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:36:55.130969 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:36:55.130969 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:36:55.130969 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:36:55.131968 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:36:55.132970 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:36:55.132970 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:36:55.132970 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    DATEDIFF(DAY, date(walmart.ship_date) , date(walmart.order_date)) as o_s_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.ship_date > walmart.order_date and
walmart.order_id is not null
  );
[0m23:36:55.133970 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "day" does not exist
LINE 7:     DATEDIFF(DAY, date(walmart.ship_date) , date(walmart.ord...
                     ^

[0m23:36:55.133970 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m23:36:55.133970 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:36:55.091451 => 2023-03-30 23:36:55.133970
[0m23:36:55.133970 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:36:55.133970 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:36:55.134967 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:36:55.139968 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:36:55.141966 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:36:55.142968 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:36:55.142968 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:36:55.143968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:36:55.143968 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:36:55.146966 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:36:55.148968 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:36:55.148968 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:36:55.148968 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:36:55.149967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:36:55.149967 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:36:55.150967 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  column "day" does not exist
  LINE 7:     DATEDIFF(DAY, date(walmart.ship_date) , date(walmart.ord...
                       ^
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:36:55.165966 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:36:55.166969 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:36:55.167826 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527f3235-27c3-439c-91dc-14d90c674f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CC286150>]}
[0m23:36:55.167826 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:36:55.167826 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:36:55.168842 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:36:55.168842 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.12s]
[0m23:36:55.168842 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:36:55.170841 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:36:55.170841 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:36:55.170841 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:36:55.174841 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:36:55.176860 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:36:55.176860 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:36:55.176860 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:36:55.178844 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:36:55.178844 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:36:55.179840 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:36:55.088463 => 2023-03-30 23:36:55.179840
[0m23:36:55.180840 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:36:55.058450 => 2023-03-30 23:36:55.180840
[0m23:36:55.180840 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:36:55.180840 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:36:55.181840 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527f3235-27c3-439c-91dc-14d90c674f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CC267790>]}
[0m23:36:55.182840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527f3235-27c3-439c-91dc-14d90c674f7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CC29F610>]}
[0m23:36:55.182840 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:36:55.183840 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:36:55.183840 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:36:55.183840 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:36:55.185843 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:36:55.185843 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:55.185843 [debug] [MainThread]: On master: BEGIN
[0m23:36:55.185843 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:36:55.325670 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:36:55.325670 [debug] [MainThread]: On master: COMMIT
[0m23:36:55.326678 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:55.326678 [debug] [MainThread]: On master: COMMIT
[0m23:36:55.326678 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:36:55.327674 [debug] [MainThread]: On master: Close
[0m23:36:55.327674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:55.328674 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:36:55.328674 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:36:55.328674 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:36:55.328674 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:36:55.328674 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:36:55.328674 [info ] [MainThread]: 
[0m23:36:55.329671 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m23:36:55.329671 [debug] [MainThread]: Command end result
[0m23:36:55.335677 [info ] [MainThread]: 
[0m23:36:55.335677 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:36:55.335677 [info ] [MainThread]: 
[0m23:36:55.336676 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m23:36:55.336676 [error] [MainThread]:   column "day" does not exist
[0m23:36:55.337674 [error] [MainThread]:   LINE 7:     DATEDIFF(DAY, date(walmart.ship_date) , date(walmart.ord...
[0m23:36:55.337674 [error] [MainThread]:                        ^
[0m23:36:55.337674 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:36:55.337674 [info ] [MainThread]: 
[0m23:36:55.338671 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:36:55.338671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CBD95D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CBE7BCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267CBF66E10>]}
[0m23:36:55.338671 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:37:02.858978 | 390edfe2-28e0-46d2-808a-44e48b92af7e ==============================
[0m23:37:02.858978 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:37:02.860979 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:37:02.860979 [debug] [MainThread]: Tracking: tracking
[0m23:37:02.868979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9870D9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C986B40710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C987036F50>]}
[0m23:37:02.876978 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:37:02.910986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:37:02.910986 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:37:02.921497 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:37:02.937497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '390edfe2-28e0-46d2-808a-44e48b92af7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C98685EDD0>]}
[0m23:37:02.941496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '390edfe2-28e0-46d2-808a-44e48b92af7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C98742B410>]}
[0m23:37:02.942496 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:37:02.942496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '390edfe2-28e0-46d2-808a-44e48b92af7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C986FD7BD0>]}
[0m23:37:02.943504 [info ] [MainThread]: 
[0m23:37:02.945502 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:37:02.946498 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:37:02.954496 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:37:02.955496 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:37:02.955496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:02.987880 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:37:02.988881 [debug] [ThreadPool]: On list_projeto: Close
[0m23:37:02.989879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:37:02.994883 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:37:02.994883 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:37:02.994883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:03.024141 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:37:03.024141 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:37:03.024141 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:37:03.027142 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:37:03.028143 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:37:03.028143 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:37:03.033142 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:03.033142 [debug] [MainThread]: On master: BEGIN
[0m23:37:03.034142 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:37:03.063141 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:37:03.063141 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:03.063141 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:37:03.067140 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:37:03.069142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '390edfe2-28e0-46d2-808a-44e48b92af7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C987103010>]}
[0m23:37:03.069142 [debug] [MainThread]: On master: ROLLBACK
[0m23:37:03.069971 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:03.069971 [debug] [MainThread]: On master: BEGIN
[0m23:37:03.069971 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:37:03.070989 [debug] [MainThread]: On master: COMMIT
[0m23:37:03.070989 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:03.070989 [debug] [MainThread]: On master: COMMIT
[0m23:37:03.070989 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:37:03.071987 [debug] [MainThread]: On master: Close
[0m23:37:03.071987 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:37:03.072988 [info ] [MainThread]: 
[0m23:37:03.075986 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:37:03.075986 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:37:03.076986 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:37:03.076986 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:37:03.076986 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:37:03.077990 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:37:03.077990 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:37:03.078986 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:37:03.078986 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:37:03.078986 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:37:03.079987 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:37:03.079987 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:37:03.081986 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:37:03.082985 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:37:03.083985 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:37:03.084985 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:37:03.079987 => 2023-03-30 23:37:03.084985
[0m23:37:03.084985 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:37:03.081986 => 2023-03-30 23:37:03.084985
[0m23:37:03.085990 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:37:03.085990 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:37:03.085990 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:37:03.082985 => 2023-03-30 23:37:03.085990
[0m23:37:03.116504 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:37:03.120504 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:37:03.120504 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:37:03.123504 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:37:03.124505 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:37:03.124505 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:37:03.124505 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:37:03.125511 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:37:03.125511 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:37:03.125511 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:37:03.125511 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:37:03.125511 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:37:03.126506 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:37:03.158504 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:37:03.159505 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:37:03.159505 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:37:03.159505 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:37:03.160509 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:37:03.160509 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:37:03.161507 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:37:03.166504 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:37:03.166504 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:37:03.166504 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:37:03.166504 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:37:03.167504 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:37:03.169506 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:37:03.169506 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    DATEDIFF(date(walmart.ship_date) , date(walmart.order_date)) as o_s_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.ship_date > walmart.order_date and
walmart.order_id is not null
  );
[0m23:37:03.169506 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:37:03.169506 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:37:03.171510 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:37:03.171510 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function datediff(date, date) does not exist
LINE 7:     DATEDIFF(date(walmart.ship_date) , date(walmart.order_da...
            ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m23:37:03.172507 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:37:03.172507 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:37:03.172507 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m23:37:03.174505 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:37:03.174505 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:37:03.175505 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:37:03.121507 => 2023-03-30 23:37:03.175505
[0m23:37:03.175505 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:37:03.189504 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:37:03.190504 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:37:03.190504 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:37:03.190504 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:37:03.191506 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:37:03.193505 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:37:03.194508 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:37:03.194508 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:37:03.194508 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:37:03.198511 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:37:03.199515 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:37:03.199515 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:37:03.201509 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:37:03.201509 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:37:03.201509 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:37:03.202510 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:37:03.085990 => 2023-03-30 23:37:03.202510
[0m23:37:03.203511 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  function datediff(date, date) does not exist
  LINE 7:     DATEDIFF(date(walmart.ship_date) , date(walmart.order_da...
              ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:37:03.203511 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:37:03.204509 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:37:03.204509 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390edfe2-28e0-46d2-808a-44e48b92af7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C9873BD0D0>]}
[0m23:37:03.205509 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:37:03.117504 => 2023-03-30 23:37:03.205509
[0m23:37:03.205509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390edfe2-28e0-46d2-808a-44e48b92af7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C987347310>]}
[0m23:37:03.206509 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.13s]
[0m23:37:03.206509 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:37:03.206509 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:37:03.208510 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:37:03.208510 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390edfe2-28e0-46d2-808a-44e48b92af7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C98744EF10>]}
[0m23:37:03.209514 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:37:03.209514 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:37:03.210515 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:37:03.210515 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:37:03.212021 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:03.212021 [debug] [MainThread]: On master: BEGIN
[0m23:37:03.212021 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:37:03.352879 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:37:03.353879 [debug] [MainThread]: On master: COMMIT
[0m23:37:03.353879 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:03.353879 [debug] [MainThread]: On master: COMMIT
[0m23:37:03.354877 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:37:03.354877 [debug] [MainThread]: On master: Close
[0m23:37:03.355882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:03.355882 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:37:03.355882 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:37:03.355882 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:37:03.355882 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:37:03.356882 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:37:03.356882 [info ] [MainThread]: 
[0m23:37:03.356882 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m23:37:03.357878 [debug] [MainThread]: Command end result
[0m23:37:03.362878 [info ] [MainThread]: 
[0m23:37:03.363880 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:37:03.363880 [info ] [MainThread]: 
[0m23:37:03.363880 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m23:37:03.364880 [error] [MainThread]:   function datediff(date, date) does not exist
[0m23:37:03.364880 [error] [MainThread]:   LINE 7:     DATEDIFF(date(walmart.ship_date) , date(walmart.order_da...
[0m23:37:03.365879 [error] [MainThread]:               ^
[0m23:37:03.365879 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m23:37:03.365879 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:37:03.365879 [info ] [MainThread]: 
[0m23:37:03.366880 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:37:03.366880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C986BEAB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C986A47350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C987519990>]}
[0m23:37:03.366880 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:37:36.246609 | ddf793d6-ced8-4a94-88e7-0e27dcc7aa26 ==============================
[0m23:37:36.246609 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:37:36.248609 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:37:36.248609 [debug] [MainThread]: Tracking: tracking
[0m23:37:36.257611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020640EC3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064171AED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020641718990>]}
[0m23:37:36.265613 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:37:36.300609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:37:36.300609 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:37:36.311610 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:37:36.328122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddf793d6-ced8-4a94-88e7-0e27dcc7aa26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020641156A10>]}
[0m23:37:36.333127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddf793d6-ced8-4a94-88e7-0e27dcc7aa26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206419A9C50>]}
[0m23:37:36.333127 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:37:36.333127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddf793d6-ced8-4a94-88e7-0e27dcc7aa26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020640F4B250>]}
[0m23:37:36.335126 [info ] [MainThread]: 
[0m23:37:36.336132 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:37:36.338140 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:37:36.347131 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:37:36.347131 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:37:36.347131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:36.485448 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:37:36.486449 [debug] [ThreadPool]: On list_projeto: Close
[0m23:37:36.487648 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:37:36.492664 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:37:36.492664 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:37:36.492664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:36.521667 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:37:36.522665 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:37:36.522665 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:37:36.524666 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:37:36.526666 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:37:36.526666 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:37:36.531179 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:36.532179 [debug] [MainThread]: On master: BEGIN
[0m23:37:36.532179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:37:36.562180 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:37:36.563180 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:36.563180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:37:36.566180 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:37:36.568180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddf793d6-ced8-4a94-88e7-0e27dcc7aa26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020641602210>]}
[0m23:37:36.568180 [debug] [MainThread]: On master: ROLLBACK
[0m23:37:36.568180 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:36.569181 [debug] [MainThread]: On master: BEGIN
[0m23:37:36.569181 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:37:36.569181 [debug] [MainThread]: On master: COMMIT
[0m23:37:36.570180 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:36.570180 [debug] [MainThread]: On master: COMMIT
[0m23:37:36.570180 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:37:36.570180 [debug] [MainThread]: On master: Close
[0m23:37:36.571181 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:37:36.571181 [info ] [MainThread]: 
[0m23:37:36.575128 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:37:36.575128 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:37:36.575128 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:37:36.576142 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:37:36.576142 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:37:36.577141 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:37:36.577141 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:37:36.578150 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:37:36.578150 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:37:36.579141 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:37:36.579141 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:37:36.579141 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:37:36.581140 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:37:36.582142 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:37:36.584141 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:37:36.585141 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:37:36.579141 => 2023-03-30 23:37:36.585141
[0m23:37:36.585141 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:37:36.581140 => 2023-03-30 23:37:36.585141
[0m23:37:36.585141 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:37:36.585141 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:37:36.582142 => 2023-03-30 23:37:36.585141
[0m23:37:36.585141 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:37:36.614146 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:37:36.615145 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:37:36.618147 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:37:36.621145 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:37:36.621145 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:37:36.622152 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:37:36.622152 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:37:36.622152 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:37:36.622152 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:37:36.623145 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:37:36.623145 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:37:36.623145 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:37:36.623145 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:37:36.657388 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:37:36.658389 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:37:36.658389 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:37:36.658389 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:37:36.658389 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:37:36.658389 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:37:36.659392 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:37:36.659392 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:37:36.659392 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    datediff(dd, date(walmart.ship_date) , date(walmart.order_date)) as o_s_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.ship_date > walmart.order_date and
walmart.order_id is not null
  );
[0m23:37:36.659392 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:37:36.665389 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:37:36.665389 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "dd" does not exist
LINE 7:     datediff(dd, date(walmart.ship_date) , date(walmart.orde...
                     ^

[0m23:37:36.665389 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:37:36.665389 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:37:36.666391 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m23:37:36.668389 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:37:36.668389 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:37:36.668389 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:37:36.618147 => 2023-03-30 23:37:36.668389
[0m23:37:36.668389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:37:36.669391 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:37:36.669391 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:37:36.671392 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:37:36.674391 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:37:36.674391 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:37:36.674391 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:37:36.675392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:37:36.675392 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:37:36.690391 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:37:36.692390 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:37:36.692390 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:37:36.693393 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:37:36.693393 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:37:36.693393 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:37:36.695392 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  column "dd" does not exist
  LINE 7:     datediff(dd, date(walmart.ship_date) , date(walmart.orde...
                       ^
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:37:36.695392 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf793d6-ced8-4a94-88e7-0e27dcc7aa26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020640EAA110>]}
[0m23:37:36.696392 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.12s]
[0m23:37:36.696392 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:37:36.696392 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:37:36.698392 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:37:36.702390 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:37:36.704391 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:37:36.704391 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:37:36.704391 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:37:36.706392 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:37:36.706392 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:37:36.707391 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:37:36.615145 => 2023-03-30 23:37:36.707391
[0m23:37:36.708391 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:37:36.586141 => 2023-03-30 23:37:36.708391
[0m23:37:36.708391 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:37:36.708391 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:37:36.709391 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf793d6-ced8-4a94-88e7-0e27dcc7aa26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020641A13150>]}
[0m23:37:36.710390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddf793d6-ced8-4a94-88e7-0e27dcc7aa26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064164BE50>]}
[0m23:37:36.710390 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:37:36.711391 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:37:36.711391 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:37:36.711391 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:37:36.713397 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:37:36.713397 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:36.713397 [debug] [MainThread]: On master: BEGIN
[0m23:37:36.714397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:37:36.742450 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:37:36.743455 [debug] [MainThread]: On master: COMMIT
[0m23:37:36.743455 [debug] [MainThread]: Using postgres connection "master"
[0m23:37:36.743455 [debug] [MainThread]: On master: COMMIT
[0m23:37:36.744454 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:37:36.744454 [debug] [MainThread]: On master: Close
[0m23:37:36.745458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:36.745458 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:37:36.745458 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:37:36.745458 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:37:36.746455 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:37:36.746455 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:37:36.746455 [info ] [MainThread]: 
[0m23:37:36.747450 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m23:37:36.747450 [debug] [MainThread]: Command end result
[0m23:37:36.752450 [info ] [MainThread]: 
[0m23:37:36.753452 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:37:36.753452 [info ] [MainThread]: 
[0m23:37:36.754450 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m23:37:36.754450 [error] [MainThread]:   column "dd" does not exist
[0m23:37:36.754450 [error] [MainThread]:   LINE 7:     datediff(dd, date(walmart.ship_date) , date(walmart.orde...
[0m23:37:36.755450 [error] [MainThread]:                        ^
[0m23:37:36.755450 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:37:36.755450 [info ] [MainThread]: 
[0m23:37:36.755450 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:37:36.756449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206419E4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206411ECB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064136B790>]}
[0m23:37:36.756449 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:38:29.038555 | 1db047b6-fa62-4f59-b610-f7226ec2e5e6 ==============================
[0m23:38:29.038555 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:38:29.040554 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:38:29.040554 [debug] [MainThread]: Tracking: tracking
[0m23:38:29.048563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B71B71D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B6C87990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B7264610>]}
[0m23:38:29.056560 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:38:29.091067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:38:29.092068 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:38:29.103067 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:38:29.121068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1db047b6-fa62-4f59-b610-f7226ec2e5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B74B6C50>]}
[0m23:38:29.126068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1db047b6-fa62-4f59-b610-f7226ec2e5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B7531990>]}
[0m23:38:29.126068 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:38:29.127067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1db047b6-fa62-4f59-b610-f7226ec2e5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B69E1CD0>]}
[0m23:38:29.128069 [info ] [MainThread]: 
[0m23:38:29.130066 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:38:29.131070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:38:29.140066 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:38:29.140066 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:38:29.140066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:29.175582 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:38:29.176582 [debug] [ThreadPool]: On list_projeto: Close
[0m23:38:29.178580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:38:29.183580 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:38:29.183580 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:38:29.183580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:29.218719 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:38:29.219719 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:38:29.219719 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:38:29.223719 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:38:29.224719 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:38:29.224719 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:38:29.230717 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:29.230717 [debug] [MainThread]: On master: BEGIN
[0m23:38:29.230717 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:38:29.372599 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:38:29.373587 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:29.373587 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:38:29.378591 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:38:29.380589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1db047b6-fa62-4f59-b610-f7226ec2e5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B72C84D0>]}
[0m23:38:29.380589 [debug] [MainThread]: On master: ROLLBACK
[0m23:38:29.381588 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:29.381588 [debug] [MainThread]: On master: BEGIN
[0m23:38:29.382589 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:38:29.382589 [debug] [MainThread]: On master: COMMIT
[0m23:38:29.382589 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:29.383591 [debug] [MainThread]: On master: COMMIT
[0m23:38:29.383591 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:38:29.384592 [debug] [MainThread]: On master: Close
[0m23:38:29.384592 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:38:29.385589 [info ] [MainThread]: 
[0m23:38:29.389590 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:38:29.389590 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:38:29.389590 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:38:29.390588 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:38:29.390588 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:38:29.391588 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:38:29.391588 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:38:29.392589 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:38:29.392589 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:38:29.392589 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:38:29.392589 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:38:29.393587 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:38:29.395588 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:38:29.396587 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:38:29.398588 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:38:29.399588 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:38:29.393587 => 2023-03-30 23:38:29.399588
[0m23:38:29.399588 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:38:29.395588 => 2023-03-30 23:38:29.399588
[0m23:38:29.399588 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:38:29.399588 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:38:29.396587 => 2023-03-30 23:38:29.399588
[0m23:38:29.400587 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:38:29.430586 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:38:29.431589 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:38:29.434587 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:38:29.438587 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:38:29.438587 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:38:29.438587 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:38:29.439589 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:38:29.439589 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:38:29.439589 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:38:29.439589 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:38:29.440587 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:38:29.440587 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:38:29.440587 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:38:29.474103 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:38:29.474103 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:38:29.474103 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:38:29.474103 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:38:29.475105 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:38:29.475105 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:38:29.476110 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:38:29.482105 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:38:29.482105 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:38:29.482105 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:38:29.485102 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:38:29.486103 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:38:29.486103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:38:29.486103 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:38:29.488102 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:38:29.490102 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:38:29.490102 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:38:29.490102 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:38:29.491103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:38:29.491103 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:38:29.506102 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:38:29.508103 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:38:29.508103 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:38:29.508103 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:38:29.508103 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:38:29.509102 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:38:29.510103 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:38:29.510103 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:38:29.514104 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:38:29.516103 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:38:29.516103 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:38:29.516103 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:38:29.517948 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:38:29.517948 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:38:29.518973 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:38:29.431589 => 2023-03-30 23:38:29.518973
[0m23:38:29.519974 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:38:29.400587 => 2023-03-30 23:38:29.519974
[0m23:38:29.519974 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:38:29.519974 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:38:29.520974 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1db047b6-fa62-4f59-b610-f7226ec2e5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B75FA290>]}
[0m23:38:29.520974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1db047b6-fa62-4f59-b610-f7226ec2e5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B6EBA6D0>]}
[0m23:38:29.521962 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:38:29.521962 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:38:29.523960 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:38:29.523960 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:38:29.580324 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:38:29.580324 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:38:29.581324 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    DATE_PART('day', date(walmart.ship_date) - date(walmart.order_date)) as o_s_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.ship_date > walmart.order_date and
walmart.order_id is not null
  );
[0m23:38:29.582323 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function date_part(unknown, integer) does not exist
LINE 7:     DATE_PART('day', date(walmart.ship_date) - date(walmart....
            ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m23:38:29.582323 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m23:38:29.582323 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:38:29.435588 => 2023-03-30 23:38:29.582323
[0m23:38:29.583323 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:38:29.586325 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  function date_part(unknown, integer) does not exist
  LINE 7:     DATE_PART('day', date(walmart.ship_date) - date(walmart....
              ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:38:29.587326 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1db047b6-fa62-4f59-b610-f7226ec2e5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B75BEC50>]}
[0m23:38:29.587326 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.19s]
[0m23:38:29.588324 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:38:29.589324 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:38:29.589324 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:29.590322 [debug] [MainThread]: On master: BEGIN
[0m23:38:29.590322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:38:29.622208 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:38:29.623205 [debug] [MainThread]: On master: COMMIT
[0m23:38:29.623205 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:29.623205 [debug] [MainThread]: On master: COMMIT
[0m23:38:29.623205 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:38:29.624207 [debug] [MainThread]: On master: Close
[0m23:38:29.624207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:29.625205 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:38:29.625205 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:38:29.625205 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:38:29.625205 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:38:29.626205 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:38:29.626205 [info ] [MainThread]: 
[0m23:38:29.626205 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m23:38:29.627207 [debug] [MainThread]: Command end result
[0m23:38:29.632211 [info ] [MainThread]: 
[0m23:38:29.633207 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:38:29.633207 [info ] [MainThread]: 
[0m23:38:29.633207 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m23:38:29.634206 [error] [MainThread]:   function date_part(unknown, integer) does not exist
[0m23:38:29.634206 [error] [MainThread]:   LINE 7:     DATE_PART('day', date(walmart.ship_date) - date(walmart....
[0m23:38:29.634206 [error] [MainThread]:               ^
[0m23:38:29.635206 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m23:38:29.635206 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:38:29.635206 [info ] [MainThread]: 
[0m23:38:29.636208 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:38:29.636208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B08697D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B69DB450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B69DBA90>]}
[0m23:38:29.636208 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:40:00.762693 | 1583a4e1-ffbc-458a-8d83-8b62466be6ae ==============================
[0m23:40:00.762693 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:40:00.764692 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:40:00.764692 [debug] [MainThread]: Tracking: tracking
[0m23:40:00.773211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371C6D2B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371C6D3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371CC8FA50>]}
[0m23:40:00.780718 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:40:00.816248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:40:00.817250 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:40:00.827759 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:40:00.843781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1583a4e1-ffbc-458a-8d83-8b62466be6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371C42A390>]}
[0m23:40:00.848781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1583a4e1-ffbc-458a-8d83-8b62466be6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371CF6ED50>]}
[0m23:40:00.848781 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:40:00.849288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1583a4e1-ffbc-458a-8d83-8b62466be6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371CCD5390>]}
[0m23:40:00.850295 [info ] [MainThread]: 
[0m23:40:00.852297 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:40:00.853296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:40:00.861818 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:40:00.861818 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:40:00.861818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:00.894372 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:40:00.896367 [debug] [ThreadPool]: On list_projeto: Close
[0m23:40:00.897369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:40:00.902640 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:40:00.902640 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:40:00.902640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:00.932179 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:40:00.932179 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:40:00.933176 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:40:00.935181 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:40:00.936176 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:40:00.937176 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:40:00.942201 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:00.942201 [debug] [MainThread]: On master: BEGIN
[0m23:40:00.942201 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:40:00.972280 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:40:00.972280 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:00.973277 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:40:00.976281 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:40:00.978282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1583a4e1-ffbc-458a-8d83-8b62466be6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371CF295D0>]}
[0m23:40:00.978282 [debug] [MainThread]: On master: ROLLBACK
[0m23:40:00.978282 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:00.979282 [debug] [MainThread]: On master: BEGIN
[0m23:40:00.979282 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:40:00.979282 [debug] [MainThread]: On master: COMMIT
[0m23:40:00.979282 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:00.979282 [debug] [MainThread]: On master: COMMIT
[0m23:40:00.980586 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:40:00.980586 [debug] [MainThread]: On master: Close
[0m23:40:00.980586 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:40:00.981586 [info ] [MainThread]: 
[0m23:40:00.985583 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:40:00.985583 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:40:00.985583 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:40:00.985583 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:40:00.986585 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:40:00.986585 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:40:00.987583 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:40:00.987583 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:40:00.987583 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:40:00.987583 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:40:00.989088 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:40:00.989088 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:40:00.991096 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:40:00.992101 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:40:00.994102 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:40:00.994102 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:40:00.989088 => 2023-03-30 23:40:00.994102
[0m23:40:00.995101 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:40:00.991096 => 2023-03-30 23:40:00.995101
[0m23:40:00.995101 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:40:00.995101 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:40:00.995101 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:40:00.992101 => 2023-03-30 23:40:00.995101
[0m23:40:01.027633 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:40:01.027633 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:40:01.024632 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:40:01.030145 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:40:01.031143 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:40:01.032144 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:40:01.032144 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:40:01.032144 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:40:01.032144 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:40:01.032144 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:40:01.033145 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:40:01.033145 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:40:01.034145 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:40:01.067786 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:40:01.067786 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:40:01.067786 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:40:01.067786 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:40:01.067786 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:40:01.067786 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:40:01.069296 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:40:01.069296 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:40:01.069296 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:40:01.070304 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    date_part('day', date(walmart.ship_date)) as o_s_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.ship_date > walmart.order_date and
walmart.order_id is not null
  );
[0m23:40:01.075304 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:40:01.075304 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:40:01.075304 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:40:01.077302 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:40:01.077302 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:40:01.078303 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:40:01.078303 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:40:01.079809 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:40:01.081814 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:40:01.081814 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:40:01.082814 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2" rename to "view_2__dbt_backup"
[0m23:40:01.082814 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:40:01.084814 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:40:01.085814 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:40:01.085814 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:40:01.085814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:40:01.087813 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:40:01.087813 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:40:01.103410 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:40:01.103410 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m23:40:01.104410 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:40:01.105411 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:40:01.105411 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:40:01.105411 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:40:01.105411 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:40:01.106409 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:40:01.107411 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:40:01.107411 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:40:01.107411 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:40:01.107411 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:40:01.107411 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:40:01.111930 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:40:01.112931 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m23:40:01.113929 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:40:01.113929 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:40:01.116932 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:40:01.116932 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:40:01.117929 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m23:40:01.118933 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:40:01.118933 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:40:01.118933 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m23:40:01.120156 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:40:00.995101 => 2023-03-30 23:40:01.120156
[0m23:40:01.121156 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:40:01.024632 => 2023-03-30 23:40:01.121156
[0m23:40:01.121156 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:40:01.027633 => 2023-03-30 23:40:01.121156
[0m23:40:01.122155 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:40:01.122155 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:40:01.122155 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:40:01.123156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1583a4e1-ffbc-458a-8d83-8b62466be6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371D068810>]}
[0m23:40:01.123156 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1583a4e1-ffbc-458a-8d83-8b62466be6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371C700690>]}
[0m23:40:01.124157 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1583a4e1-ffbc-458a-8d83-8b62466be6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371D068090>]}
[0m23:40:01.124157 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.14s]
[0m23:40:01.125155 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.14s]
[0m23:40:01.125155 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.14s]
[0m23:40:01.127156 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:40:01.127156 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:40:01.127156 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:40:01.129158 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:40:01.129158 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:01.129672 [debug] [MainThread]: On master: BEGIN
[0m23:40:01.129672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:40:01.159245 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:40:01.159751 [debug] [MainThread]: On master: COMMIT
[0m23:40:01.159751 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:01.159751 [debug] [MainThread]: On master: COMMIT
[0m23:40:01.159751 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:40:01.160762 [debug] [MainThread]: On master: Close
[0m23:40:01.160762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:01.160762 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:40:01.161762 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:40:01.161762 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:40:01.161762 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:40:01.161762 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:40:01.162762 [info ] [MainThread]: 
[0m23:40:01.162762 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m23:40:01.163757 [debug] [MainThread]: Command end result
[0m23:40:01.167764 [info ] [MainThread]: 
[0m23:40:01.167764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:40:01.169270 [info ] [MainThread]: 
[0m23:40:01.169270 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:40:01.169270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371CBC9090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371C450A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371A80AED0>]}
[0m23:40:01.170281 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:41:26.245812 | d2f955b7-482b-4819-abb3-b80dce071c8e ==============================
[0m23:41:26.245812 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:41:26.247812 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:41:26.247812 [debug] [MainThread]: Tracking: tracking
[0m23:41:26.256320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BC34A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BC414690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BBED6F10>]}
[0m23:41:26.264842 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:41:26.298402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:41:26.298402 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:41:26.309919 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:41:26.325963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2f955b7-482b-4819-abb3-b80dce071c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BBE43E50>]}
[0m23:41:26.329961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2f955b7-482b-4819-abb3-b80dce071c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BC6ED4D0>]}
[0m23:41:26.331467 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:41:26.331467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f955b7-482b-4819-abb3-b80dce071c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BC06EDD0>]}
[0m23:41:26.332474 [info ] [MainThread]: 
[0m23:41:26.334473 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:41:26.335312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:41:26.344837 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:41:26.344837 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:41:26.344837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:26.380384 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:41:26.381380 [debug] [ThreadPool]: On list_projeto: Close
[0m23:41:26.382890 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:41:26.387891 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:41:26.387891 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:41:26.388891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:26.417437 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:41:26.417437 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:41:26.417437 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:41:26.420432 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:41:26.421942 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:41:26.421942 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:41:26.426951 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:26.427951 [debug] [MainThread]: On master: BEGIN
[0m23:41:26.427951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:26.457495 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:41:26.458496 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:26.458496 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:41:26.462000 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:41:26.464009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f955b7-482b-4819-abb3-b80dce071c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BC433750>]}
[0m23:41:26.464009 [debug] [MainThread]: On master: ROLLBACK
[0m23:41:26.464009 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:26.464009 [debug] [MainThread]: On master: BEGIN
[0m23:41:26.465010 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:41:26.465010 [debug] [MainThread]: On master: COMMIT
[0m23:41:26.465010 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:26.466007 [debug] [MainThread]: On master: COMMIT
[0m23:41:26.466007 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:41:26.466007 [debug] [MainThread]: On master: Close
[0m23:41:26.467010 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:41:26.467010 [info ] [MainThread]: 
[0m23:41:26.470006 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:41:26.470006 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:41:26.471510 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:41:26.471510 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:41:26.471510 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:41:26.472517 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:41:26.472517 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:41:26.473517 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:41:26.473517 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:41:26.473517 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:41:26.474517 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:41:26.474517 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:41:26.476515 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:41:26.477518 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:41:26.478518 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:41:26.479516 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:41:26.474517 => 2023-03-30 23:41:26.479516
[0m23:41:26.479516 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:41:26.476515 => 2023-03-30 23:41:26.479516
[0m23:41:26.480520 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:41:26.480520 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:41:26.477518 => 2023-03-30 23:41:26.480520
[0m23:41:26.480520 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:41:26.510069 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:41:26.511068 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:41:26.514181 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:41:26.517182 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:41:26.517182 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:41:26.518182 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:41:26.518182 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:41:26.518182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:41:26.518182 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:41:26.519182 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:41:26.519182 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:41:26.519182 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:41:26.519182 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:41:26.551736 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:41:26.552741 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:41:26.552741 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:41:26.553744 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:41:26.559745 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:41:26.559745 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:41:26.559745 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:41:26.559745 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:41:26.559745 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:41:26.559745 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:41:26.561250 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:41:26.561250 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:41:26.561250 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    date(walmart.ship_date) - date(walmart.order_date) as o_s_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.ship_date > walmart.order_date and
walmart.order_id is not null
  );
[0m23:41:26.563257 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:41:26.564258 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:41:26.564258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:41:26.578773 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:41:26.578773 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:41:26.579776 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:41:26.579776 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:41:26.581282 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:41:26.583289 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:41:26.584289 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:41:26.584289 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:41:26.584289 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2" rename to "view_2__dbt_backup"
[0m23:41:26.585289 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:41:26.585289 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:41:26.585289 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:41:26.589288 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:41:26.591290 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:41:26.592802 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:41:26.593806 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:41:26.593806 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:41:26.593806 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m23:41:26.594803 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:41:26.594803 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:41:26.596803 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:41:26.596803 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:41:26.597802 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:41:26.597802 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:41:26.598804 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:41:26.480520 => 2023-03-30 23:41:26.598804
[0m23:41:26.599803 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:41:26.599803 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:41:26.599803 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:41:26.599803 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:41:26.601309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f955b7-482b-4819-abb3-b80dce071c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BC677C50>]}
[0m23:41:26.601309 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:41:26.601309 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m23:41:26.601309 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:41:26.603316 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:41:26.606314 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:41:26.608314 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:41:26.608314 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:41:26.608314 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m23:41:26.610319 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m23:41:26.610319 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:41:26.611316 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:41:26.514181 => 2023-03-30 23:41:26.611316
[0m23:41:26.611316 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:41:26.511068 => 2023-03-30 23:41:26.611316
[0m23:41:26.612611 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:41:26.612611 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:41:26.612611 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f955b7-482b-4819-abb3-b80dce071c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BC34F010>]}
[0m23:41:26.613612 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f955b7-482b-4819-abb3-b80dce071c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BC0EDD50>]}
[0m23:41:26.613612 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.14s]
[0m23:41:26.614611 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.14s]
[0m23:41:26.614611 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:41:26.614611 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:41:26.616611 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:41:26.616611 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:26.616611 [debug] [MainThread]: On master: BEGIN
[0m23:41:26.616611 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:26.647678 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:41:26.647678 [debug] [MainThread]: On master: COMMIT
[0m23:41:26.647678 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:26.648707 [debug] [MainThread]: On master: COMMIT
[0m23:41:26.648707 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:41:26.648707 [debug] [MainThread]: On master: Close
[0m23:41:26.649707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:26.649707 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:41:26.649707 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:41:26.649707 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:41:26.649707 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:41:26.649707 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:41:26.651223 [info ] [MainThread]: 
[0m23:41:26.651223 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m23:41:26.652231 [debug] [MainThread]: Command end result
[0m23:41:26.656229 [info ] [MainThread]: 
[0m23:41:26.656229 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:41:26.657228 [info ] [MainThread]: 
[0m23:41:26.657228 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:41:26.658228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BBE41E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BBE42790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BC322490>]}
[0m23:41:26.658228 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:42:36.889252 | 4f0a04db-4743-4218-a244-7ee6a8570601 ==============================
[0m23:42:36.889252 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:42:36.890657 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:42:36.890657 [debug] [MainThread]: Tracking: tracking
[0m23:42:36.898455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189482C0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189481C7B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189487A92D0>]}
[0m23:42:36.906962 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:42:36.942136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:42:36.942136 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:42:36.953153 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:42:36.971193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f0a04db-4743-4218-a244-7ee6a8570601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001894831BD10>]}
[0m23:42:36.975710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f0a04db-4743-4218-a244-7ee6a8570601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018948B68ED0>]}
[0m23:42:36.975710 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:42:36.976710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f0a04db-4743-4218-a244-7ee6a8570601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001894875BD10>]}
[0m23:42:36.977710 [info ] [MainThread]: 
[0m23:42:36.979709 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:42:36.980711 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:42:36.989232 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:42:36.989232 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:42:36.989232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:37.021286 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:42:37.022288 [debug] [ThreadPool]: On list_projeto: Close
[0m23:42:37.024328 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:42:37.028328 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:42:37.029327 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:42:37.029327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:37.058597 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:42:37.058597 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:42:37.058597 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:42:37.061626 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:42:37.063144 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:42:37.063144 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:42:37.068151 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:37.068151 [debug] [MainThread]: On master: BEGIN
[0m23:42:37.068151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:42:37.197807 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:42:37.197807 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:37.197807 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:42:37.201835 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:42:37.203353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f0a04db-4743-4218-a244-7ee6a8570601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018948B9DF90>]}
[0m23:42:37.203353 [debug] [MainThread]: On master: ROLLBACK
[0m23:42:37.204361 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:37.204361 [debug] [MainThread]: On master: BEGIN
[0m23:42:37.204361 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:42:37.204361 [debug] [MainThread]: On master: COMMIT
[0m23:42:37.205361 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:37.205361 [debug] [MainThread]: On master: COMMIT
[0m23:42:37.205361 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:42:37.205361 [debug] [MainThread]: On master: Close
[0m23:42:37.206360 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:42:37.206360 [info ] [MainThread]: 
[0m23:42:37.210359 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:42:37.210359 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:42:37.210359 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:42:37.211360 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:42:37.211360 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:42:37.211360 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:42:37.212361 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:42:37.213359 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:42:37.213359 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:42:37.213865 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:42:37.213865 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:42:37.213865 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:42:37.215869 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:42:37.216871 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:42:37.218869 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:42:37.218869 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:42:37.213865 => 2023-03-30 23:42:37.218869
[0m23:42:37.219871 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:42:37.219871 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:42:37.215869 => 2023-03-30 23:42:37.219871
[0m23:42:37.219871 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:42:37.216871 => 2023-03-30 23:42:37.219871
[0m23:42:37.247401 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:42:37.248401 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:42:37.248867 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:42:37.251882 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:42:37.251882 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:42:37.254959 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:42:37.254959 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:42:37.255968 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:42:37.255968 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:42:37.255968 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:42:37.256968 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:42:37.256968 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:42:37.256968 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:42:37.257967 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:42:37.289266 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:42:37.290261 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:42:37.290261 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:42:37.291264 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:42:37.291264 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:42:37.291264 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    date(walmart.ship_date) - date(walmart.order_date) as os_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.order_id is not null
order by os_delta
  );
[0m23:42:37.292265 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:42:37.297457 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:42:37.297457 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:42:37.297457 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:42:37.299459 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:42:37.300459 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2" rename to "view_2__dbt_backup"
[0m23:42:37.300459 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:42:37.301460 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:42:37.301460 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:42:37.302968 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:42:37.304974 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:42:37.304974 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m23:42:37.304974 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:42:37.316509 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:42:37.320508 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:42:37.321507 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:42:37.321507 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:42:37.321507 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:42:37.323013 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:42:37.323013 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:42:37.324014 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:42:37.324014 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m23:42:37.328030 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:42:37.329028 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:42:37.329028 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:42:37.330029 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m23:42:37.331027 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:42:37.331027 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m23:42:37.332030 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:42:37.248867 => 2023-03-30 23:42:37.332030
[0m23:42:37.333028 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:42:37.251882 => 2023-03-30 23:42:37.333028
[0m23:42:37.333539 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:42:37.333539 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:42:37.333539 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0a04db-4743-4218-a244-7ee6a8570601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018948B8FC50>]}
[0m23:42:37.334548 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0a04db-4743-4218-a244-7ee6a8570601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018948C19610>]}
[0m23:42:37.334548 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.12s]
[0m23:42:37.335548 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.12s]
[0m23:42:37.336545 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:42:37.337545 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:42:37.386966 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:42:37.386966 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:42:37.386966 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:42:37.388992 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:42:37.390995 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:42:37.391995 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:42:37.391995 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:42:37.393487 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:42:37.393487 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:42:37.394494 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:42:37.395494 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:42:37.396494 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:42:37.396494 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:42:37.396494 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:42:37.399495 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:42:37.399495 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:42:37.400493 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:42:37.401493 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:42:37.219871 => 2023-03-30 23:42:37.401493
[0m23:42:37.401493 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:42:37.402998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0a04db-4743-4218-a244-7ee6a8570601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018948BCFD10>]}
[0m23:42:37.402998 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.19s]
[0m23:42:37.404005 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:42:37.405006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:42:37.405006 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:37.405006 [debug] [MainThread]: On master: BEGIN
[0m23:42:37.406008 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:42:37.435147 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:42:37.435147 [debug] [MainThread]: On master: COMMIT
[0m23:42:37.435147 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:37.436145 [debug] [MainThread]: On master: COMMIT
[0m23:42:37.436145 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:42:37.436145 [debug] [MainThread]: On master: Close
[0m23:42:37.437145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:37.437145 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:42:37.437145 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:42:37.437145 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:42:37.438148 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:42:37.438148 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:42:37.438148 [info ] [MainThread]: 
[0m23:42:37.438148 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m23:42:37.439148 [debug] [MainThread]: Command end result
[0m23:42:37.443648 [info ] [MainThread]: 
[0m23:42:37.443648 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:42:37.444654 [info ] [MainThread]: 
[0m23:42:37.444654 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:42:37.445657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018948003390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018948001910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018948003410>]}
[0m23:42:37.445657 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:42:54.147237 | 0c463028-8005-45ab-a90d-e942aea79e11 ==============================
[0m23:42:54.147237 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:42:54.149238 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:42:54.149238 [debug] [MainThread]: Tracking: tracking
[0m23:42:54.157760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF476EB750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF46F2A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF471E3D10>]}
[0m23:42:54.165275 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:42:54.199842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:42:54.200842 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:42:54.211358 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:42:54.227129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c463028-8005-45ab-a90d-e942aea79e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF47A39250>]}
[0m23:42:54.231129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c463028-8005-45ab-a90d-e942aea79e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF47AA9B90>]}
[0m23:42:54.232130 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:42:54.232130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c463028-8005-45ab-a90d-e942aea79e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF476C0110>]}
[0m23:42:54.233637 [info ] [MainThread]: 
[0m23:42:54.234644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:42:54.236643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:42:54.244148 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:42:54.244148 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:42:54.245157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:54.277541 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:42:54.278541 [debug] [ThreadPool]: On list_projeto: Close
[0m23:42:54.279529 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:42:54.284044 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:42:54.285056 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:42:54.285056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:54.317597 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:42:54.317597 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:42:54.317597 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:42:54.320597 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:42:54.321598 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:42:54.321598 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:42:54.327045 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:54.327045 [debug] [MainThread]: On master: BEGIN
[0m23:42:54.327045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:42:54.356580 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:42:54.356580 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:54.357579 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:42:54.360580 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:42:54.362578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c463028-8005-45ab-a90d-e942aea79e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF46FCFD50>]}
[0m23:42:54.362578 [debug] [MainThread]: On master: ROLLBACK
[0m23:42:54.362578 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:54.362578 [debug] [MainThread]: On master: BEGIN
[0m23:42:54.363584 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:42:54.364091 [debug] [MainThread]: On master: COMMIT
[0m23:42:54.364091 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:54.364091 [debug] [MainThread]: On master: COMMIT
[0m23:42:54.364091 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:42:54.365098 [debug] [MainThread]: On master: Close
[0m23:42:54.365098 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:42:54.366098 [info ] [MainThread]: 
[0m23:42:54.369419 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:42:54.369419 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:42:54.370434 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:42:54.370434 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:42:54.370434 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:42:54.371435 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:42:54.371435 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:42:54.372433 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:42:54.372433 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:42:54.372433 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:42:54.373434 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:42:54.373434 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:42:54.375724 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:42:54.376727 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:42:54.377726 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:42:54.378724 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:42:54.373434 => 2023-03-30 23:42:54.378724
[0m23:42:54.378724 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:42:54.379725 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:42:54.375724 => 2023-03-30 23:42:54.379725
[0m23:42:54.379725 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:42:54.376727 => 2023-03-30 23:42:54.379725
[0m23:42:54.407915 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:42:54.407915 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:42:54.408644 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:42:54.411658 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:42:54.411658 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:42:54.415167 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:42:54.415167 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:42:54.416167 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:42:54.416167 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:42:54.416167 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:42:54.416167 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:42:54.417166 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:42:54.417166 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:42:54.417166 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:42:54.450474 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:42:54.450474 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:42:54.451470 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:42:54.451470 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:42:54.451470 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:42:54.451470 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:42:54.452477 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:42:54.452477 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:42:54.452477 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    date(walmart.ship_date) - date(walmart.order_date) as os_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.order_id is not null
order by os_delta desc
  );
[0m23:42:54.453471 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:42:54.457895 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:42:54.457895 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:42:54.457895 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:42:54.458896 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:42:54.460895 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:42:54.461898 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:42:54.461898 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:42:54.463404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:42:54.463404 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2" rename to "view_2__dbt_backup"
[0m23:42:54.464935 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:42:54.464935 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:42:54.465936 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:42:54.465936 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:42:54.467936 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:42:54.469934 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:42:54.469934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:42:54.469934 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:42:54.470934 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m23:42:54.484967 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:42:54.485974 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:42:54.485974 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:42:54.485974 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:42:54.486973 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:42:54.487974 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:42:54.489974 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:42:54.489974 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:42:54.489974 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:42:54.490973 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:42:54.490973 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:42:54.491973 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:42:54.491973 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:42:54.491973 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m23:42:54.496484 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:42:54.498485 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:42:54.500486 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:42:54.500486 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:42:54.501485 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:42:54.501485 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m23:42:54.502487 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:42:54.502487 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:42:54.502487 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m23:42:54.503991 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:42:54.379725 => 2023-03-30 23:42:54.503991
[0m23:42:54.504999 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:42:54.408644 => 2023-03-30 23:42:54.504999
[0m23:42:54.505999 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:42:54.412659 => 2023-03-30 23:42:54.505999
[0m23:42:54.505999 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:42:54.505999 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:42:54.505999 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:42:54.506998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c463028-8005-45ab-a90d-e942aea79e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF47AF6AD0>]}
[0m23:42:54.506998 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c463028-8005-45ab-a90d-e942aea79e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF477AC910>]}
[0m23:42:54.508000 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c463028-8005-45ab-a90d-e942aea79e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF47AF6890>]}
[0m23:42:54.508000 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.14s]
[0m23:42:54.508999 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:42:54.509998 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.14s]
[0m23:42:54.510998 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:42:54.510998 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:42:54.511998 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:42:54.513503 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:42:54.513503 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:54.513503 [debug] [MainThread]: On master: BEGIN
[0m23:42:54.514508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:42:54.542531 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:42:54.543531 [debug] [MainThread]: On master: COMMIT
[0m23:42:54.544037 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:54.544037 [debug] [MainThread]: On master: COMMIT
[0m23:42:54.544037 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:42:54.544037 [debug] [MainThread]: On master: Close
[0m23:42:54.545042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:54.546046 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:42:54.546046 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:42:54.546046 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:42:54.547042 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:42:54.547042 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:42:54.547042 [info ] [MainThread]: 
[0m23:42:54.548042 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m23:42:54.548042 [debug] [MainThread]: Command end result
[0m23:42:54.552042 [info ] [MainThread]: 
[0m23:42:54.553551 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:42:54.553551 [info ] [MainThread]: 
[0m23:42:54.554558 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:42:54.554558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF44A79F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF46F2AFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF477C57D0>]}
[0m23:42:54.555557 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:43:41.243647 | 0752ecd9-1920-4098-b51f-e35efa0463bb ==============================
[0m23:43:41.243647 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:43:41.244644 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:43:41.244644 [debug] [MainThread]: Tracking: tracking
[0m23:43:41.253152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC76F73010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7748CC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7748E110>]}
[0m23:43:41.261662 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:43:41.297216 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:43:41.297216 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:43:41.307734 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:43:41.324761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0752ecd9-1920-4098-b51f-e35efa0463bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC77468B90>]}
[0m23:43:41.330300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0752ecd9-1920-4098-b51f-e35efa0463bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC77484150>]}
[0m23:43:41.330300 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:43:41.330816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0752ecd9-1920-4098-b51f-e35efa0463bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7743B9D0>]}
[0m23:43:41.331833 [info ] [MainThread]: 
[0m23:43:41.333836 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:43:41.334828 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:43:41.343340 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:43:41.343340 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:43:41.343340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:41.379380 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:43:41.380380 [debug] [ThreadPool]: On list_projeto: Close
[0m23:43:41.381388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:43:41.386410 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:43:41.386410 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:43:41.386410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:41.415952 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:43:41.415952 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:43:41.416953 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:43:41.418952 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:43:41.419952 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:43:41.420953 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:43:41.425458 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:41.425458 [debug] [MainThread]: On master: BEGIN
[0m23:43:41.425458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:43:41.453485 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:43:41.454994 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:41.454994 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:43:41.459004 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:43:41.460000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0752ecd9-1920-4098-b51f-e35efa0463bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7753DCD0>]}
[0m23:43:41.461000 [debug] [MainThread]: On master: ROLLBACK
[0m23:43:41.461000 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:41.461000 [debug] [MainThread]: On master: BEGIN
[0m23:43:41.462000 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:43:41.462000 [debug] [MainThread]: On master: COMMIT
[0m23:43:41.462000 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:41.462000 [debug] [MainThread]: On master: COMMIT
[0m23:43:41.463003 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:43:41.463003 [debug] [MainThread]: On master: Close
[0m23:43:41.464002 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:43:41.464002 [info ] [MainThread]: 
[0m23:43:41.467319 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:43:41.467319 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:43:41.467319 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:43:41.468321 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:43:41.468321 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:43:41.469321 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:43:41.469321 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:43:41.470320 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:43:41.470320 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:43:41.470320 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:43:41.471319 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:43:41.471319 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:43:41.473319 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:43:41.473319 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:43:41.475830 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:43:41.476830 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:43:41.471319 => 2023-03-30 23:43:41.476830
[0m23:43:41.476830 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:43:41.473319 => 2023-03-30 23:43:41.476830
[0m23:43:41.476830 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:43:41.477829 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:43:41.477829 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:43:41.474823 => 2023-03-30 23:43:41.477829
[0m23:43:41.506446 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:43:41.509446 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:43:41.509446 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:43:41.513446 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:43:41.513446 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:43:41.513446 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:43:41.513446 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:43:41.513446 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:43:41.513446 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:43:41.514950 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:43:41.514950 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:43:41.514950 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:43:41.515957 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:43:41.548490 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:43:41.548490 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:43:41.548490 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:43:41.548490 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:43:41.549492 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:43:41.549492 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:43:41.550491 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:43:41.550491 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:43:41.550491 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:43:41.551490 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:43:41.555998 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:43:41.557998 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:43:41.557998 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
    date(walmart.ship_date) as ship_date,
    date(walmart.ship_date) - date(walmart.order_date) as os_delta,
	walmart.quantity,
	walmart.state
from walmart
where walmart.order_id is not null
group by os_delta
order by os_delta desc
  );
[0m23:43:41.558999 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:43:41.558999 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:43:41.559999 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:43:41.559999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:43:41.561998 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:43:41.561998 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "walmart.order_id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 4:     select walmart.order_id,
                   ^

[0m23:43:41.562999 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:43:41.563998 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:43:41.563998 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m23:43:41.563998 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:43:41.565000 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:43:41.510447 => 2023-03-30 23:43:41.565000
[0m23:43:41.565000 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:43:41.565000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:43:41.565000 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:43:41.579547 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:43:41.581547 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:43:41.581547 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:43:41.583051 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:43:41.583051 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:43:41.583051 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:43:41.584058 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:43:41.585058 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:43:41.589085 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:43:41.590087 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:43:41.590087 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:43:41.591087 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:43:41.592087 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  column "walmart.order_id" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 4:     select walmart.order_id,
                     ^
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:43:41.592087 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:43:41.592087 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0752ecd9-1920-4098-b51f-e35efa0463bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC77872950>]}
[0m23:43:41.593087 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:43:41.506446 => 2023-03-30 23:43:41.593087
[0m23:43:41.594087 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:43:41.594087 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.12s]
[0m23:43:41.594591 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:43:41.595598 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:43:41.477829 => 2023-03-30 23:43:41.595598
[0m23:43:41.596596 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:43:41.597598 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0752ecd9-1920-4098-b51f-e35efa0463bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC778AF5D0>]}
[0m23:43:41.597598 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:43:41.597598 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:43:41.598597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0752ecd9-1920-4098-b51f-e35efa0463bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC778AF910>]}
[0m23:43:41.598597 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:43:41.599596 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:43:41.599596 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:43:41.600596 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:43:41.601598 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:41.601598 [debug] [MainThread]: On master: BEGIN
[0m23:43:41.601598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:43:41.630125 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:43:41.631125 [debug] [MainThread]: On master: COMMIT
[0m23:43:41.631125 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:41.631125 [debug] [MainThread]: On master: COMMIT
[0m23:43:41.632138 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:43:41.632138 [debug] [MainThread]: On master: Close
[0m23:43:41.633126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:41.633126 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:43:41.633126 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:43:41.633126 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:43:41.633126 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:43:41.634630 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:43:41.634630 [info ] [MainThread]: 
[0m23:43:41.634630 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m23:43:41.635635 [debug] [MainThread]: Command end result
[0m23:43:41.640635 [info ] [MainThread]: 
[0m23:43:41.641637 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:43:41.641637 [info ] [MainThread]: 
[0m23:43:41.642635 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m23:43:41.642635 [error] [MainThread]:   column "walmart.order_id" must appear in the GROUP BY clause or be used in an aggregate function
[0m23:43:41.642635 [error] [MainThread]:   LINE 4:     select walmart.order_id,
[0m23:43:41.643635 [error] [MainThread]:                      ^
[0m23:43:41.643635 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:43:41.643635 [info ] [MainThread]: 
[0m23:43:41.643635 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:43:41.644637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC76865590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7745E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7745DBD0>]}
[0m23:43:41.644637 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:45:27.360080 | 38c9e327-dbcb-4730-8c6d-917ccafb8039 ==============================
[0m23:45:27.360080 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:45:27.361079 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:45:27.361079 [debug] [MainThread]: Tracking: tracking
[0m23:45:27.369615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BFC5A2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BFC84AD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BFC5A2810>]}
[0m23:45:27.378121 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:45:27.411650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:45:27.412650 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:45:27.422160 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:45:27.437681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38c9e327-dbcb-4730-8c6d-917ccafb8039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BFD088590>]}
[0m23:45:27.442685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38c9e327-dbcb-4730-8c6d-917ccafb8039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BFD0EFA50>]}
[0m23:45:27.442685 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:45:27.442685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38c9e327-dbcb-4730-8c6d-917ccafb8039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BFCDE2950>]}
[0m23:45:27.444685 [info ] [MainThread]: 
[0m23:45:27.445685 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:45:27.446690 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:45:27.456196 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:45:27.456196 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:45:27.456196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:27.491238 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:45:27.492238 [debug] [ThreadPool]: On list_projeto: Close
[0m23:45:27.494244 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:45:27.498748 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:45:27.498748 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:45:27.498748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:27.527764 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:45:27.528270 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:45:27.528270 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:45:27.530274 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:45:27.531274 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:45:27.532274 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:45:27.536599 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:27.537599 [debug] [MainThread]: On master: BEGIN
[0m23:45:27.537599 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:45:27.566131 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:45:27.566131 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:27.566131 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:45:27.569644 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:45:27.571644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38c9e327-dbcb-4730-8c6d-917ccafb8039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BFC92C490>]}
[0m23:45:27.571644 [debug] [MainThread]: On master: ROLLBACK
[0m23:45:27.572646 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:27.572646 [debug] [MainThread]: On master: BEGIN
[0m23:45:27.572646 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:45:27.572646 [debug] [MainThread]: On master: COMMIT
[0m23:45:27.573644 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:27.573644 [debug] [MainThread]: On master: COMMIT
[0m23:45:27.573644 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:45:27.573644 [debug] [MainThread]: On master: Close
[0m23:45:27.574646 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:45:27.575652 [info ] [MainThread]: 
[0m23:45:27.579164 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:45:27.579164 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:45:27.579164 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:45:27.579164 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:45:27.580164 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:45:27.580164 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:45:27.581167 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:45:27.581167 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:45:27.582165 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:45:27.582165 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:45:27.582165 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:45:27.583166 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:45:27.585165 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:45:27.586164 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:45:27.587668 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:45:27.588674 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:45:27.583166 => 2023-03-30 23:45:27.588674
[0m23:45:27.588674 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:45:27.588674 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:45:27.585165 => 2023-03-30 23:45:27.588674
[0m23:45:27.612225 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:45:27.586164 => 2023-03-30 23:45:27.612225
[0m23:45:27.618733 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:45:27.618733 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:45:27.618733 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:45:27.622733 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:45:27.624733 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:45:27.625732 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:45:27.625732 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:45:27.625732 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:45:27.626732 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:45:27.626732 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:45:27.626732 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:45:27.626732 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:45:27.627733 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:45:27.627733 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:45:27.659833 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:45:27.660828 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:45:27.660828 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:45:27.660828 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:45:27.660828 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:45:27.661828 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select walmart.order_id,
    date(walmart.ship_date) - date(walmart.order_date) as os_delta,
	walmart.state
from walmart
where walmart.order_id is not null
order by os_delta desc
  );
[0m23:45:27.662829 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:45:27.667854 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:45:27.668360 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:45:27.668360 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:45:27.670367 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:45:27.670367 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2" rename to "view_2__dbt_backup"
[0m23:45:27.670367 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:45:27.672368 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:45:27.672368 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:45:27.673366 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:45:27.674367 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:45:27.675367 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m23:45:27.675367 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:45:27.689400 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:45:27.689400 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:45:27.690416 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:45:27.691411 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:45:27.691411 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:45:27.692405 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:45:27.692405 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:45:27.692405 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:45:27.696404 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:45:27.696404 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m23:45:27.697407 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:45:27.698441 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:45:27.698441 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m23:45:27.699440 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:45:27.699440 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m23:45:27.700440 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:45:27.619733 => 2023-03-30 23:45:27.700440
[0m23:45:27.701441 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:45:27.622733 => 2023-03-30 23:45:27.701441
[0m23:45:27.701441 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:45:27.701441 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:45:27.702440 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38c9e327-dbcb-4730-8c6d-917ccafb8039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BFD0EDE10>]}
[0m23:45:27.703440 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38c9e327-dbcb-4730-8c6d-917ccafb8039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BFCDFC2D0>]}
[0m23:45:27.703440 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.12s]
[0m23:45:27.704439 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.12s]
[0m23:45:27.705441 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:45:27.706440 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:45:27.758103 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:45:27.759108 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:45:27.759108 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:45:27.761108 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:45:27.763108 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:45:27.763108 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:45:27.764108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:45:27.765108 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:45:27.765108 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:45:27.766107 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:45:27.767670 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:45:27.767670 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:45:27.767670 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:45:27.768784 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:45:27.770801 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:45:27.770801 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:45:27.772552 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:45:27.772552 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:45:27.588674 => 2023-03-30 23:45:27.772552
[0m23:45:27.773568 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:45:27.773568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38c9e327-dbcb-4730-8c6d-917ccafb8039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BFC923CD0>]}
[0m23:45:27.774570 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.19s]
[0m23:45:27.774570 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:45:27.775564 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:45:27.776565 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:27.776565 [debug] [MainThread]: On master: BEGIN
[0m23:45:27.776565 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:45:27.805111 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:45:27.806112 [debug] [MainThread]: On master: COMMIT
[0m23:45:27.806112 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:27.806112 [debug] [MainThread]: On master: COMMIT
[0m23:45:27.806112 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:45:27.806112 [debug] [MainThread]: On master: Close
[0m23:45:27.807618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:27.807618 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:45:27.807618 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:45:27.807618 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:45:27.807618 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:45:27.808624 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:45:27.808624 [info ] [MainThread]: 
[0m23:45:27.808624 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m23:45:27.809623 [debug] [MainThread]: Command end result
[0m23:45:27.813623 [info ] [MainThread]: 
[0m23:45:27.814628 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:45:27.814628 [info ] [MainThread]: 
[0m23:45:27.814628 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:45:27.815624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BFCDE2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BFC860810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BFC861510>]}
[0m23:45:27.815624 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:46:05.698811 | 9ad4fa14-6357-42a8-b603-237751fd248d ==============================
[0m23:46:05.698811 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:46:05.699816 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:46:05.700816 [debug] [MainThread]: Tracking: tracking
[0m23:46:05.708322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE123594D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE11AFE450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE11ADE1D0>]}
[0m23:46:05.716327 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:46:05.750933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:46:05.750933 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:46:05.761789 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:46:05.778300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ad4fa14-6357-42a8-b603-237751fd248d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE12382ED0>]}
[0m23:46:05.782818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ad4fa14-6357-42a8-b603-237751fd248d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE11AFD690>]}
[0m23:46:05.782818 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:46:05.783814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ad4fa14-6357-42a8-b603-237751fd248d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1235F690>]}
[0m23:46:05.784816 [info ] [MainThread]: 
[0m23:46:05.786816 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:46:05.788321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:46:05.796327 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:46:05.797329 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:46:05.797329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:05.830170 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:46:05.831168 [debug] [ThreadPool]: On list_projeto: Close
[0m23:46:05.832167 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:46:05.837166 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:46:05.837166 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:46:05.837166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:05.866214 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:46:05.867215 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:46:05.867215 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:46:05.869728 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:46:05.870737 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:46:05.871734 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:46:05.876734 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:05.876734 [debug] [MainThread]: On master: BEGIN
[0m23:46:05.876734 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:05.906842 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:46:05.906842 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:05.906842 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:46:05.911356 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:46:05.913358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ad4fa14-6357-42a8-b603-237751fd248d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE125C0790>]}
[0m23:46:05.913358 [debug] [MainThread]: On master: ROLLBACK
[0m23:46:05.913358 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:05.914358 [debug] [MainThread]: On master: BEGIN
[0m23:46:05.914358 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:46:05.914358 [debug] [MainThread]: On master: COMMIT
[0m23:46:05.914358 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:05.915358 [debug] [MainThread]: On master: COMMIT
[0m23:46:05.915358 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:46:05.915358 [debug] [MainThread]: On master: Close
[0m23:46:05.916357 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:46:05.916357 [info ] [MainThread]: 
[0m23:46:05.919969 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:46:05.919969 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:46:05.919969 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:46:05.920981 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:46:05.920981 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:46:05.920981 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:46:05.921981 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:46:05.922981 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:46:05.922981 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:46:05.922981 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:46:05.923982 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:46:05.923982 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:46:05.925981 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:46:05.926982 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:46:05.928488 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:46:05.929495 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:46:05.923982 => 2023-03-30 23:46:05.928488
[0m23:46:05.929495 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:46:05.925981 => 2023-03-30 23:46:05.929495
[0m23:46:05.929495 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:46:05.929495 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:46:05.926982 => 2023-03-30 23:46:05.929495
[0m23:46:05.929495 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:46:05.959051 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:46:05.959051 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:46:05.962122 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:46:05.966123 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:46:05.966123 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:46:05.966123 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:46:05.967123 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:46:05.967123 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:46:05.967123 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:46:05.967123 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:46:05.967123 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:46:05.967123 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:46:05.968629 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:46:06.000170 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:46:06.000170 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:46:06.001173 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:46:06.002174 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:46:06.002174 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:46:06.002174 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:46:06.002174 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:46:06.007176 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:46:06.007176 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:46:06.007176 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:46:06.007176 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:46:06.009689 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:46:06.010693 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:46:06.010693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:46:06.010693 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:46:06.011694 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select
    date(walmart.ship_date) - date(walmart.order_date) as os_delta,
	walmart.state
from walmart
where walmart.order_id is not null
group by state
order by os_delta desc
  );
[0m23:46:06.012693 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:46:06.013693 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:46:06.013693 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:46:06.015694 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:46:06.015694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:46:06.015694 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "walmart.ship_date" must appear in the GROUP BY clause or be used in an aggregate function
LINE 5:     date(walmart.ship_date) - date(walmart.order_date) as os...
                 ^

[0m23:46:06.015694 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:46:06.030713 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:46:06.030713 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m23:46:06.031716 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:46:06.031716 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:46:06.031716 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:46:05.963122 => 2023-03-30 23:46:06.031716
[0m23:46:06.031716 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:46:06.033715 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:46:06.033715 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:46:06.033715 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:46:06.035714 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:46:06.035714 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:46:06.039219 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:46:06.040226 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:46:06.040226 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:46:06.042227 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:46:06.043225 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:46:06.043225 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:46:06.044225 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:46:05.930494 => 2023-03-30 23:46:06.044225
[0m23:46:06.045226 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:46:06.045226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad4fa14-6357-42a8-b603-237751fd248d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE12685FD0>]}
[0m23:46:06.045226 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:46:06.046240 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m23:46:06.047225 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:46:05.959051 => 2023-03-30 23:46:06.047225
[0m23:46:06.048732 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  column "walmart.ship_date" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 5:     date(walmart.ship_date) - date(walmart.order_date) as os...
                   ^
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:46:06.049739 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:46:06.049739 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:46:06.050739 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad4fa14-6357-42a8-b603-237751fd248d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE125C1950>]}
[0m23:46:06.050739 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad4fa14-6357-42a8-b603-237751fd248d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE126BF690>]}
[0m23:46:06.050739 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.13s]
[0m23:46:06.052245 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:46:06.052245 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:46:06.053251 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:46:06.054251 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:46:06.054251 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:06.054251 [debug] [MainThread]: On master: BEGIN
[0m23:46:06.055250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:06.083790 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:46:06.084789 [debug] [MainThread]: On master: COMMIT
[0m23:46:06.084789 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:06.084789 [debug] [MainThread]: On master: COMMIT
[0m23:46:06.085790 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:46:06.085790 [debug] [MainThread]: On master: Close
[0m23:46:06.085790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:06.086790 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:46:06.086790 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:46:06.086790 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:46:06.086790 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:46:06.086790 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:46:06.087794 [info ] [MainThread]: 
[0m23:46:06.087794 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m23:46:06.088790 [debug] [MainThread]: Command end result
[0m23:46:06.094048 [info ] [MainThread]: 
[0m23:46:06.095050 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:46:06.095050 [info ] [MainThread]: 
[0m23:46:06.095050 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m23:46:06.096047 [error] [MainThread]:   column "walmart.ship_date" must appear in the GROUP BY clause or be used in an aggregate function
[0m23:46:06.096047 [error] [MainThread]:   LINE 5:     date(walmart.ship_date) - date(walmart.order_date) as os...
[0m23:46:06.096047 [error] [MainThread]:                    ^
[0m23:46:06.096047 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:46:06.097047 [info ] [MainThread]: 
[0m23:46:06.097047 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:46:06.097047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE11B7B410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE12273A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE11AA6C10>]}
[0m23:46:06.097047 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:46:25.787361 | 0c315121-0a71-431c-b4bc-55cf8d2280e0 ==============================
[0m23:46:25.787361 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:46:25.788865 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:46:25.788865 [debug] [MainThread]: Tracking: tracking
[0m23:46:25.796871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0D29FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0CD77250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0CA2B3D0>]}
[0m23:46:25.805242 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:46:25.842299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:46:25.843300 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:46:25.853817 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:46:25.869844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c315121-0a71-431c-b4bc-55cf8d2280e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0CACFE50>]}
[0m23:46:25.874858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c315121-0a71-431c-b4bc-55cf8d2280e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0CCFA390>]}
[0m23:46:25.874858 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:46:25.875857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c315121-0a71-431c-b4bc-55cf8d2280e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0D203290>]}
[0m23:46:25.876856 [info ] [MainThread]: 
[0m23:46:25.877859 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:46:25.878856 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:46:25.888140 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:46:25.888140 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:46:25.888140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:25.921061 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:46:25.922062 [debug] [ThreadPool]: On list_projeto: Close
[0m23:46:25.923061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:46:25.928064 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:46:25.928064 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:46:25.928064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:25.957614 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:46:25.957614 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:46:25.957614 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:46:25.960128 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:46:25.962135 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:46:25.962135 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:46:25.967132 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:25.967132 [debug] [MainThread]: On master: BEGIN
[0m23:46:25.967132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:25.996590 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:46:25.996590 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:25.996590 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:46:26.000147 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:46:26.002158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c315121-0a71-431c-b4bc-55cf8d2280e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0C96BFD0>]}
[0m23:46:26.002158 [debug] [MainThread]: On master: ROLLBACK
[0m23:46:26.003149 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:26.003149 [debug] [MainThread]: On master: BEGIN
[0m23:46:26.003149 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:46:26.004150 [debug] [MainThread]: On master: COMMIT
[0m23:46:26.004150 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:26.004150 [debug] [MainThread]: On master: COMMIT
[0m23:46:26.005144 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:46:26.005144 [debug] [MainThread]: On master: Close
[0m23:46:26.005144 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:46:26.006143 [info ] [MainThread]: 
[0m23:46:26.010295 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:46:26.010295 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:46:26.010295 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:46:26.010295 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:46:26.011297 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:46:26.011297 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:46:26.012297 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:46:26.012297 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:46:26.012297 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:46:26.013294 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:46:26.013294 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:46:26.013294 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:46:26.015294 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:46:26.016296 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:46:26.018294 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:46:26.019296 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:46:26.013294 => 2023-03-30 23:46:26.019296
[0m23:46:26.019296 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:46:26.015294 => 2023-03-30 23:46:26.019296
[0m23:46:26.019296 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:46:26.019296 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:46:26.017294 => 2023-03-30 23:46:26.019296
[0m23:46:26.020379 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:46:26.048899 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:46:26.048899 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:46:26.051905 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:46:26.054904 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:46:26.055904 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:46:26.055904 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:46:26.055904 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:46:26.056905 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:46:26.056905 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:46:26.056905 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:46:26.056905 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:46:26.057905 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:46:26.057905 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:46:26.090957 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:46:26.090957 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:46:26.091954 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:46:26.091954 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:46:26.091954 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:46:26.091954 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:46:26.092954 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:46:26.092954 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:46:26.092954 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select
    date(walmart.ship_date) - date(walmart.order_date) as os_delta,
	walmart.state
from walmart
where walmart.order_id is not null
group by walmart.state
order by os_delta desc
  );
[0m23:46:26.093959 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:46:26.099461 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:46:26.099461 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "walmart.ship_date" must appear in the GROUP BY clause or be used in an aggregate function
LINE 5:     date(walmart.ship_date) - date(walmart.order_date) as os...
                 ^

[0m23:46:26.099461 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:46:26.099461 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:46:26.099461 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m23:46:26.101467 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:46:26.102467 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:46:26.052903 => 2023-03-30 23:46:26.102467
[0m23:46:26.102467 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:46:26.102467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:46:26.103467 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:46:26.104467 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:46:26.105467 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:46:26.106471 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:46:26.107472 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:46:26.108978 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:46:26.108978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:46:26.123494 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:46:26.123494 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:46:26.124074 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:46:26.125088 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:46:26.126086 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:46:26.126086 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:46:26.127087 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:46:26.127087 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:46:26.128087 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  column "walmart.ship_date" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 5:     date(walmart.ship_date) - date(walmart.order_date) as os...
                   ^
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:46:26.128087 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:46:26.131607 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:46:26.132606 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c315121-0a71-431c-b4bc-55cf8d2280e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0D693250>]}
[0m23:46:26.133607 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:46:26.133607 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:46:26.134606 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:46:26.134606 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.12s]
[0m23:46:26.136607 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:46:26.136607 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:46:26.136607 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:46:26.137606 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:46:26.048899 => 2023-03-30 23:46:26.137606
[0m23:46:26.139111 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:46:26.020379 => 2023-03-30 23:46:26.139111
[0m23:46:26.139111 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:46:26.139111 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:46:26.140117 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c315121-0a71-431c-b4bc-55cf8d2280e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0D60F090>]}
[0m23:46:26.140117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c315121-0a71-431c-b4bc-55cf8d2280e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0D52AF90>]}
[0m23:46:26.141118 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:46:26.141118 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:46:26.142117 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:46:26.142117 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:46:26.143119 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:46:26.143119 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:26.144116 [debug] [MainThread]: On master: BEGIN
[0m23:46:26.144116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:26.172306 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:46:26.173307 [debug] [MainThread]: On master: COMMIT
[0m23:46:26.173307 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:26.173307 [debug] [MainThread]: On master: COMMIT
[0m23:46:26.174308 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:46:26.174308 [debug] [MainThread]: On master: Close
[0m23:46:26.175307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:26.175307 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:46:26.175307 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:46:26.175307 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:46:26.175307 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:46:26.175307 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:46:26.176308 [info ] [MainThread]: 
[0m23:46:26.176308 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m23:46:26.177308 [debug] [MainThread]: Command end result
[0m23:46:26.181816 [info ] [MainThread]: 
[0m23:46:26.182817 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:46:26.182817 [info ] [MainThread]: 
[0m23:46:26.183817 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m23:46:26.183817 [error] [MainThread]:   column "walmart.ship_date" must appear in the GROUP BY clause or be used in an aggregate function
[0m23:46:26.183817 [error] [MainThread]:   LINE 5:     date(walmart.ship_date) - date(walmart.order_date) as os...
[0m23:46:26.184816 [error] [MainThread]:                    ^
[0m23:46:26.184816 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:46:26.184816 [info ] [MainThread]: 
[0m23:46:26.185816 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:46:26.185816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0D318350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0D53C0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0A579A50>]}
[0m23:46:26.185816 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:47:23.095858 | 421dc21c-9fc6-4959-894a-45de38765484 ==============================
[0m23:47:23.095858 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:47:23.097858 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:47:23.097858 [debug] [MainThread]: Tracking: tracking
[0m23:47:23.106368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A44B262010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A44B15FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A44B24E8D0>]}
[0m23:47:23.113880 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:47:23.150920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:47:23.150920 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:47:23.161434 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:47:23.177943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '421dc21c-9fc6-4959-894a-45de38765484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A44B712890>]}
[0m23:47:23.181452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '421dc21c-9fc6-4959-894a-45de38765484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A44BB4B550>]}
[0m23:47:23.181452 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:47:23.182956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '421dc21c-9fc6-4959-894a-45de38765484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A44B04DFD0>]}
[0m23:47:23.183965 [info ] [MainThread]: 
[0m23:47:23.184963 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:47:23.186962 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:47:23.195471 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:47:23.195471 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:47:23.195471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:23.230853 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:47:23.232168 [debug] [ThreadPool]: On list_projeto: Close
[0m23:47:23.233168 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:47:23.238168 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:47:23.238168 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:47:23.238168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:23.269117 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:47:23.269117 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:47:23.269117 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:47:23.271672 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:47:23.272653 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:47:23.273651 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:47:23.277652 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:23.278652 [debug] [MainThread]: On master: BEGIN
[0m23:47:23.278652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:47:23.306427 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:47:23.307428 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:23.307428 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:47:23.310932 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:47:23.312941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '421dc21c-9fc6-4959-894a-45de38765484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A44B1EFBD0>]}
[0m23:47:23.312941 [debug] [MainThread]: On master: ROLLBACK
[0m23:47:23.312941 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:23.312941 [debug] [MainThread]: On master: BEGIN
[0m23:47:23.313938 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:47:23.313938 [debug] [MainThread]: On master: COMMIT
[0m23:47:23.313938 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:23.314942 [debug] [MainThread]: On master: COMMIT
[0m23:47:23.314942 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:47:23.314942 [debug] [MainThread]: On master: Close
[0m23:47:23.315937 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:47:23.315937 [info ] [MainThread]: 
[0m23:47:23.318936 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:47:23.318936 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:47:23.318936 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:47:23.320441 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:47:23.320441 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:47:23.321447 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:47:23.321447 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:47:23.322446 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:47:23.322446 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:47:23.322446 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:47:23.323446 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:47:23.323446 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:47:23.325447 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:47:23.326446 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:47:23.328447 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:47:23.328447 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:47:23.323446 => 2023-03-30 23:47:23.328447
[0m23:47:23.329449 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:47:23.325447 => 2023-03-30 23:47:23.329449
[0m23:47:23.329449 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:47:23.329449 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:47:23.326446 => 2023-03-30 23:47:23.329449
[0m23:47:23.329449 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:47:23.358559 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:47:23.358559 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:47:23.361767 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:47:23.364766 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:47:23.364766 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:47:23.365768 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:47:23.365768 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:23.365768 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:47:23.365768 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:47:23.366768 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:47:23.366768 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:47:23.366768 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:47:23.367768 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:47:23.399771 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:47:23.400769 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:47:23.400769 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:23.400769 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:47:23.400769 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:47:23.400769 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select
    avg(date(walmart.ship_date) - date(walmart.order_date)) as os_delta,
	walmart.state
from walmart
where walmart.order_id is not null
order by os_delta desc
  );
[0m23:47:23.402808 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "walmart.state" must appear in the GROUP BY clause or be used in an aggregate function
LINE 6:  walmart.state
         ^

[0m23:47:23.402808 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m23:47:23.402808 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:47:23.361767 => 2023-03-30 23:47:23.402808
[0m23:47:23.402808 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:47:23.403808 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:47:23.408807 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:23.409807 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:47:23.410810 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:47:23.412976 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:23.412976 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:47:23.413981 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:47:23.427486 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:47:23.428488 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:23.428488 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:47:23.429488 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  column "walmart.state" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 6:  walmart.state
           ^
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:47:23.430488 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:47:23.430488 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421dc21c-9fc6-4959-894a-45de38765484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A44BB69250>]}
[0m23:47:23.434568 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:23.434568 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.11s]
[0m23:47:23.435570 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:47:23.436568 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:47:23.437574 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:47:23.438570 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:47:23.358559 => 2023-03-30 23:47:23.438570
[0m23:47:23.438570 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:47:23.439568 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421dc21c-9fc6-4959-894a-45de38765484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A44BB6F310>]}
[0m23:47:23.439568 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.12s]
[0m23:47:23.440569 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:47:23.504983 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:47:23.505977 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:47:23.505977 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:47:23.506977 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:47:23.508978 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:47:23.508978 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:47:23.510485 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:47:23.512492 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:47:23.512492 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:47:23.512492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:47:23.514498 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:47:23.514498 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:47:23.514498 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:47:23.515654 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:47:23.516670 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:47:23.516670 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:47:23.518386 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:47:23.518386 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:47:23.330446 => 2023-03-30 23:47:23.518386
[0m23:47:23.519401 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:47:23.519401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421dc21c-9fc6-4959-894a-45de38765484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A44BA991D0>]}
[0m23:47:23.520403 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.20s]
[0m23:47:23.520403 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:47:23.521851 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:47:23.521851 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:23.522844 [debug] [MainThread]: On master: BEGIN
[0m23:47:23.522844 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:47:23.550871 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:47:23.550871 [debug] [MainThread]: On master: COMMIT
[0m23:47:23.552110 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:23.552110 [debug] [MainThread]: On master: COMMIT
[0m23:47:23.552110 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:47:23.553110 [debug] [MainThread]: On master: Close
[0m23:47:23.553110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:47:23.553110 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:47:23.553110 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:47:23.554110 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:47:23.554110 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:47:23.554110 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:47:23.554110 [info ] [MainThread]: 
[0m23:47:23.555109 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m23:47:23.555109 [debug] [MainThread]: Command end result
[0m23:47:23.560613 [info ] [MainThread]: 
[0m23:47:23.560613 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:47:23.561620 [info ] [MainThread]: 
[0m23:47:23.561620 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m23:47:23.561620 [error] [MainThread]:   column "walmart.state" must appear in the GROUP BY clause or be used in an aggregate function
[0m23:47:23.562619 [error] [MainThread]:   LINE 6:  walmart.state
[0m23:47:23.562619 [error] [MainThread]:            ^
[0m23:47:23.562619 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:47:23.563618 [info ] [MainThread]: 
[0m23:47:23.563618 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:47:23.563618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A44B7E3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A44BB1BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A448AC9C50>]}
[0m23:47:23.564620 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:47:37.143848 | f6c2c829-3036-482b-9d62-1c52c3b7b79f ==============================
[0m23:47:37.143848 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:47:37.145845 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:47:37.145845 [debug] [MainThread]: Tracking: tracking
[0m23:47:37.154363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CA57C9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CAA4A490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CA98AE10>]}
[0m23:47:37.161873 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:47:37.195896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:47:37.195896 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:47:37.207011 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:47:37.223717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6c2c829-3036-482b-9d62-1c52c3b7b79f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CA99D850>]}
[0m23:47:37.227719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6c2c829-3036-482b-9d62-1c52c3b7b79f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CAD8B590>]}
[0m23:47:37.228718 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:47:37.228718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6c2c829-3036-482b-9d62-1c52c3b7b79f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CA947A90>]}
[0m23:47:37.229719 [info ] [MainThread]: 
[0m23:47:37.231224 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:47:37.233232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:47:37.242631 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:47:37.243632 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:47:37.243632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:37.275701 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:47:37.277703 [debug] [ThreadPool]: On list_projeto: Close
[0m23:47:37.279706 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:47:37.284226 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:47:37.284226 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:47:37.284226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:37.313915 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:47:37.313915 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:47:37.313915 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:47:37.316918 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:47:37.317920 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:47:37.317920 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:47:37.323432 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:37.323432 [debug] [MainThread]: On master: BEGIN
[0m23:47:37.323432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:47:37.352962 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:47:37.352962 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:37.353962 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:47:37.356961 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:47:37.358963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6c2c829-3036-482b-9d62-1c52c3b7b79f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CAD1DCD0>]}
[0m23:47:37.358963 [debug] [MainThread]: On master: ROLLBACK
[0m23:47:37.358963 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:37.358963 [debug] [MainThread]: On master: BEGIN
[0m23:47:37.359963 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:47:37.359963 [debug] [MainThread]: On master: COMMIT
[0m23:47:37.359963 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:37.360962 [debug] [MainThread]: On master: COMMIT
[0m23:47:37.360962 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:47:37.360962 [debug] [MainThread]: On master: Close
[0m23:47:37.360962 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:47:37.362250 [info ] [MainThread]: 
[0m23:47:37.365649 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:47:37.365649 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:47:37.365649 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:47:37.366662 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:47:37.366662 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:47:37.366662 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:47:37.367662 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:47:37.367662 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:47:37.368663 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:47:37.368663 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:47:37.368663 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:47:37.369663 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:47:37.371170 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:47:37.372177 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:47:37.374176 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:47:37.375176 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:47:37.369663 => 2023-03-30 23:47:37.375176
[0m23:47:37.375176 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:47:37.372177 => 2023-03-30 23:47:37.375176
[0m23:47:37.375176 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:47:37.371170 => 2023-03-30 23:47:37.375176
[0m23:47:37.375176 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:47:37.376176 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:47:37.376176 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:47:37.405215 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:47:37.409217 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:47:37.412730 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:47:37.412730 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:47:37.413736 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:47:37.413736 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:47:37.413736 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:37.413736 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:47:37.414737 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:47:37.414737 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:47:37.414737 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:47:37.414737 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:47:37.445272 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:47:37.445272 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:47:37.446272 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:47:37.447277 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:47:37.452783 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:47:37.452783 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:47:37.452783 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:47:37.453785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:47:37.453785 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:37.455784 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:47:37.455784 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:47:37.455784 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:47:37.456783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:47:37.471631 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:47:37.471631 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:47:37.471631 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:47:37.473637 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:37.474636 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:47:37.474636 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:47:37.475636 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:47:37.475636 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:47:37.477638 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:37.481139 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:47:37.481139 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:47:37.482144 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:47:37.482144 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:47:37.484146 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:47:37.484146 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:47:37.484146 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:37.485146 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:47:37.376176 => 2023-03-30 23:47:37.485146
[0m23:47:37.485146 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:47:37.486146 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:47:37.487146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6c2c829-3036-482b-9d62-1c52c3b7b79f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CAA4DF50>]}
[0m23:47:37.487146 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:47:37.488654 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:37.487146 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m23:47:37.489662 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:47:37.491167 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:47:37.492175 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:47:37.493174 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:47:37.409217 => 2023-03-30 23:47:37.493174
[0m23:47:37.493174 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:47:37.493174 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6c2c829-3036-482b-9d62-1c52c3b7b79f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CADAF450>]}
[0m23:47:37.494174 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:47:37.494174 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:47:37.558036 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:47:37.559034 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:47:37.559034 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select
    avg(date(walmart.ship_date) - date(walmart.order_date)) as os_delta,
	walmart.state
from walmart
where walmart.order_id is not null
group by walmart.state
order by os_delta desc
  );
[0m23:47:37.561036 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:47:37.563125 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:47:37.564127 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2" rename to "view_2__dbt_backup"
[0m23:47:37.564127 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:47:37.566123 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:47:37.566123 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m23:47:37.567125 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:47:37.568124 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:47:37.568124 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:47:37.569125 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:47:37.569125 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m23:47:37.571627 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:47:37.571627 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m23:47:37.572634 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m23:47:37.573632 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:47:37.406216 => 2023-03-30 23:47:37.573632
[0m23:47:37.573632 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:47:37.574633 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6c2c829-3036-482b-9d62-1c52c3b7b79f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CAE17310>]}
[0m23:47:37.574633 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.21s]
[0m23:47:37.575635 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:47:37.576634 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:47:37.577634 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:37.577634 [debug] [MainThread]: On master: BEGIN
[0m23:47:37.577634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:47:37.715813 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:47:37.715813 [debug] [MainThread]: On master: COMMIT
[0m23:47:37.716808 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:37.716808 [debug] [MainThread]: On master: COMMIT
[0m23:47:37.716808 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:47:37.716808 [debug] [MainThread]: On master: Close
[0m23:47:37.717808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:47:37.717808 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:47:37.717808 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:47:37.718813 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:47:37.718813 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:47:37.718813 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:47:37.718813 [info ] [MainThread]: 
[0m23:47:37.719808 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m23:47:37.719808 [debug] [MainThread]: Command end result
[0m23:47:37.724325 [info ] [MainThread]: 
[0m23:47:37.724325 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:47:37.725320 [info ] [MainThread]: 
[0m23:47:37.725320 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:47:37.726320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CA18FFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CA1DD590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CAA64590>]}
[0m23:47:37.726320 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:48:50.721330 | 5e140a09-89cb-4512-be60-1aa73fa13a87 ==============================
[0m23:48:50.721330 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:48:50.722836 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:48:50.723847 [debug] [MainThread]: Tracking: tracking
[0m23:48:50.731843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF75BE110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF7902F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF75BE910>]}
[0m23:48:50.739364 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:48:50.774431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:48:50.775438 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:48:50.785952 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:48:50.801471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e140a09-89cb-4512-be60-1aa73fa13a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF7879DD0>]}
[0m23:48:50.806994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e140a09-89cb-4512-be60-1aa73fa13a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF80BEC10>]}
[0m23:48:50.807994 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:48:50.807994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e140a09-89cb-4512-be60-1aa73fa13a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF7E2FED0>]}
[0m23:48:50.808993 [info ] [MainThread]: 
[0m23:48:50.810995 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:48:50.812499 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:48:50.820035 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:48:50.821034 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:48:50.821034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:50.856062 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:48:50.858060 [debug] [ThreadPool]: On list_projeto: Close
[0m23:48:50.859064 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:48:50.863566 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:48:50.863566 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:48:50.864575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:50.997768 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:48:50.998330 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:48:50.998330 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:48:51.000357 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:48:51.001348 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:48:51.001348 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:48:51.006865 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:51.007865 [debug] [MainThread]: On master: BEGIN
[0m23:48:51.007865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:48:51.036940 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:48:51.036940 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:51.037937 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:48:51.040938 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:48:51.042940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e140a09-89cb-4512-be60-1aa73fa13a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF7E54090>]}
[0m23:48:51.044290 [debug] [MainThread]: On master: ROLLBACK
[0m23:48:51.044290 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:51.044290 [debug] [MainThread]: On master: BEGIN
[0m23:48:51.045291 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:48:51.045291 [debug] [MainThread]: On master: COMMIT
[0m23:48:51.046293 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:51.046293 [debug] [MainThread]: On master: COMMIT
[0m23:48:51.046293 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:48:51.047291 [debug] [MainThread]: On master: Close
[0m23:48:51.048293 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:48:51.048293 [info ] [MainThread]: 
[0m23:48:51.053810 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:48:51.053810 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:48:51.053810 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:48:51.054811 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:48:51.054811 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:48:51.054811 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:48:51.055812 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:48:51.056811 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:48:51.056811 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:48:51.056811 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:48:51.057811 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:48:51.057811 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:48:51.059814 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:48:51.060811 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:48:51.062810 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:48:51.062810 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:48:51.057811 => 2023-03-30 23:48:51.062810
[0m23:48:51.064267 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:48:51.059814 => 2023-03-30 23:48:51.062810
[0m23:48:51.064267 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:48:51.060811 => 2023-03-30 23:48:51.064267
[0m23:48:51.064267 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:48:51.064267 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:48:51.064267 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:48:51.094822 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:48:51.097827 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:48:51.100828 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:48:51.101829 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:48:51.101829 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:48:51.101829 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:48:51.101829 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:48:51.102829 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:48:51.102829 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:48:51.102829 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:48:51.102829 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:48:51.103931 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:48:51.137014 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:48:51.137014 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:48:51.137014 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:48:51.138014 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:48:51.138014 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:48:51.138014 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:48:51.139018 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:48:51.139018 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:48:51.139018 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select
    avg(date(walmart.ship_date) - date(walmart.order_date)) as order_ship_delta,
	walmart.state
from walmart
where walmart.order_id is not null
group by walmart.state
order by os_delta desc
  );
[0m23:48:51.140017 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:48:51.140017 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:48:51.144527 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:48:51.144527 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "os_delta" does not exist
LINE 10: order by os_delta desc
                  ^

[0m23:48:51.146530 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:48:51.147528 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:48:51.147528 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m23:48:51.147528 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:48:51.148527 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:48:51.097827 => 2023-03-30 23:48:51.148527
[0m23:48:51.148527 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:48:51.148527 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:48:51.148527 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:48:51.150526 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:48:51.153032 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:48:51.154038 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:48:51.154038 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:48:51.155040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:48:51.155040 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:48:51.169558 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:48:51.170556 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:48:51.171556 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:48:51.171556 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:48:51.171556 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:48:51.171556 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:48:51.174069 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  column "os_delta" does not exist
  LINE 10: order by os_delta desc
                    ^
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:48:51.174069 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:48:51.174069 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e140a09-89cb-4512-be60-1aa73fa13a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF823CDD0>]}
[0m23:48:51.174069 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:48:51.178071 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:48:51.179080 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.12s]
[0m23:48:51.180071 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:48:51.181070 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:48:51.182070 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:48:51.182070 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:48:51.183069 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:48:51.184151 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:48:51.185152 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:48:51.065267 => 2023-03-30 23:48:51.185152
[0m23:48:51.186150 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:48:51.094822 => 2023-03-30 23:48:51.186150
[0m23:48:51.186150 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:48:51.186150 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:48:51.187149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e140a09-89cb-4512-be60-1aa73fa13a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF7671550>]}
[0m23:48:51.187149 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e140a09-89cb-4512-be60-1aa73fa13a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF8198350>]}
[0m23:48:51.188149 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:48:51.188149 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:48:51.189148 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:48:51.189148 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:48:51.190150 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:48:51.190150 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:51.191149 [debug] [MainThread]: On master: BEGIN
[0m23:48:51.191149 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:48:51.220211 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:48:51.221208 [debug] [MainThread]: On master: COMMIT
[0m23:48:51.221208 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:51.221208 [debug] [MainThread]: On master: COMMIT
[0m23:48:51.221208 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:48:51.221208 [debug] [MainThread]: On master: Close
[0m23:48:51.222766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:51.222766 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:48:51.222766 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:48:51.222766 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:48:51.223726 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:48:51.223726 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:48:51.223726 [info ] [MainThread]: 
[0m23:48:51.223726 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m23:48:51.224725 [debug] [MainThread]: Command end result
[0m23:48:51.229721 [info ] [MainThread]: 
[0m23:48:51.230726 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:48:51.230726 [info ] [MainThread]: 
[0m23:48:51.231723 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m23:48:51.231723 [error] [MainThread]:   column "os_delta" does not exist
[0m23:48:51.231723 [error] [MainThread]:   LINE 10: order by os_delta desc
[0m23:48:51.232722 [error] [MainThread]:                     ^
[0m23:48:51.232722 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m23:48:51.232722 [info ] [MainThread]: 
[0m23:48:51.232722 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:48:51.233745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF75CA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF7E672D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF7E66750>]}
[0m23:48:51.233745 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:49:02.001521 | d543e150-8ad8-4701-9643-0b0c8055e2b2 ==============================
[0m23:49:02.001521 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:49:02.003024 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:49:02.003024 [debug] [MainThread]: Tracking: tracking
[0m23:49:02.011575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002155041A550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002155041EF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002155042F610>]}
[0m23:49:02.019591 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:49:02.053118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:49:02.053623 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:49:02.064136 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:49:02.081658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd543e150-8ad8-4701-9643-0b0c8055e2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154FFA1790>]}
[0m23:49:02.088178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd543e150-8ad8-4701-9643-0b0c8055e2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215504DE990>]}
[0m23:49:02.089182 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:49:02.089182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd543e150-8ad8-4701-9643-0b0c8055e2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154FC59D10>]}
[0m23:49:02.090184 [info ] [MainThread]: 
[0m23:49:02.092183 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:49:02.093178 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:49:02.102266 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:49:02.102266 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:49:02.102266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:02.136833 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:49:02.137827 [debug] [ThreadPool]: On list_projeto: Close
[0m23:49:02.139834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:49:02.144342 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:49:02.144342 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:49:02.144342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:02.173884 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:49:02.173884 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:49:02.174890 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:49:02.176890 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:49:02.177889 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:49:02.178889 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:49:02.183396 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:02.183396 [debug] [MainThread]: On master: BEGIN
[0m23:49:02.184401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:49:02.213350 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:49:02.213350 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:02.213350 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:49:02.217355 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:49:02.218860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd543e150-8ad8-4701-9643-0b0c8055e2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215507CDF90>]}
[0m23:49:02.218860 [debug] [MainThread]: On master: ROLLBACK
[0m23:49:02.218860 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:02.219870 [debug] [MainThread]: On master: BEGIN
[0m23:49:02.219870 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:49:02.219870 [debug] [MainThread]: On master: COMMIT
[0m23:49:02.220868 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:02.220868 [debug] [MainThread]: On master: COMMIT
[0m23:49:02.220868 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:49:02.220868 [debug] [MainThread]: On master: Close
[0m23:49:02.221868 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:49:02.221868 [info ] [MainThread]: 
[0m23:49:02.226384 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:49:02.226384 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:49:02.226384 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:49:02.226384 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:49:02.227386 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:49:02.227386 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:49:02.228383 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:49:02.228383 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:49:02.229384 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:49:02.229384 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:49:02.229384 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:49:02.229384 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:49:02.231383 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:49:02.233386 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:49:02.233893 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:49:02.234899 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:49:02.230387 => 2023-03-30 23:49:02.234899
[0m23:49:02.234899 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:49:02.232383 => 2023-03-30 23:49:02.234899
[0m23:49:02.235903 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:49:02.235903 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:49:02.233386 => 2023-03-30 23:49:02.235903
[0m23:49:02.235903 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:49:02.259926 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:49:02.264438 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:49:02.268441 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:49:02.270629 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:49:02.271639 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:49:02.271639 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:49:02.271639 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:49:02.273144 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:49:02.273144 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:49:02.273144 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:49:02.273144 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:49:02.273144 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:49:02.274151 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:49:02.307258 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:49:02.307258 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:49:02.307258 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:49:02.308256 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:49:02.308256 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:49:02.308256 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select walmart.order_id,
	date(walmart.order_date) as order_date,
	walmart.quantity,
	walmart.sales,
	walmart.profit,
	walmart.state
from walmart
where walmart.profit > walmart.sales*0.4 and
walmart.order_id is not null
  );
[0m23:49:02.309256 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:49:02.314764 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:49:02.314764 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:49:02.314764 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:49:02.314764 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:49:02.316763 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:49:02.317765 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:49:02.317765 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:49:02.317765 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:49:02.317765 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select
    avg(date(walmart.ship_date) - date(walmart.order_date)) as order_ship_delta,
	walmart.state
from walmart
where walmart.order_id is not null
group by walmart.state
order by order_ship_delta desc
  );
[0m23:49:02.320279 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:49:02.320279 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:49:02.320279 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:49:02.322280 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:49:02.322280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:49:02.322280 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:49:02.323279 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:49:02.336962 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:49:02.338964 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:49:02.339962 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:49:02.339962 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:49:02.339962 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2" rename to "view_2__dbt_backup"
[0m23:49:02.339962 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:49:02.341964 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:49:02.341964 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:49:02.341964 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:49:02.342962 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:49:02.342962 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:49:02.345069 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:49:02.348069 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:49:02.349069 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:49:02.349069 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m23:49:02.349069 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:49:02.351070 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:49:02.351070 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:49:02.351070 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:49:02.353071 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:49:02.353071 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:49:02.354549 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:49:02.354549 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:49:02.355550 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:49:02.235903 => 2023-03-30 23:49:02.355550
[0m23:49:02.356548 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:49:02.265437 => 2023-03-30 23:49:02.356548
[0m23:49:02.356548 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:49:02.356548 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:49:02.356548 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:49:02.357548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd543e150-8ad8-4701-9643-0b0c8055e2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021550408710>]}
[0m23:49:02.357548 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m23:49:02.358551 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd543e150-8ad8-4701-9643-0b0c8055e2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021550543F10>]}
[0m23:49:02.358551 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:49:02.360549 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:49:02.360549 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:49:02.361549 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:49:02.361549 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m23:49:02.363053 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:49:02.364060 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m23:49:02.365060 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:49:02.268613 => 2023-03-30 23:49:02.365060
[0m23:49:02.365060 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:49:02.366063 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd543e150-8ad8-4701-9643-0b0c8055e2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215508D6C50>]}
[0m23:49:02.366063 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.14s]
[0m23:49:02.366063 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:49:02.368062 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:49:02.368062 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:02.368062 [debug] [MainThread]: On master: BEGIN
[0m23:49:02.368062 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:49:02.397249 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:49:02.398246 [debug] [MainThread]: On master: COMMIT
[0m23:49:02.398246 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:02.398246 [debug] [MainThread]: On master: COMMIT
[0m23:49:02.399242 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:49:02.399242 [debug] [MainThread]: On master: Close
[0m23:49:02.400249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:02.400249 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:49:02.400249 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:49:02.400249 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:49:02.400249 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:49:02.401248 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:49:02.401248 [info ] [MainThread]: 
[0m23:49:02.401248 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m23:49:02.402247 [debug] [MainThread]: Command end result
[0m23:49:02.406760 [info ] [MainThread]: 
[0m23:49:02.406760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:49:02.406760 [info ] [MainThread]: 
[0m23:49:02.407754 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:49:02.407754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154FC26E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215507AFCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021550409790>]}
[0m23:49:02.407754 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:51:55.278318 | f32491c9-154f-4e4c-86c9-2e8dd6fbafa8 ==============================
[0m23:51:55.278318 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:51:55.279330 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:51:55.280328 [debug] [MainThread]: Tracking: tracking
[0m23:51:55.288844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E57495A110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E574A08E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5749FFA50>]}
[0m23:51:55.296844 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:51:55.332615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:51:55.332615 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m23:51:55.344128 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:51:55.360663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f32491c9-154f-4e4c-86c9-2e8dd6fbafa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E57494F490>]}
[0m23:51:55.364664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f32491c9-154f-4e4c-86c9-2e8dd6fbafa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E57445A910>]}
[0m23:51:55.365662 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:51:55.365662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f32491c9-154f-4e4c-86c9-2e8dd6fbafa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E574445050>]}
[0m23:51:55.366662 [info ] [MainThread]: 
[0m23:51:55.368756 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:51:55.369758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:51:55.378269 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:51:55.378269 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:51:55.378269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:55.410819 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:51:55.411819 [debug] [ThreadPool]: On list_projeto: Close
[0m23:51:55.413822 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:51:55.418322 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:51:55.418322 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:51:55.418322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:55.447869 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:51:55.447869 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:51:55.447869 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:51:55.450874 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:51:55.451876 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:51:55.451876 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:51:55.456402 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:55.456402 [debug] [MainThread]: On master: BEGIN
[0m23:51:55.457910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:55.485957 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:51:55.485957 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:55.487462 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:51:55.490467 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:51:55.492471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f32491c9-154f-4e4c-86c9-2e8dd6fbafa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E574C7FE90>]}
[0m23:51:55.492471 [debug] [MainThread]: On master: ROLLBACK
[0m23:51:55.492471 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:55.493472 [debug] [MainThread]: On master: BEGIN
[0m23:51:55.493472 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:51:55.493472 [debug] [MainThread]: On master: COMMIT
[0m23:51:55.494468 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:55.494468 [debug] [MainThread]: On master: COMMIT
[0m23:51:55.494468 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:51:55.494468 [debug] [MainThread]: On master: Close
[0m23:51:55.495472 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:51:55.495472 [info ] [MainThread]: 
[0m23:51:55.498980 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:51:55.499977 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:51:55.499977 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:51:55.499977 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:51:55.500979 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:51:55.500979 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:51:55.500979 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:51:55.501979 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:51:55.501979 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:51:55.502978 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:51:55.502978 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:51:55.502978 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:51:55.504979 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:51:55.505980 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:51:55.507486 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:51:55.508492 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:51:55.502978 => 2023-03-30 23:51:55.508492
[0m23:51:55.508492 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:51:55.508492 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:51:55.504979 => 2023-03-30 23:51:55.508492
[0m23:51:55.539054 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:51:55.539054 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:51:55.505980 => 2023-03-30 23:51:55.539054
[0m23:51:55.539054 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:51:55.540049 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:51:55.540049 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:51:55.543053 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:51:55.546048 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:51:55.546048 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:51:55.547553 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:51:55.547553 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:51:55.547553 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:51:55.548561 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:51:55.548561 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:51:55.548561 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:51:55.548561 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:51:55.580571 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:51:55.581565 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:51:55.581565 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:51:55.582570 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:51:55.582570 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:51:55.582570 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:51:55.583566 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select
	walmart.profit / walmart.sales as margin,
	walmart.category
from walmart
  );
[0m23:51:55.588071 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:51:55.589077 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:51:55.589077 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:51:55.589077 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:51:55.589077 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select
    avg(date(walmart.ship_date) - date(walmart.order_date)) as order_ship_delta,
	walmart.state
from walmart
where walmart.order_id is not null
group by walmart.state
order by order_ship_delta desc
  );
[0m23:51:55.590077 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:51:55.590077 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:51:55.592078 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:51:55.592078 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:51:55.594078 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:51:55.594078 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:51:55.596076 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:51:55.596076 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:51:55.596076 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2" rename to "view_2__dbt_backup"
[0m23:51:55.596076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:51:55.611114 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:51:55.611114 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:51:55.612118 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:51:55.612118 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:51:55.614115 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:51:55.615114 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:51:55.616113 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:51:55.616113 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:51:55.616113 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m23:51:55.616113 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:51:55.616113 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:51:55.617618 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:51:55.618624 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:51:55.622625 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:51:55.623624 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:51:55.623624 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:51:55.624626 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:51:55.624626 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:51:55.624626 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:51:55.624626 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:51:55.625624 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:51:55.625624 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m23:51:55.625624 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:51:55.628129 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:51:55.630136 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:51:55.631136 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:51:55.508492 => 2023-03-30 23:51:55.631136
[0m23:51:55.631136 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:51:55.631136 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m23:51:55.632135 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:51:55.632135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f32491c9-154f-4e4c-86c9-2e8dd6fbafa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5749FDD50>]}
[0m23:51:55.633135 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m23:51:55.633135 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:51:55.634136 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:51:55.543053 => 2023-03-30 23:51:55.634136
[0m23:51:55.633135 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:51:55.635137 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:51:55.540049 => 2023-03-30 23:51:55.635137
[0m23:51:55.635137 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:51:55.636135 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:51:55.636135 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:51:55.637640 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f32491c9-154f-4e4c-86c9-2e8dd6fbafa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E574CCBFD0>]}
[0m23:51:55.638648 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f32491c9-154f-4e4c-86c9-2e8dd6fbafa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E574907E90>]}
[0m23:51:55.638648 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.14s]
[0m23:51:55.639648 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.14s]
[0m23:51:55.639648 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:51:55.639648 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:51:55.641647 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:51:55.641647 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:55.641647 [debug] [MainThread]: On master: BEGIN
[0m23:51:55.641647 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:55.671246 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:51:55.671246 [debug] [MainThread]: On master: COMMIT
[0m23:51:55.672247 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:55.672247 [debug] [MainThread]: On master: COMMIT
[0m23:51:55.672247 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:51:55.673247 [debug] [MainThread]: On master: Close
[0m23:51:55.673247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:55.673247 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:51:55.674251 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:51:55.674251 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:51:55.674251 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:51:55.674251 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:51:55.674251 [info ] [MainThread]: 
[0m23:51:55.675248 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m23:51:55.675248 [debug] [MainThread]: Command end result
[0m23:51:55.679758 [info ] [MainThread]: 
[0m23:51:55.680759 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:51:55.680759 [info ] [MainThread]: 
[0m23:51:55.681760 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:51:55.681760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5740DC0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E574532590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E574434690>]}
[0m23:51:55.681760 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:52:23.862539 | 8a0036df-a815-46a0-9258-f0c5ea6bab2c ==============================
[0m23:52:23.862539 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:52:23.863547 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:52:23.863547 [debug] [MainThread]: Tracking: tracking
[0m23:52:23.872572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D00D29490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D00D2A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D014E9810>]}
[0m23:52:23.880085 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:52:23.914648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:52:23.914648 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m23:52:23.925163 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:52:23.942200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a0036df-a815-46a0-9258-f0c5ea6bab2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D00D24510>]}
[0m23:52:23.946200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a0036df-a815-46a0-9258-f0c5ea6bab2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D0158FAD0>]}
[0m23:52:23.947200 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:52:23.947200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a0036df-a815-46a0-9258-f0c5ea6bab2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D014BCE90>]}
[0m23:52:23.948704 [info ] [MainThread]: 
[0m23:52:23.949710 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:52:23.950708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:52:23.959217 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:52:23.959217 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:52:23.960218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:23.991256 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:52:23.993259 [debug] [ThreadPool]: On list_projeto: Close
[0m23:52:23.994257 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:52:23.998771 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:52:23.999781 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:52:23.999781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:24.029143 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:52:24.029143 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:52:24.029143 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:52:24.032184 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:52:24.033184 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:52:24.033184 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:52:24.038170 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:24.038170 [debug] [MainThread]: On master: BEGIN
[0m23:52:24.038170 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:52:24.066909 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:52:24.066909 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:24.066909 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:52:24.071458 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:52:24.072445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a0036df-a815-46a0-9258-f0c5ea6bab2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D010DC9D0>]}
[0m23:52:24.073445 [debug] [MainThread]: On master: ROLLBACK
[0m23:52:24.073445 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:24.073445 [debug] [MainThread]: On master: BEGIN
[0m23:52:24.074443 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:52:24.074443 [debug] [MainThread]: On master: COMMIT
[0m23:52:24.074443 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:24.074443 [debug] [MainThread]: On master: COMMIT
[0m23:52:24.075444 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:52:24.075444 [debug] [MainThread]: On master: Close
[0m23:52:24.076445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:52:24.076445 [info ] [MainThread]: 
[0m23:52:24.080125 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:52:24.080637 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:52:24.080637 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:52:24.080637 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:52:24.081644 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:52:24.081644 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:52:24.082644 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:52:24.082644 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:52:24.082644 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:52:24.083643 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:52:24.083643 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:52:24.083643 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:52:24.085645 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:52:24.086645 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:52:24.088151 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:52:24.089158 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:52:24.083643 => 2023-03-30 23:52:24.089158
[0m23:52:24.089158 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:52:24.090156 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:52:24.085645 => 2023-03-30 23:52:24.090156
[0m23:52:24.090156 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:52:24.086645 => 2023-03-30 23:52:24.090156
[0m23:52:24.118683 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:52:24.118683 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:52:24.119571 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:52:24.122091 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:52:24.123091 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:52:24.126101 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:52:24.126101 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:52:24.127091 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:52:24.127091 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:52:24.127091 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:52:24.127091 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:52:24.127091 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:52:24.127091 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:52:24.128597 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:52:24.161150 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:52:24.161150 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:52:24.161150 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:52:24.161150 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:52:24.162657 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:52:24.162657 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select
	AVG(walmart.profit / walmart.sales) as margin,
	walmart.category
from walmart
group by category
  );
[0m23:52:24.163668 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:52:24.163668 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:52:24.169178 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:52:24.169178 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:52:24.170180 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:52:24.170180 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:52:24.172177 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:52:24.172177 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select
    avg(date(walmart.ship_date) - date(walmart.order_date)) as order_ship_delta,
	walmart.state
from walmart
where walmart.order_id is not null
group by walmart.state
order by order_ship_delta desc
  );
[0m23:52:24.173178 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:52:24.173178 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:52:24.175177 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:52:24.175177 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:52:24.175177 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:52:24.175177 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:52:24.177179 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:52:24.179692 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:52:24.179692 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:52:24.179692 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:52:24.180696 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2" rename to "view_2__dbt_backup"
[0m23:52:24.195211 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:52:24.195211 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:52:24.195211 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:52:24.197207 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:52:24.197207 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:52:24.197207 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:52:24.198211 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:52:24.199722 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:52:24.200722 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:52:24.200722 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m23:52:24.200722 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:52:24.204728 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:52:24.204728 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:52:24.204728 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:52:24.205722 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:52:24.206722 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:52:24.208226 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:52:24.209232 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:52:24.209232 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:52:24.209232 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:52:24.210235 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:52:24.210235 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m23:52:24.210235 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:52:24.212231 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:52:24.090156 => 2023-03-30 23:52:24.212231
[0m23:52:24.214231 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:52:24.215232 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:52:24.120083 => 2023-03-30 23:52:24.215232
[0m23:52:24.215232 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:52:24.215232 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m23:52:24.215232 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:52:24.216231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a0036df-a815-46a0-9258-f0c5ea6bab2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D014DCE90>]}
[0m23:52:24.216231 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a0036df-a815-46a0-9258-f0c5ea6bab2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D0158EF90>]}
[0m23:52:24.217234 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m23:52:24.217234 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m23:52:24.217234 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:52:24.218233 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:52:24.123091 => 2023-03-30 23:52:24.218233
[0m23:52:24.220296 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:52:24.220296 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:52:24.220296 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:52:24.221297 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a0036df-a815-46a0-9258-f0c5ea6bab2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D018FA190>]}
[0m23:52:24.222299 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.14s]
[0m23:52:24.222299 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:52:24.223298 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:52:24.224296 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:24.224296 [debug] [MainThread]: On master: BEGIN
[0m23:52:24.224296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:52:24.252854 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:52:24.253850 [debug] [MainThread]: On master: COMMIT
[0m23:52:24.253850 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:24.253850 [debug] [MainThread]: On master: COMMIT
[0m23:52:24.254849 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:52:24.254849 [debug] [MainThread]: On master: Close
[0m23:52:24.255853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:52:24.255853 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:52:24.255853 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:52:24.255853 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:52:24.255853 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:52:24.256852 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:52:24.256852 [info ] [MainThread]: 
[0m23:52:24.256852 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m23:52:24.256852 [debug] [MainThread]: Command end result
[0m23:52:24.261364 [info ] [MainThread]: 
[0m23:52:24.262869 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:52:24.262869 [info ] [MainThread]: 
[0m23:52:24.263874 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:52:24.263874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D010B3D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D00F17890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D00DCFD10>]}
[0m23:52:24.263874 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:52:42.184955 | a89bfc8a-407c-41be-b614-b1c0b53c0058 ==============================
[0m23:52:42.184955 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:52:42.185956 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:52:42.186954 [debug] [MainThread]: Tracking: tracking
[0m23:52:42.194471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021310CA4C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213109B4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021310CA4250>]}
[0m23:52:42.202979 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:52:42.237110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:52:42.237110 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m23:52:42.247620 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m23:52:42.264642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a89bfc8a-407c-41be-b614-b1c0b53c0058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021311153590>]}
[0m23:52:42.269156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a89bfc8a-407c-41be-b614-b1c0b53c0058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002131157B250>]}
[0m23:52:42.269156 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:52:42.269156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a89bfc8a-407c-41be-b614-b1c0b53c0058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021310A65050>]}
[0m23:52:42.270161 [info ] [MainThread]: 
[0m23:52:42.271160 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:52:42.273672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:52:42.282183 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:52:42.283182 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:52:42.283182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:42.423490 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:52:42.424490 [debug] [ThreadPool]: On list_projeto: Close
[0m23:52:42.426492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:52:42.431002 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:52:42.432003 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:52:42.432003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:42.460537 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:52:42.461537 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:52:42.461537 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:52:42.464536 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:52:42.465537 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:52:42.465537 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:52:42.470046 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:42.471045 [debug] [MainThread]: On master: BEGIN
[0m23:52:42.471045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:52:42.499880 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:52:42.500880 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:42.500880 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:52:42.504879 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:52:42.505880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a89bfc8a-407c-41be-b614-b1c0b53c0058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002131115FAD0>]}
[0m23:52:42.505880 [debug] [MainThread]: On master: ROLLBACK
[0m23:52:42.506880 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:42.506880 [debug] [MainThread]: On master: BEGIN
[0m23:52:42.506880 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:52:42.507879 [debug] [MainThread]: On master: COMMIT
[0m23:52:42.507879 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:42.507879 [debug] [MainThread]: On master: COMMIT
[0m23:52:42.507879 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:52:42.508880 [debug] [MainThread]: On master: Close
[0m23:52:42.509386 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:52:42.509386 [info ] [MainThread]: 
[0m23:52:42.513391 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:52:42.513391 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:52:42.513391 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:52:42.513391 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:52:42.514390 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:52:42.514390 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:52:42.515390 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:52:42.515390 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:52:42.516391 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:52:42.516391 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:52:42.516391 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:52:42.516391 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:52:42.518894 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:52:42.519899 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:52:42.521899 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:52:42.521899 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:52:42.517390 => 2023-03-30 23:52:42.521899
[0m23:52:42.522899 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:52:42.522899 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:52:42.518894 => 2023-03-30 23:52:42.522899
[0m23:52:42.522899 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:52:42.519899 => 2023-03-30 23:52:42.522899
[0m23:52:42.551568 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:52:42.552570 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:52:42.552570 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:52:42.555569 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:52:42.559071 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:52:42.559596 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:52:42.559596 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:52:42.560612 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:52:42.560612 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:52:42.560612 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:52:42.560612 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:52:42.560612 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:52:42.561611 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:52:42.561611 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:52:42.597201 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:52:42.597201 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:52:42.597201 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:52:42.597201 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:52:42.597201 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select
    avg(date(walmart.ship_date) - date(walmart.order_date)) as order_ship_delta,
	walmart.state
from walmart
where walmart.order_id is not null
group by walmart.state
order by order_ship_delta desc
  );
[0m23:52:42.598706 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select
	AVG(walmart.profit / walmart.sales) as margin,
	walmart.category
from walmart
group by category
order by margin desc
  );
[0m23:52:42.600717 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:52:42.600717 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:52:42.605712 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:52:42.607712 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:52:42.607712 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:52:42.608713 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2" rename to "view_2__dbt_backup"
[0m23:52:42.608713 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:52:42.608713 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:52:42.610898 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:52:42.612900 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:52:42.612900 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:52:42.612900 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m23:52:42.613900 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:52:42.613900 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:52:42.628913 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:52:42.630920 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:52:42.630920 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:52:42.630920 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:52:42.631928 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:52:42.631928 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:52:42.632938 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:52:42.632938 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m23:52:42.636454 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:52:42.638961 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:52:42.638961 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:52:42.638961 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m23:52:42.639969 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m23:52:42.639969 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:52:42.640966 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:52:42.556568 => 2023-03-30 23:52:42.640966
[0m23:52:42.641967 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:52:42.552570 => 2023-03-30 23:52:42.641967
[0m23:52:42.641967 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:52:42.642968 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:52:42.642968 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89bfc8a-407c-41be-b614-b1c0b53c0058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002131152D110>]}
[0m23:52:42.643970 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89bfc8a-407c-41be-b614-b1c0b53c0058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021310C89A90>]}
[0m23:52:42.643970 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:52:42.644968 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:52:42.645967 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:52:42.646967 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:52:42.702621 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:52:42.702621 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:52:42.703621 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:52:42.704619 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:52:42.706619 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:52:42.707619 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:52:42.707619 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:52:42.710138 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:52:42.710138 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:52:42.710138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:52:42.712135 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:52:42.712135 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:52:42.712135 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:52:42.713138 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:52:42.716135 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:52:42.716135 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:52:42.717139 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:52:42.718139 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:52:42.522899 => 2023-03-30 23:52:42.718139
[0m23:52:42.719138 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:52:42.719651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89bfc8a-407c-41be-b614-b1c0b53c0058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002131162BFD0>]}
[0m23:52:42.719651 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.20s]
[0m23:52:42.720660 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:52:42.721657 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:52:42.721657 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:42.721657 [debug] [MainThread]: On master: BEGIN
[0m23:52:42.722656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:52:42.752189 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:52:42.752189 [debug] [MainThread]: On master: COMMIT
[0m23:52:42.752189 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:42.753190 [debug] [MainThread]: On master: COMMIT
[0m23:52:42.753190 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:52:42.753190 [debug] [MainThread]: On master: Close
[0m23:52:42.754189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:52:42.754189 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:52:42.754189 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:52:42.754189 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:52:42.755189 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:52:42.755189 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:52:42.755189 [info ] [MainThread]: 
[0m23:52:42.755189 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m23:52:42.756189 [debug] [MainThread]: Command end result
[0m23:52:42.760702 [info ] [MainThread]: 
[0m23:52:42.760702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:52:42.761700 [info ] [MainThread]: 
[0m23:52:42.761700 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:52:42.762700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021311254AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021311125450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021310D035D0>]}
[0m23:52:42.762700 [debug] [MainThread]: Flushing usage events


============================== 2023-03-30 23:53:23.207320 | a6a21b64-a05d-405c-af24-1f3bf9e8b187 ==============================
[0m23:53:23.207320 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:53:23.208321 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:53:23.209827 [debug] [MainThread]: Tracking: tracking
[0m23:53:23.217832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134DAD62210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134DAD61490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134DACF0C50>]}
[0m23:53:23.225353 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:53:23.261447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:53:23.261447 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m23:53:23.272968 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m23:53:23.290504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6a21b64-a05d-405c-af24-1f3bf9e8b187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134DB489190>]}
[0m23:53:23.294523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6a21b64-a05d-405c-af24-1f3bf9e8b187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134DB80D890>]}
[0m23:53:23.295519 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m23:53:23.295519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6a21b64-a05d-405c-af24-1f3bf9e8b187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134DB544910>]}
[0m23:53:23.296519 [info ] [MainThread]: 
[0m23:53:23.298519 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:53:23.300024 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:53:23.308030 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:53:23.308030 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:53:23.309030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:23.340610 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:53:23.342615 [debug] [ThreadPool]: On list_projeto: Close
[0m23:53:23.343617 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:53:23.348615 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:53:23.348615 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:53:23.348615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:23.377153 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:53:23.378152 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:53:23.378152 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:53:23.380657 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:53:23.381669 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:53:23.381669 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:53:23.387176 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:23.387176 [debug] [MainThread]: On master: BEGIN
[0m23:53:23.387176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:53:23.415713 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:53:23.416712 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:23.416712 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:53:23.420219 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m23:53:23.421227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6a21b64-a05d-405c-af24-1f3bf9e8b187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134DACDF7D0>]}
[0m23:53:23.422228 [debug] [MainThread]: On master: ROLLBACK
[0m23:53:23.422228 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:23.422228 [debug] [MainThread]: On master: BEGIN
[0m23:53:23.423226 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:53:23.423226 [debug] [MainThread]: On master: COMMIT
[0m23:53:23.423226 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:23.423226 [debug] [MainThread]: On master: COMMIT
[0m23:53:23.424227 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:53:23.424227 [debug] [MainThread]: On master: Close
[0m23:53:23.424227 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:53:23.425227 [info ] [MainThread]: 
[0m23:53:23.429226 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m23:53:23.429226 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m23:53:23.429226 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m23:53:23.429226 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m23:53:23.430227 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m23:53:23.430734 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m23:53:23.430734 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m23:53:23.431744 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:53:23.431744 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:53:23.431744 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m23:53:23.432744 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m23:53:23.432744 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m23:53:23.434739 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m23:53:23.435745 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:53:23.437739 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:53:23.437739 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-30 23:53:23.432744 => 2023-03-30 23:53:23.437739
[0m23:53:23.438743 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m23:53:23.438743 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-30 23:53:23.434739 => 2023-03-30 23:53:23.438743
[0m23:53:23.438743 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-30 23:53:23.435745 => 2023-03-30 23:53:23.438743
[0m23:53:23.468278 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m23:53:23.467274 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m23:53:23.467274 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m23:53:23.470788 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:53:23.473792 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:53:23.474476 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:53:23.475492 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:53:23.475492 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m23:53:23.475492 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m23:53:23.475492 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:53:23.475492 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:53:23.476491 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:53:23.476491 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m23:53:23.476491 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:53:23.510057 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:53:23.510057 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:53:23.510057 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m23:53:23.511064 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m23:53:23.511064 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:53:23.511064 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select
    avg(date(walmart.ship_date) - date(walmart.order_date)) as order_ship_delta,
	walmart.state
from walmart
where walmart.order_id is not null
group by walmart.state
order by order_ship_delta asc
  );
[0m23:53:23.512066 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:53:23.512066 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:53:23.512066 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:53:23.513064 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select
	AVG(walmart.profit / walmart.sales) as margin,
	walmart.category
from walmart
group by category
order by margin desc
  );
[0m23:53:23.513064 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:53:23.518064 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:53:23.520064 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:53:23.520064 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:53:23.520064 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m23:53:23.520064 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2" rename to "view_2__dbt_backup"
[0m23:53:23.522510 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:53:23.522510 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:53:23.522510 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:53:23.523514 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:53:23.524513 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:53:23.525512 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:53:23.527512 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:53:23.527512 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m23:53:23.528512 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:53:23.530015 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m23:53:23.530015 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:53:23.530015 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:53:23.531022 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:53:23.531022 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:53:23.545533 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:53:23.547533 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:53:23.548534 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:53:23.548534 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:53:23.548534 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:53:23.550039 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:53:23.550039 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m23:53:23.550039 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m23:53:23.550039 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m23:53:23.551045 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:53:23.552047 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:53:23.552047 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m23:53:23.556046 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m23:53:23.557046 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:53:23.560045 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:53:23.560045 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m23:53:23.560045 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:53:23.561338 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m23:53:23.562342 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:53:23.562342 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:53:23.562342 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m23:53:23.563338 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-30 23:53:23.470788 => 2023-03-30 23:53:23.563338
[0m23:53:23.564338 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-30 23:53:23.438743 => 2023-03-30 23:53:23.564338
[0m23:53:23.565339 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-30 23:53:23.468278 => 2023-03-30 23:53:23.565339
[0m23:53:23.565339 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m23:53:23.565339 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m23:53:23.566339 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m23:53:23.566339 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a21b64-a05d-405c-af24-1f3bf9e8b187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134DB919190>]}
[0m23:53:23.567338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a21b64-a05d-405c-af24-1f3bf9e8b187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134DACC1B90>]}
[0m23:53:23.567338 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a21b64-a05d-405c-af24-1f3bf9e8b187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134DB8FD850>]}
[0m23:53:23.568338 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:53:23.568338 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.14s]
[0m23:53:23.568338 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.14s]
[0m23:53:23.570852 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m23:53:23.570852 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m23:53:23.570852 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m23:53:23.572859 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:53:23.572859 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:23.572859 [debug] [MainThread]: On master: BEGIN
[0m23:53:23.572859 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:53:23.602441 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:53:23.603442 [debug] [MainThread]: On master: COMMIT
[0m23:53:23.603442 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:23.603442 [debug] [MainThread]: On master: COMMIT
[0m23:53:23.603442 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:53:23.604441 [debug] [MainThread]: On master: Close
[0m23:53:23.604441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:53:23.604441 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:53:23.605441 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:53:23.605441 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m23:53:23.605441 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:53:23.605441 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:53:23.605441 [info ] [MainThread]: 
[0m23:53:23.606441 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m23:53:23.606441 [debug] [MainThread]: Command end result
[0m23:53:23.610949 [info ] [MainThread]: 
[0m23:53:23.610949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:53:23.611950 [info ] [MainThread]: 
[0m23:53:23.611950 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:53:23.612949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134DAD8E7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134DB396190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134DACC1810>]}
[0m23:53:23.612949 [debug] [MainThread]: Flushing usage events


============================== 2023-03-31 01:09:18.813044 | b01a8477-8694-48db-ab12-9607234795c2 ==============================
[0m01:09:18.813044 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:09:18.814050 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:09:18.815050 [debug] [MainThread]: Tracking: tracking
[0m01:09:18.823049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04781A0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A047392D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A047051590>]}
[0m01:09:18.830559 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:09:18.865613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:09:18.866612 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_1.sql
[0m01:09:18.866612 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m01:09:18.877120 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m01:09:18.887630 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m01:09:18.896142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b01a8477-8694-48db-ab12-9607234795c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A047B9F850>]}
[0m01:09:18.900645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b01a8477-8694-48db-ab12-9607234795c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A047B4F910>]}
[0m01:09:18.900645 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:09:18.901649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b01a8477-8694-48db-ab12-9607234795c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0473F3150>]}
[0m01:09:18.901649 [info ] [MainThread]: 
[0m01:09:18.904157 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:09:18.905157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m01:09:18.913157 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m01:09:18.913157 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m01:09:18.914179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:18.945710 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:09:18.946709 [debug] [ThreadPool]: On list_projeto: Close
[0m01:09:18.948710 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m01:09:18.953794 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m01:09:18.953794 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m01:09:18.953794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:18.983317 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:09:18.983317 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m01:09:18.983317 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:09:18.986321 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:09:18.987321 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m01:09:18.987321 [debug] [ThreadPool]: On list_projeto_public: Close
[0m01:09:18.991321 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:18.992824 [debug] [MainThread]: On master: BEGIN
[0m01:09:18.992824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:09:19.022858 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:09:19.022858 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:19.022858 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:09:19.026862 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m01:09:19.028863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b01a8477-8694-48db-ab12-9607234795c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0478CBF90>]}
[0m01:09:19.028863 [debug] [MainThread]: On master: ROLLBACK
[0m01:09:19.028863 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:19.028863 [debug] [MainThread]: On master: BEGIN
[0m01:09:19.029864 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:09:19.029864 [debug] [MainThread]: On master: COMMIT
[0m01:09:19.029864 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:19.030863 [debug] [MainThread]: On master: COMMIT
[0m01:09:19.030863 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:09:19.030863 [debug] [MainThread]: On master: Close
[0m01:09:19.031864 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:09:19.031864 [info ] [MainThread]: 
[0m01:09:19.035210 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m01:09:19.035210 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m01:09:19.036210 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m01:09:19.036210 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m01:09:19.036210 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m01:09:19.037214 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m01:09:19.037214 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m01:09:19.038212 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m01:09:19.038212 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m01:09:19.038212 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m01:09:19.039210 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m01:09:19.039210 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m01:09:19.041210 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m01:09:19.041210 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m01:09:19.043719 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m01:09:19.044721 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-31 01:09:19.039210 => 2023-03-31 01:09:19.044721
[0m01:09:19.044721 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-31 01:09:19.041210 => 2023-03-31 01:09:19.044721
[0m01:09:19.044721 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m01:09:19.044721 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m01:09:19.044721 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-31 01:09:19.042714 => 2023-03-31 01:09:19.044721
[0m01:09:19.076252 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m01:09:19.079253 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m01:09:19.080253 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m01:09:19.080253 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:09:19.083762 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m01:09:19.083762 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m01:09:19.083762 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m01:09:19.084762 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:09:19.084762 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m01:09:19.084762 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m01:09:19.085762 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:09:19.085762 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m01:09:19.085762 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:09:19.118268 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:09:19.118268 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:09:19.118268 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m01:09:19.118268 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:09:19.119271 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m01:09:19.119271 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select
	avg(walmart.profit / walmart.sales) as margin,
	walmart.category
from walmart
group by category
order by margin desc
  );
[0m01:09:19.120268 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:09:19.125777 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:09:19.125777 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:09:19.126780 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m01:09:19.128777 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m01:09:19.128777 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:09:19.128777 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m01:09:19.128777 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:09:19.129776 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m01:09:19.131777 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:09:19.131777 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:09:19.131777 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select
    avg(date(walmart.ship_date) - date(walmart.order_date)) as order_ship_delta,
	walmart.state
from walmart
where walmart.order_ship_delta is not null
group by walmart.state
order by order_ship_delta asc
  );
[0m01:09:19.132777 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m01:09:19.134289 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m01:09:19.134289 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m01:09:19.135292 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:09:19.135292 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column walmart.order_ship_delta does not exist
LINE 8: where walmart.order_ship_delta is not null
              ^

[0m01:09:19.135292 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:09:19.149803 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m01:09:19.150801 [debug] [Thread-3 (]: On model.projeto_final.view_2: ROLLBACK
[0m01:09:19.151803 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m01:09:19.151803 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:09:19.152803 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m01:09:19.152803 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-31 01:09:19.080253 => 2023-03-31 01:09:19.152803
[0m01:09:19.152803 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m01:09:19.152803 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m01:09:19.154040 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m01:09:19.155042 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:09:19.155042 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m01:09:19.160039 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:09:19.161039 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m01:09:19.162041 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m01:09:19.162041 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m01:09:19.163546 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m01:09:19.163546 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m01:09:19.164551 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-31 01:09:19.045719 => 2023-03-31 01:09:19.164551
[0m01:09:19.165551 [debug] [Thread-3 (]: Database Error in model view_2 (models\view_2.sql)
  column walmart.order_ship_delta does not exist
  LINE 8: where walmart.order_ship_delta is not null
                ^
  compiled Code at target\run\projeto_final\models\view_2.sql
[0m01:09:19.166551 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-31 01:09:19.076252 => 2023-03-31 01:09:19.166551
[0m01:09:19.166551 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m01:09:19.167551 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b01a8477-8694-48db-ab12-9607234795c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A047C0FC50>]}
[0m01:09:19.167551 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m01:09:19.167551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b01a8477-8694-48db-ab12-9607234795c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A047C2F990>]}
[0m01:09:19.168551 [error] [Thread-3 (]: 3 of 3 ERROR creating sql view model public.view_2 ............................. [[31mERROR[0m in 0.13s]
[0m01:09:19.168551 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b01a8477-8694-48db-ab12-9607234795c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A047C2EB90>]}
[0m01:09:19.169551 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m01:09:19.170551 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m01:09:19.195252 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m01:09:19.194247 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m01:09:19.196251 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m01:09:19.197253 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:09:19.198252 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:19.198252 [debug] [MainThread]: On master: BEGIN
[0m01:09:19.198252 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:09:19.333122 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:09:19.333122 [debug] [MainThread]: On master: COMMIT
[0m01:09:19.334173 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:19.334173 [debug] [MainThread]: On master: COMMIT
[0m01:09:19.334173 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:09:19.334173 [debug] [MainThread]: On master: Close
[0m01:09:19.335172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:09:19.335172 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m01:09:19.335172 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m01:09:19.335172 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m01:09:19.336176 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m01:09:19.336176 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m01:09:19.336176 [info ] [MainThread]: 
[0m01:09:19.336176 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m01:09:19.337175 [debug] [MainThread]: Command end result
[0m01:09:19.342172 [info ] [MainThread]: 
[0m01:09:19.343179 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:09:19.343179 [info ] [MainThread]: 
[0m01:09:19.343179 [error] [MainThread]: [33mDatabase Error in model view_2 (models\view_2.sql)[0m
[0m01:09:19.344625 [error] [MainThread]:   column walmart.order_ship_delta does not exist
[0m01:09:19.344625 [error] [MainThread]:   LINE 8: where walmart.order_ship_delta is not null
[0m01:09:19.344625 [error] [MainThread]:                 ^
[0m01:09:19.345628 [error] [MainThread]:   compiled Code at target\run\projeto_final\models\view_2.sql
[0m01:09:19.345628 [info ] [MainThread]: 
[0m01:09:19.345628 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m01:09:19.346626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04711E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A04704E750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A044B1AD10>]}
[0m01:09:19.346626 [debug] [MainThread]: Flushing usage events


============================== 2023-03-31 01:09:41.650565 | 427522b8-614c-407b-98a4-338cefc96f7f ==============================
[0m01:09:41.650565 [info ] [MainThread]: Running with dbt=1.4.5
[0m01:09:41.652565 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:09:41.652565 [debug] [MainThread]: Tracking: tracking
[0m01:09:41.661076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81FE62ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8205FFE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81FE4B850>]}
[0m01:09:41.668587 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m01:09:41.703629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:09:41.704637 [debug] [MainThread]: Partial parsing: updated file: projeto_final://models\view_2.sql
[0m01:09:41.715664 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m01:09:41.732185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '427522b8-614c-407b-98a4-338cefc96f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F82010B350>]}
[0m01:09:41.737704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '427522b8-614c-407b-98a4-338cefc96f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8206BF650>]}
[0m01:09:41.737704 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m01:09:41.738703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '427522b8-614c-407b-98a4-338cefc96f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8205D1B50>]}
[0m01:09:41.739705 [info ] [MainThread]: 
[0m01:09:41.741704 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:09:41.742704 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m01:09:41.751213 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m01:09:41.752217 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m01:09:41.752217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:41.788046 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:09:41.789043 [debug] [ThreadPool]: On list_projeto: Close
[0m01:09:41.790044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m01:09:41.794555 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m01:09:41.794555 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m01:09:41.795553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:41.824606 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m01:09:41.824606 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m01:09:41.824606 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m01:09:41.827605 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m01:09:41.828605 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m01:09:41.828605 [debug] [ThreadPool]: On list_projeto_public: Close
[0m01:09:41.834109 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:41.834109 [debug] [MainThread]: On master: BEGIN
[0m01:09:41.834109 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:09:41.863689 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:09:41.863689 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:41.864786 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:09:41.867786 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m01:09:41.869786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '427522b8-614c-407b-98a4-338cefc96f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81FE493D0>]}
[0m01:09:41.869786 [debug] [MainThread]: On master: ROLLBACK
[0m01:09:41.869786 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:41.870788 [debug] [MainThread]: On master: BEGIN
[0m01:09:41.870788 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:09:41.870788 [debug] [MainThread]: On master: COMMIT
[0m01:09:41.871788 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:41.871788 [debug] [MainThread]: On master: COMMIT
[0m01:09:41.871788 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:09:41.871788 [debug] [MainThread]: On master: Close
[0m01:09:41.871788 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:09:41.873294 [info ] [MainThread]: 
[0m01:09:41.876305 [debug] [Thread-1 (]: Began running node model.projeto_final.stg_walmart
[0m01:09:41.876305 [debug] [Thread-2 (]: Began running node model.projeto_final.view_1
[0m01:09:41.877309 [debug] [Thread-3 (]: Began running node model.projeto_final.view_2
[0m01:09:41.877309 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_walmart ................................. [RUN]
[0m01:09:41.877309 [info ] [Thread-2 (]: 2 of 3 START sql view model public.view_1 ...................................... [RUN]
[0m01:09:41.878309 [info ] [Thread-3 (]: 3 of 3 START sql view model public.view_2 ...................................... [RUN]
[0m01:09:41.878309 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.stg_walmart'
[0m01:09:41.879308 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m01:09:41.879308 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m01:09:41.879308 [debug] [Thread-1 (]: Began compiling node model.projeto_final.stg_walmart
[0m01:09:41.880308 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_1
[0m01:09:41.880308 [debug] [Thread-3 (]: Began compiling node model.projeto_final.view_2
[0m01:09:41.882310 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.stg_walmart"
[0m01:09:41.883814 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m01:09:41.884823 [debug] [Thread-3 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m01:09:41.885820 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (compile): 2023-03-31 01:09:41.880308 => 2023-03-31 01:09:41.885820
[0m01:09:41.885820 [debug] [Thread-1 (]: Began executing node model.projeto_final.stg_walmart
[0m01:09:41.885820 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-31 01:09:41.882310 => 2023-03-31 01:09:41.885820
[0m01:09:41.909396 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-31 01:09:41.883814 => 2023-03-31 01:09:41.909396
[0m01:09:41.915408 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.stg_walmart"
[0m01:09:41.916407 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_1
[0m01:09:41.916407 [debug] [Thread-3 (]: Began executing node model.projeto_final.view_2
[0m01:09:41.919411 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m01:09:41.923407 [debug] [Thread-3 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m01:09:41.923407 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:09:41.923919 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m01:09:41.923919 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: BEGIN
[0m01:09:41.924928 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m01:09:41.924928 [debug] [Thread-2 (]: On model.projeto_final.view_1: BEGIN
[0m01:09:41.924928 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:09:41.924928 [debug] [Thread-3 (]: On model.projeto_final.view_2: BEGIN
[0m01:09:41.924928 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:09:41.925926 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:09:41.959465 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m01:09:41.959465 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m01:09:41.959465 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select
	avg(walmart.profit / walmart.sales) as margin,
	walmart.category
from walmart
group by category
order by margin desc
  );
[0m01:09:41.960465 [debug] [Thread-3 (]: SQL status: BEGIN in 0 seconds
[0m01:09:41.961466 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m01:09:41.961466 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select
    avg(date(walmart.ship_date) - date(walmart.order_date)) as order_ship_delta,
	walmart.state
from walmart
group by walmart.state
order by order_ship_delta asc
  );
[0m01:09:41.961466 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:09:41.966979 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m01:09:41.966979 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:09:41.966979 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m01:09:41.968985 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m01:09:41.969990 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2" rename to "view_2__dbt_backup"
[0m01:09:41.969990 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:09:41.971984 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m01:09:41.971984 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:09:41.971984 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m01:09:41.974498 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m01:09:41.974498 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m01:09:41.974498 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:09:41.986019 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:09:41.990014 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m01:09:41.991020 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m01:09:41.992019 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m01:09:41.992019 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m01:09:41.992019 [debug] [Thread-2 (]: On model.projeto_final.view_1: COMMIT
[0m01:09:41.992019 [debug] [Thread-3 (]: On model.projeto_final.view_2: COMMIT
[0m01:09:41.993671 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m01:09:41.993671 [debug] [Thread-3 (]: SQL status: COMMIT in 0 seconds
[0m01:09:41.997699 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_1"
[0m01:09:41.998699 [debug] [Thread-3 (]: Using postgres connection "model.projeto_final.view_2"
[0m01:09:41.998699 [debug] [Thread-2 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m01:09:41.999699 [debug] [Thread-3 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m01:09:42.000699 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m01:09:42.000699 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0 seconds
[0m01:09:42.001687 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-31 01:09:41.917411 => 2023-03-31 01:09:42.001687
[0m01:09:42.002692 [debug] [Thread-3 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-31 01:09:41.920411 => 2023-03-31 01:09:42.002692
[0m01:09:42.002692 [debug] [Thread-2 (]: On model.projeto_final.view_1: Close
[0m01:09:42.002692 [debug] [Thread-3 (]: On model.projeto_final.view_2: Close
[0m01:09:42.003689 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '427522b8-614c-407b-98a4-338cefc96f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F82093D0D0>]}
[0m01:09:42.003689 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '427522b8-614c-407b-98a4-338cefc96f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F820958E90>]}
[0m01:09:42.005156 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.12s]
[0m01:09:42.005156 [info ] [Thread-3 (]: 3 of 3 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.12s]
[0m01:09:42.007151 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_1
[0m01:09:42.007151 [debug] [Thread-3 (]: Finished running node model.projeto_final.view_2
[0m01:09:42.070549 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m01:09:42.070549 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:09:42.071539 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */

  create view "projeto"."public"."stg_walmart__dbt_tmp" as (
    select
  *

from "projeto"."public"."walmart"
  );
[0m01:09:42.072547 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m01:09:42.075056 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:09:42.075056 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart" rename to "stg_walmart__dbt_backup"
[0m01:09:42.076061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:09:42.077057 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:09:42.077057 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
alter table "projeto"."public"."stg_walmart__dbt_tmp" rename to "stg_walmart"
[0m01:09:42.078054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m01:09:42.079057 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m01:09:42.080056 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:09:42.080056 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: COMMIT
[0m01:09:42.080754 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m01:09:42.082764 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.stg_walmart"
[0m01:09:42.082764 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.stg_walmart"} */
drop view if exists "projeto"."public"."stg_walmart__dbt_backup" cascade
[0m01:09:42.084270 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m01:09:42.085276 [debug] [Thread-1 (]: Timing info for model.projeto_final.stg_walmart (execute): 2023-03-31 01:09:41.885820 => 2023-03-31 01:09:42.085276
[0m01:09:42.085276 [debug] [Thread-1 (]: On model.projeto_final.stg_walmart: Close
[0m01:09:42.086275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '427522b8-614c-407b-98a4-338cefc96f7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F820A2FD10>]}
[0m01:09:42.086275 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_walmart ............................ [[32mCREATE VIEW[0m in 0.21s]
[0m01:09:42.087276 [debug] [Thread-1 (]: Finished running node model.projeto_final.stg_walmart
[0m01:09:42.088275 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:09:42.088275 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:42.089278 [debug] [MainThread]: On master: BEGIN
[0m01:09:42.089278 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:09:42.118328 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m01:09:42.118328 [debug] [MainThread]: On master: COMMIT
[0m01:09:42.118328 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:42.119330 [debug] [MainThread]: On master: COMMIT
[0m01:09:42.119330 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m01:09:42.119330 [debug] [MainThread]: On master: Close
[0m01:09:42.120329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:09:42.120329 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m01:09:42.120329 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m01:09:42.120329 [debug] [MainThread]: Connection 'model.projeto_final.stg_walmart' was properly closed.
[0m01:09:42.121332 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m01:09:42.121332 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m01:09:42.121332 [info ] [MainThread]: 
[0m01:09:42.122328 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m01:09:42.122328 [debug] [MainThread]: Command end result
[0m01:09:42.126839 [info ] [MainThread]: 
[0m01:09:42.126839 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:09:42.127840 [info ] [MainThread]: 
[0m01:09:42.127840 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:09:42.127840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81FE34610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F820A6EAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F820A6EF50>]}
[0m01:09:42.128840 [debug] [MainThread]: Flushing usage events


============================== 2023-03-31 21:04:35.242020 | ec6a95b3-5ff6-4fc8-96dd-a72fb37f15c0 ==============================
[0m21:04:35.242020 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:04:35.245016 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m21:04:35.246021 [debug] [MainThread]: Tracking: tracking
[0m21:04:35.255026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC89B96750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC89DF3C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC89B84BD0>]}
[0m21:04:35.260022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8A349D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8A349D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8A32BA10>]}
[0m21:04:35.260022 [debug] [MainThread]: Flushing usage events


============================== 2023-03-31 21:04:41.956920 | 07dbb804-50c8-4015-b1c7-25d17e43b7c0 ==============================
[0m21:04:41.956920 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:04:41.958921 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:04:41.958921 [debug] [MainThread]: Tracking: tracking
[0m21:04:41.967919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4B3BFD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4BCF8A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4B718D90>]}
[0m21:04:41.975429 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:04:41.976429 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:04:41.976429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '07dbb804-50c8-4015-b1c7-25d17e43b7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4B4B1490>]}
[0m21:04:42.445909 [debug] [MainThread]: 1699: static parser successfully parsed view_1.sql
[0m21:04:42.455918 [debug] [MainThread]: 1699: static parser successfully parsed view_2.sql
[0m21:04:42.480456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07dbb804-50c8-4015-b1c7-25d17e43b7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4BCF3FD0>]}
[0m21:04:42.486455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07dbb804-50c8-4015-b1c7-25d17e43b7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4BF71E90>]}
[0m21:04:42.486455 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m21:04:42.487456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07dbb804-50c8-4015-b1c7-25d17e43b7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4B719190>]}
[0m21:04:42.488456 [info ] [MainThread]: 
[0m21:04:42.490457 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:04:42.491456 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m21:04:42.500457 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m21:04:42.500457 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m21:04:42.500457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:42.576086 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m21:04:42.578086 [debug] [ThreadPool]: On list_projeto: Close
[0m21:04:42.579088 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m21:04:42.584086 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m21:04:42.584086 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m21:04:42.585086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:42.615445 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m21:04:42.615445 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m21:04:42.616445 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:04:42.627587 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m21:04:42.628587 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m21:04:42.628587 [debug] [ThreadPool]: On list_projeto_public: Close
[0m21:04:42.633585 [debug] [MainThread]: Using postgres connection "master"
[0m21:04:42.634586 [debug] [MainThread]: On master: BEGIN
[0m21:04:42.634586 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:04:42.663590 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:04:42.664591 [debug] [MainThread]: Using postgres connection "master"
[0m21:04:42.664591 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:04:42.671536 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m21:04:42.673549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07dbb804-50c8-4015-b1c7-25d17e43b7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4B521150>]}
[0m21:04:42.673549 [debug] [MainThread]: On master: ROLLBACK
[0m21:04:42.673549 [debug] [MainThread]: Using postgres connection "master"
[0m21:04:42.674549 [debug] [MainThread]: On master: BEGIN
[0m21:04:42.674549 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:04:42.674549 [debug] [MainThread]: On master: COMMIT
[0m21:04:42.675548 [debug] [MainThread]: Using postgres connection "master"
[0m21:04:42.675548 [debug] [MainThread]: On master: COMMIT
[0m21:04:42.675548 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m21:04:42.675548 [debug] [MainThread]: On master: Close
[0m21:04:42.676549 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:04:42.676549 [info ] [MainThread]: 
[0m21:04:42.682548 [debug] [Thread-1 (]: Began running node model.projeto_final.view_1
[0m21:04:42.682548 [debug] [Thread-2 (]: Began running node model.projeto_final.view_2
[0m21:04:42.683551 [info ] [Thread-1 (]: 1 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m21:04:42.683551 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_2 ...................................... [RUN]
[0m21:04:42.684552 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m21:04:42.684552 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m21:04:42.684552 [debug] [Thread-1 (]: Began compiling node model.projeto_final.view_1
[0m21:04:42.685550 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_2
[0m21:04:42.686552 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m21:04:42.687548 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m21:04:42.688423 [debug] [Thread-1 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-31 21:04:42.685550 => 2023-03-31 21:04:42.688423
[0m21:04:42.688423 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-31 21:04:42.686552 => 2023-03-31 21:04:42.688423
[0m21:04:42.689435 [debug] [Thread-1 (]: Began executing node model.projeto_final.view_1
[0m21:04:42.689435 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_2
[0m21:04:42.718434 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m21:04:42.721435 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m21:04:42.723434 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m21:04:42.723434 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m21:04:42.723434 [debug] [Thread-1 (]: On model.projeto_final.view_1: BEGIN
[0m21:04:42.723434 [debug] [Thread-2 (]: On model.projeto_final.view_2: BEGIN
[0m21:04:42.724440 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:04:42.724440 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:04:42.760775 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:04:42.761771 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m21:04:42.761771 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m21:04:42.761771 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m21:04:42.761771 [debug] [Thread-1 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select
	avg(walmart.profit / walmart.sales) as margin,
	walmart.category
from walmart
group by category
order by margin desc
  );
[0m21:04:42.762770 [debug] [Thread-2 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select
    avg(date(walmart.ship_date) - date(walmart.order_date)) as order_ship_delta,
	walmart.state
from walmart
group by walmart.state
order by order_ship_delta asc
  );
[0m21:04:42.771279 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m21:04:42.771279 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m21:04:42.776290 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m21:04:42.779292 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m21:04:42.780292 [debug] [Thread-1 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m21:04:42.780292 [debug] [Thread-2 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2" rename to "view_2__dbt_backup"
[0m21:04:42.783291 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:04:42.783291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:04:42.785291 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m21:04:42.787286 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m21:04:42.787286 [debug] [Thread-2 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m21:04:42.788290 [debug] [Thread-1 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m21:04:42.788290 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:04:42.788290 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:04:42.804286 [debug] [Thread-2 (]: On model.projeto_final.view_2: COMMIT
[0m21:04:42.806286 [debug] [Thread-1 (]: On model.projeto_final.view_1: COMMIT
[0m21:04:42.806286 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m21:04:42.807288 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m21:04:42.807288 [debug] [Thread-2 (]: On model.projeto_final.view_2: COMMIT
[0m21:04:42.807288 [debug] [Thread-1 (]: On model.projeto_final.view_1: COMMIT
[0m21:04:42.808806 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m21:04:42.809818 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:04:42.812818 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m21:04:42.814822 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m21:04:42.814822 [debug] [Thread-2 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m21:04:42.815818 [debug] [Thread-1 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m21:04:42.817819 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m21:04:42.818818 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m21:04:42.819818 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-31 21:04:42.718434 => 2023-03-31 21:04:42.819818
[0m21:04:42.819818 [debug] [Thread-1 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-31 21:04:42.689435 => 2023-03-31 21:04:42.819818
[0m21:04:42.820823 [debug] [Thread-2 (]: On model.projeto_final.view_2: Close
[0m21:04:42.820823 [debug] [Thread-1 (]: On model.projeto_final.view_1: Close
[0m21:04:42.821819 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07dbb804-50c8-4015-b1c7-25d17e43b7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4C002910>]}
[0m21:04:42.821819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07dbb804-50c8-4015-b1c7-25d17e43b7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4BFCF0D0>]}
[0m21:04:42.821819 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.14s]
[0m21:04:42.822818 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.14s]
[0m21:04:42.823821 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_2
[0m21:04:42.824820 [debug] [Thread-1 (]: Finished running node model.projeto_final.view_1
[0m21:04:42.825818 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:04:42.825818 [debug] [MainThread]: Using postgres connection "master"
[0m21:04:42.826817 [debug] [MainThread]: On master: BEGIN
[0m21:04:42.826817 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:04:42.856826 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:04:42.856826 [debug] [MainThread]: On master: COMMIT
[0m21:04:42.856826 [debug] [MainThread]: Using postgres connection "master"
[0m21:04:42.857833 [debug] [MainThread]: On master: COMMIT
[0m21:04:42.857833 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m21:04:42.857833 [debug] [MainThread]: On master: Close
[0m21:04:42.858825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:42.858825 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m21:04:42.858825 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m21:04:42.858825 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m21:04:42.858825 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m21:04:42.859826 [info ] [MainThread]: 
[0m21:04:42.859826 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m21:04:42.860826 [debug] [MainThread]: Command end result
[0m21:04:42.864825 [info ] [MainThread]: 
[0m21:04:42.865826 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:04:42.865826 [info ] [MainThread]: 
[0m21:04:42.865826 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:04:42.866825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4C062450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4C061F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA4C062150>]}
[0m21:04:42.866825 [debug] [MainThread]: Flushing usage events


============================== 2023-03-31 21:06:41.926022 | 66f4f40f-4c68-48c4-87cd-bcef3d2a5cb7 ==============================
[0m21:06:41.926022 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:06:41.928024 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:06:41.928024 [debug] [MainThread]: Tracking: tracking
[0m21:06:41.937103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903CD8E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903CD11D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903CD87190>]}
[0m21:06:41.944106 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:06:41.979823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:06:41.979823 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:06:41.984824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66f4f40f-4c68-48c4-87cd-bcef3d2a5cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903D7EC650>]}
[0m21:06:41.989824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66f4f40f-4c68-48c4-87cd-bcef3d2a5cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903D594B90>]}
[0m21:06:41.989824 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m21:06:41.990823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66f4f40f-4c68-48c4-87cd-bcef3d2a5cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903D594110>]}
[0m21:06:41.991822 [info ] [MainThread]: 
[0m21:06:41.992823 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:06:41.993824 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m21:06:42.002824 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m21:06:42.003825 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m21:06:42.003825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:42.035823 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m21:06:42.036823 [debug] [ThreadPool]: On list_projeto: Close
[0m21:06:42.038824 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m21:06:42.043837 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m21:06:42.043837 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m21:06:42.043837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:42.072955 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m21:06:42.072955 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m21:06:42.072955 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:06:42.075984 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m21:06:42.076984 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m21:06:42.076984 [debug] [ThreadPool]: On list_projeto_public: Close
[0m21:06:42.081970 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:42.081970 [debug] [MainThread]: On master: BEGIN
[0m21:06:42.082970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:06:42.110970 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:06:42.111970 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:42.111970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:06:42.114970 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m21:06:42.116970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66f4f40f-4c68-48c4-87cd-bcef3d2a5cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903CF6E5D0>]}
[0m21:06:42.116970 [debug] [MainThread]: On master: ROLLBACK
[0m21:06:42.117973 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:42.117973 [debug] [MainThread]: On master: BEGIN
[0m21:06:42.117973 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:06:42.117973 [debug] [MainThread]: On master: COMMIT
[0m21:06:42.118977 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:42.118977 [debug] [MainThread]: On master: COMMIT
[0m21:06:42.118977 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m21:06:42.119974 [debug] [MainThread]: On master: Close
[0m21:06:42.119974 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:06:42.120970 [info ] [MainThread]: 
[0m21:06:42.123971 [debug] [Thread-1 (]: Began running node model.projeto_final.view_1
[0m21:06:42.123971 [debug] [Thread-2 (]: Began running node model.projeto_final.view_2
[0m21:06:42.124970 [info ] [Thread-1 (]: 1 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m21:06:42.124970 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_2 ...................................... [RUN]
[0m21:06:42.125971 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m21:06:42.125971 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m21:06:42.125971 [debug] [Thread-1 (]: Began compiling node model.projeto_final.view_1
[0m21:06:42.126974 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_2
[0m21:06:42.127970 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m21:06:42.128971 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m21:06:42.128971 [debug] [Thread-1 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-31 21:06:42.126974 => 2023-03-31 21:06:42.128971
[0m21:06:42.129970 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-31 21:06:42.127970 => 2023-03-31 21:06:42.129970
[0m21:06:42.129970 [debug] [Thread-1 (]: Began executing node model.projeto_final.view_1
[0m21:06:42.129970 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_2
[0m21:06:42.158483 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m21:06:42.161490 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m21:06:42.162483 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m21:06:42.162483 [debug] [Thread-1 (]: On model.projeto_final.view_1: BEGIN
[0m21:06:42.162483 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m21:06:42.163483 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:06:42.163483 [debug] [Thread-2 (]: On model.projeto_final.view_2: BEGIN
[0m21:06:42.163483 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:06:42.193503 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:06:42.193503 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m21:06:42.194520 [debug] [Thread-1 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select
	avg(walmart.profit / walmart.sales) as margin,
	walmart.category
from walmart
group by category
order by margin desc
  );
[0m21:06:42.195517 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m21:06:42.200517 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m21:06:42.201517 [debug] [Thread-1 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m21:06:42.201517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:06:42.203517 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m21:06:42.203517 [debug] [Thread-1 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m21:06:42.204519 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:06:42.218516 [debug] [Thread-1 (]: On model.projeto_final.view_1: COMMIT
[0m21:06:42.218516 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m21:06:42.218516 [debug] [Thread-1 (]: On model.projeto_final.view_1: COMMIT
[0m21:06:42.219516 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:06:42.223515 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m21:06:42.223515 [debug] [Thread-1 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m21:06:42.224519 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m21:06:42.225517 [debug] [Thread-1 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-31 21:06:42.129970 => 2023-03-31 21:06:42.225517
[0m21:06:42.226516 [debug] [Thread-1 (]: On model.projeto_final.view_1: Close
[0m21:06:42.226516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66f4f40f-4c68-48c4-87cd-bcef3d2a5cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903D569C50>]}
[0m21:06:42.227521 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.10s]
[0m21:06:42.228518 [debug] [Thread-1 (]: Finished running node model.projeto_final.view_1
[0m21:06:42.306966 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m21:06:42.306966 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m21:06:42.306966 [debug] [Thread-2 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select
    avg(date(walmart.ship_date) - date(walmart.order_date)) as order_ship_delta,
	walmart.state
from walmart
group by walmart.state
order by order_ship_delta asc
  );
[0m21:06:42.308992 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m21:06:42.311982 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m21:06:42.312982 [debug] [Thread-2 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2" rename to "view_2__dbt_backup"
[0m21:06:42.313986 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:06:42.314978 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m21:06:42.314978 [debug] [Thread-2 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m21:06:42.315980 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:06:42.316979 [debug] [Thread-2 (]: On model.projeto_final.view_2: COMMIT
[0m21:06:42.316979 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m21:06:42.317978 [debug] [Thread-2 (]: On model.projeto_final.view_2: COMMIT
[0m21:06:42.317978 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m21:06:42.319982 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m21:06:42.319982 [debug] [Thread-2 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m21:06:42.320982 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m21:06:42.321984 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-31 21:06:42.158483 => 2023-03-31 21:06:42.321984
[0m21:06:42.321984 [debug] [Thread-2 (]: On model.projeto_final.view_2: Close
[0m21:06:42.322983 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66f4f40f-4c68-48c4-87cd-bcef3d2a5cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903D48F910>]}
[0m21:06:42.322983 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.20s]
[0m21:06:42.323979 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_2
[0m21:06:42.324979 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:06:42.324979 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:42.325980 [debug] [MainThread]: On master: BEGIN
[0m21:06:42.325980 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:06:42.354974 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:06:42.354974 [debug] [MainThread]: On master: COMMIT
[0m21:06:42.354974 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:42.354974 [debug] [MainThread]: On master: COMMIT
[0m21:06:42.356488 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m21:06:42.356488 [debug] [MainThread]: On master: Close
[0m21:06:42.356488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:42.357496 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m21:06:42.357496 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m21:06:42.357496 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m21:06:42.357496 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m21:06:42.357496 [info ] [MainThread]: 
[0m21:06:42.358496 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m21:06:42.358496 [debug] [MainThread]: Command end result
[0m21:06:42.363498 [info ] [MainThread]: 
[0m21:06:42.364495 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:06:42.364495 [info ] [MainThread]: 
[0m21:06:42.364495 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:06:42.365494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903D07B510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903A7BAD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002903D4B8050>]}
[0m21:06:42.365494 [debug] [MainThread]: Flushing usage events


============================== 2023-03-31 23:47:03.677622 | ba92b959-940e-4a3b-a594-8e9b6fc1e6dd ==============================
[0m23:47:03.677622 [info ] [MainThread]: Running with dbt=1.4.5
[0m23:47:03.680761 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\hiago\\projeto_final', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m23:47:03.680761 [debug] [MainThread]: Tracking: tracking
[0m23:47:03.688605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2A492990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2AC5AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2A5CB950>]}
[0m23:47:03.698112 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m23:47:03.749028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:47:03.749028 [debug] [MainThread]: Partial parsing: added file: projeto_final://seeds\walmart.csv
[0m23:47:03.776362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba92b959-940e-4a3b-a594-8e9b6fc1e6dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2AD14490>]}
[0m23:47:03.780871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba92b959-940e-4a3b-a594-8e9b6fc1e6dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2B004590>]}
[0m23:47:03.780871 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m23:47:03.781877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba92b959-940e-4a3b-a594-8e9b6fc1e6dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2A6A2790>]}
[0m23:47:03.782876 [info ] [MainThread]: 
[0m23:47:03.784876 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:47:03.785683 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto'
[0m23:47:03.794204 [debug] [ThreadPool]: Using postgres connection "list_projeto"
[0m23:47:03.795203 [debug] [ThreadPool]: On list_projeto: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto"} */

    select distinct nspname from pg_namespace
  
[0m23:47:03.795203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:03.943109 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m23:47:03.944112 [debug] [ThreadPool]: On list_projeto: Close
[0m23:47:03.946111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_projeto_public'
[0m23:47:03.950615 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:47:03.950615 [debug] [ThreadPool]: On list_projeto_public: BEGIN
[0m23:47:03.950615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:03.980599 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m23:47:03.980599 [debug] [ThreadPool]: Using postgres connection "list_projeto_public"
[0m23:47:03.980599 [debug] [ThreadPool]: On list_projeto_public: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "list_projeto_public"} */
select
      'projeto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'projeto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:47:03.983888 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m23:47:03.984900 [debug] [ThreadPool]: On list_projeto_public: ROLLBACK
[0m23:47:03.985901 [debug] [ThreadPool]: On list_projeto_public: Close
[0m23:47:03.990899 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:03.990899 [debug] [MainThread]: On master: BEGIN
[0m23:47:03.990899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:47:04.022229 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:47:04.022229 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:04.022229 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:47:04.027623 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m23:47:04.028621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba92b959-940e-4a3b-a594-8e9b6fc1e6dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2A4B6B10>]}
[0m23:47:04.028621 [debug] [MainThread]: On master: ROLLBACK
[0m23:47:04.029624 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:04.029624 [debug] [MainThread]: On master: BEGIN
[0m23:47:04.029624 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:47:04.030624 [debug] [MainThread]: On master: COMMIT
[0m23:47:04.030624 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:04.031131 [debug] [MainThread]: On master: COMMIT
[0m23:47:04.031131 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:47:04.031131 [debug] [MainThread]: On master: Close
[0m23:47:04.032138 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:47:04.032138 [info ] [MainThread]: 
[0m23:47:04.038145 [debug] [Thread-1 (]: Began running node model.projeto_final.view_1
[0m23:47:04.038145 [debug] [Thread-2 (]: Began running node model.projeto_final.view_2
[0m23:47:04.038145 [info ] [Thread-1 (]: 1 of 2 START sql view model public.view_1 ...................................... [RUN]
[0m23:47:04.039144 [info ] [Thread-2 (]: 2 of 2 START sql view model public.view_2 ...................................... [RUN]
[0m23:47:04.039144 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.projeto_final.view_1'
[0m23:47:04.039144 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.projeto_final.view_2'
[0m23:47:04.040651 [debug] [Thread-1 (]: Began compiling node model.projeto_final.view_1
[0m23:47:04.040651 [debug] [Thread-2 (]: Began compiling node model.projeto_final.view_2
[0m23:47:04.041657 [debug] [Thread-1 (]: Writing injected SQL for node "model.projeto_final.view_1"
[0m23:47:04.042661 [debug] [Thread-2 (]: Writing injected SQL for node "model.projeto_final.view_2"
[0m23:47:04.043659 [debug] [Thread-1 (]: Timing info for model.projeto_final.view_1 (compile): 2023-03-31 23:47:04.040651 => 2023-03-31 23:47:04.043659
[0m23:47:04.043659 [debug] [Thread-1 (]: Began executing node model.projeto_final.view_1
[0m23:47:04.043659 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_2 (compile): 2023-03-31 23:47:04.041657 => 2023-03-31 23:47:04.043659
[0m23:47:04.074127 [debug] [Thread-1 (]: Writing runtime sql for node "model.projeto_final.view_1"
[0m23:47:04.075133 [debug] [Thread-2 (]: Began executing node model.projeto_final.view_2
[0m23:47:04.078130 [debug] [Thread-2 (]: Writing runtime sql for node "model.projeto_final.view_2"
[0m23:47:04.079131 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:04.079131 [debug] [Thread-1 (]: On model.projeto_final.view_1: BEGIN
[0m23:47:04.079131 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:47:04.079131 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:47:04.079131 [debug] [Thread-2 (]: On model.projeto_final.view_2: BEGIN
[0m23:47:04.080652 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:47:04.112196 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m23:47:04.112196 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:04.112196 [debug] [Thread-2 (]: SQL status: BEGIN in 0 seconds
[0m23:47:04.112196 [debug] [Thread-1 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */

  create view "projeto"."public"."view_1__dbt_tmp" as (
    select
	avg(walmart.profit / walmart.sales) as margin,
	walmart.category
from walmart
group by category
order by margin desc
  );
[0m23:47:04.112196 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:47:04.113704 [debug] [Thread-2 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */

  create view "projeto"."public"."view_2__dbt_tmp" as (
    select
    avg(date(walmart.ship_date) - date(walmart.order_date)) as order_ship_delta,
	walmart.state
from walmart
group by walmart.state
order by order_ship_delta asc
  );
[0m23:47:04.122945 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:47:04.122945 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0 seconds
[0m23:47:04.127946 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:04.130448 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:47:04.130448 [debug] [Thread-1 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1" rename to "view_1__dbt_backup"
[0m23:47:04.130448 [debug] [Thread-2 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2" rename to "view_2__dbt_backup"
[0m23:47:04.132516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:47:04.132516 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:47:04.134529 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:04.136526 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:47:04.136526 [debug] [Thread-1 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
alter table "projeto"."public"."view_1__dbt_tmp" rename to "view_1"
[0m23:47:04.136526 [debug] [Thread-2 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
alter table "projeto"."public"."view_2__dbt_tmp" rename to "view_2"
[0m23:47:04.137918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:47:04.137918 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0 seconds
[0m23:47:04.152975 [debug] [Thread-1 (]: On model.projeto_final.view_1: COMMIT
[0m23:47:04.153972 [debug] [Thread-2 (]: On model.projeto_final.view_2: COMMIT
[0m23:47:04.154975 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:04.154975 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:47:04.154975 [debug] [Thread-1 (]: On model.projeto_final.view_1: COMMIT
[0m23:47:04.154975 [debug] [Thread-2 (]: On model.projeto_final.view_2: COMMIT
[0m23:47:04.155972 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m23:47:04.155972 [debug] [Thread-2 (]: SQL status: COMMIT in 0 seconds
[0m23:47:04.160547 [debug] [Thread-1 (]: Using postgres connection "model.projeto_final.view_1"
[0m23:47:04.162503 [debug] [Thread-2 (]: Using postgres connection "model.projeto_final.view_2"
[0m23:47:04.162503 [debug] [Thread-1 (]: On model.projeto_final.view_1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_1"} */
drop view if exists "projeto"."public"."view_1__dbt_backup" cascade
[0m23:47:04.162503 [debug] [Thread-2 (]: On model.projeto_final.view_2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "projeto_final", "target_name": "dev", "node_id": "model.projeto_final.view_2"} */
drop view if exists "projeto"."public"."view_2__dbt_backup" cascade
[0m23:47:04.164522 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m23:47:04.164522 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0 seconds
[0m23:47:04.165535 [debug] [Thread-1 (]: Timing info for model.projeto_final.view_1 (execute): 2023-03-31 23:47:04.044660 => 2023-03-31 23:47:04.165535
[0m23:47:04.166540 [debug] [Thread-2 (]: Timing info for model.projeto_final.view_2 (execute): 2023-03-31 23:47:04.075133 => 2023-03-31 23:47:04.166540
[0m23:47:04.166540 [debug] [Thread-1 (]: On model.projeto_final.view_1: Close
[0m23:47:04.166540 [debug] [Thread-2 (]: On model.projeto_final.view_2: Close
[0m23:47:04.167537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba92b959-940e-4a3b-a594-8e9b6fc1e6dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2A4806D0>]}
[0m23:47:04.167537 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba92b959-940e-4a3b-a594-8e9b6fc1e6dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2B046DD0>]}
[0m23:47:04.168536 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.view_1 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:47:04.168536 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.view_2 ................................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:47:04.170534 [debug] [Thread-1 (]: Finished running node model.projeto_final.view_1
[0m23:47:04.170534 [debug] [Thread-2 (]: Finished running node model.projeto_final.view_2
[0m23:47:04.171812 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:47:04.171812 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:04.172813 [debug] [MainThread]: On master: BEGIN
[0m23:47:04.172813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:47:04.202357 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m23:47:04.202357 [debug] [MainThread]: On master: COMMIT
[0m23:47:04.202357 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:04.203355 [debug] [MainThread]: On master: COMMIT
[0m23:47:04.203355 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m23:47:04.203355 [debug] [MainThread]: On master: Close
[0m23:47:04.204356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:47:04.204356 [debug] [MainThread]: Connection 'list_projeto' was properly closed.
[0m23:47:04.204356 [debug] [MainThread]: Connection 'list_projeto_public' was properly closed.
[0m23:47:04.204356 [debug] [MainThread]: Connection 'model.projeto_final.view_1' was properly closed.
[0m23:47:04.204356 [debug] [MainThread]: Connection 'model.projeto_final.view_2' was properly closed.
[0m23:47:04.205356 [info ] [MainThread]: 
[0m23:47:04.205356 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m23:47:04.206357 [debug] [MainThread]: Command end result
[0m23:47:04.211867 [info ] [MainThread]: 
[0m23:47:04.212868 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:47:04.212868 [info ] [MainThread]: 
[0m23:47:04.213868 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:47:04.213868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2AD0FD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2AFDB0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2B0A7C90>]}
[0m23:47:04.213868 [debug] [MainThread]: Flushing usage events
